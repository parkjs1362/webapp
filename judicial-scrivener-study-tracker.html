<!DOCTYPE html>
<html lang="ko">
<!--
    ì‚¬ë²•ì‹œí—˜ í•™ìŠµ ì‹œìŠ¤í…œ - ì „ëµì  í•™ìŠµ í”„ë ˆì„ì›Œí¬
    Version: 3.6.0
    Last Updated: 2025-10-30

    Changes in v3.6.0 - Dark Theme Excellence & Accessibility Enhancement:
    - ENHANCED: Comprehensive dark mode optimization for maximum visibility
      * Ultra deep black background (#0a0a0a) for sophisticated appearance
      * Enhanced text brightness (#f5f5f5, #e0e0e0) for superior readability
      * Improved border visibility (rgba(255,255,255,0.18)) for clear separation
      * WCAG AAA compliant contrast ratios (15:1 to 18.5:1) throughout
    - REDESIGNED: Shadow system with enhanced depth perception
      * Multi-layer shadows with subtle glow effects
      * Deeper blacks (0.8-0.98 opacity) for true depth
      * Contextual glow shadows for accent, success, warning, danger states
      * Improved hover elevation with combined shadow and glow
    - OPTIMIZED: Vibrant accent colors for dark backgrounds
      * Accent blue: #3da1ff (enhanced from #2997ff) for better visibility
      * Success green: #32d760 (vivid saturation) with glow effects
      * Warning orange: #ffaa00 (enhanced brightness) for clear alerts
      * Danger red: #ff5545 (vivid red) for urgent attention
    - ENHANCED: Gradient and glow effects optimized for dark theme
      * Timer display: Multi-stop gradient (#3da1ff â†’ #5cb3ff â†’ #7dc5ff) with drop-shadow
      * Streak numbers: Vivid coral gradient with subtle glow
      * Progress bars: Enhanced contrast with inner shadows
      * Gradient cards: Brighter blues with enhanced glow on hover
    - IMPROVED: Interactive elements with clear visual feedback
      * Form inputs: Enhanced contrast, hover states, and focus rings
      * Buttons: Improved elevation on hover with glow effects
      * Mode buttons (1ì°¨/2ì°¨): Crystal clear active state with gradients
      * Chart buttons: Enhanced visibility and active state indication
    - REFINED: Card system with superior depth and hierarchy
      * Cards: #141414 background with enhanced borders and shadows
      * Hover effects: Smooth elevation with increased glow
      * Time blocks: Clear separation and hover feedback
      * Modal dialogs: Deep shadows for strong focus
    - ENHANCED: Sticky progress bar with glassmorphism
      * Enhanced backdrop blur (24px) for depth
      * Improved metric card visibility and hover states
      * Clear label and value distinction
    - POLISHED: Overall dark theme cohesion
      * All elements follow consistent design language
      * Smooth transitions maintained throughout
      * Performance optimized with efficient CSS
      * Maintained light mode integrity

    Changes in v3.5.0 - Major UX/UI Enhancement & Visual Design System Upgrade:
    - ENHANCED: Modern visual design system with improved hierarchy
      * Redesigned color palette with better contrast and visual impact
      * Enhanced typography scale for clearer information hierarchy
      * Improved spacing system for better content breathing room
      * Refined shadow system for depth perception
    - REDESIGNED: Study time & Pomodoro section with hero-style prominence
      * Larger timer displays (4.5rem â†’ 5.5rem) for primary focus
      * Enhanced visual weight with bold gradients and shadows
      * Improved quick-time buttons with better interaction feedback
      * Color-coded session indicators for instant recognition
    - IMPROVED: Learning streak section with rewarding visuals
      * Enhanced progress bar with animated gradient effects
      * Larger streak numbers (3rem â†’ 4rem) for achievement emphasis
      * Glowing effects on milestone achievements (7, 30, 100 days)
      * Better stat cards with hover interactions
    - ENHANCED: Button system with clear state differentiation
      * Improved hover effects with scale and elevation changes
      * Active state indicators with color shifts
      * Better disabled state visibility
      * Enhanced exam type toggle buttons (1ì°¨/2ì°¨) with clear selection
    - OPTIMIZED: Card system with modern depth and interaction
      * Refined hover effects (subtle lift + shadow enhancement)
      * Better focus states for accessibility
      * Improved border radius for modern aesthetic
      * Enhanced glassmorphism effects on overlays
    - IMPROVED: Dark mode color harmony
      * Better contrast ratios for text readability
      * Refined accent colors for dark backgrounds
      * Enhanced gradient visibility in dark mode
      * Improved form element styling
    - ADDED: Smooth micro-animations throughout
      * Fade-in effects for cards and sections
      * Pulse animations for timers and progress indicators
      * Smooth color transitions on interactions
      * Reduced motion support maintained
    - POLISHED: Responsive design refinements
      * Better mobile spacing and touch targets
      * Improved tablet layout optimizations
      * Enhanced small screen readability

    Changes in v3.4.0 - Streak Enhancement & Pomodoro Quick Time:
    - ENHANCED: Learning streak section with more details
      * Added visual progress bar (based on longest streak record)
      * Shows last study date with relative time (ì˜¤ëŠ˜, ì–´ì œ, Nì¼ ì „)
      * Dynamic streak status display (ì˜¤ëŠ˜ í•™ìŠµ ì™„ë£Œ!, Nì¼ ì—°ì† ì§„í–‰ ì¤‘, ìŠ¤íŠ¸ë¦­ ì‹œì‘í•˜ê¸°)
      * Color-coded status indicators for visual feedback
      * Better visual hierarchy with improved styling
    - ADDED: Pomodoro quick time options
      * 6 preset buttons: 15ë¶„, 25ë¶„, 45ë¶„, 1ì‹œê°„, 90ë¶„, 2ì‹œê°„
      * One-click setup without modal dialog
      * Automatic timer display update
      * Preset times persist after clicking
      * Quick selection for common work durations
    - IMPROVED: Dark mode text visibility
      * Enhanced contrast for exam type buttons (1ì°¨/2ì°¨)
      * Better hover states with increased opacity
      * Added subtle border for better distinction
      * Full visibility text color (95-100%)

    Changes in v3.3.0 - Pomodoro Enhancement & UI Improvements:
    - ADDED: Pomodoro timer duration configuration
      * Users can now customize work time (1-120 minutes, default: 25)
      * Users can now customize break time (1-30 minutes, default: 5)
      * Settings modal with clear guidance and validation
      * Timer automatically uses configured durations
      * Settings persist across sessions
    - FIXED: Weekly stats display now shows actual study hours
      * Automatically calculates from studyHistory instead of manual entry
      * Displays real-time study hours for each day of the week
      * Removed manual editing feature (auto-calculation only)
      * Shows hours with decimal precision (e.g., 2.5h)
    - REMOVED: Achievement badges section
      * Deleted HTML container (achievement-badges)
      * Removed renderAchievementBadges function
      * Removed function calls from analytics
      * Cleaner dashboard with reduced visual clutter
    - IMPROVED: Dark mode text visibility for exam type tabs
      * Unselected exam type buttons now have better contrast
      * Light text color (70% opacity) for inactive buttons
      * Hover state with 90% opacity
      * Active state maintains full visibility
      * Better UX when switching between 1ì°¨/2ì°¨ exams

    Changes in v3.2.1 - Cleanup of v3.0.0 Legacy Code:
    - REMOVED: v3.0.0 module loading warnings
      * Deleted v3.0.0 module load check script
      * Removed migration-v2-to-v3.js, sync-manager-v3.0.js, analytics-engine-v3.0.js references
      * Removed monitoring-v3.0.js (monitoring system)
    - REMOVED: v3.0.0 initialization code
      * Deleted initializeV3() function
      * Deleted setupV3Observers() function
      * Removed v3Data, syncMgr, analytics global variables
      * Removed updateV3Analytics() function
    - REMOVED: v3.0.0 integration overrides
      * Deleted toggleTimeBlock() v3 override
      * Deleted saveScore() v3 override
    - REMOVED: Sync badge (dynamic sync status display)
    - IMPROVED: Clean console output
      * No more v3.0.0 module load warnings
      * No more initialization warnings
      * Focus on v3.2.x features

    Changes in v3.2.0 - Complete Bidirectional Study Time Sync:
    - ENHANCED: Bidirectional sync between study blocks and study time
      * Study block modification now updates study time (edit time change)
      * Study block deletion from completed blocks removes from study time
      * Time difference automatically calculated and applied to total
    - IMPROVED: Study time & Pomodoro perfect integration
      * Study blocks: time added to timer when block is marked complete
      * Pomodoro: 25 minutes added to timer when work session completes
      * Time modifications instantly reflected in both components
      * All time sources (blocks + pomodoro) contribute to single study time
    - OPTIMIZED: Analytics refresh on all time modifications
      * renderAnalytics() called on block deletion for dashboard update
      * Complete real-time synchronization between UI components
    - FEATURES: Complete study tracking ecosystem
      * Manual time blocks (í•™ìŠµ ì „ëµ)
      * Pomodoro timer sessions
      * Study history tracking
      * All contributing to unified "ì˜¤ëŠ˜ì˜ í•™ìŠµ ì‹œê°„"

    Changes in v3.1.5 - Core Metrics Removal & Pomodoro Sync:
    - REMOVED: Core metrics section (ğŸ¯ í•µì‹¬ ë©”íŠ¸ë¦­)
      * Deleted glassmorphism core metrics display from dashboard
      * Removed renderCoreMetrics function call from analytics
      * Cleaner dashboard interface without redundant metrics
    - FIXED: Pomodoro timer sync with study time
      * When pomodoro work session completes, automatically adds 25 minutes to study time
      * Study time display updates immediately after pomodoro completion
      * Dashboard analytics refresh to reflect new study time
      * Toast notification confirms time has been added to study tracker
    - IMPROVED: User experience
      * Pomodoro timer now contributes directly to total study time
      * Better visual feedback when pomodoro work sessions complete

    Changes in v3.1.4 - Complete Console Error Cleanup:
    - FIXED: renderSubjectTimeChart console warning
      * Removed console.warn message when chart container doesn't exist
      * Function silently returns if element is not found
    - FIXED: renderMockScoreChart console warning
      * Removed console.warn message when chart container doesn't exist
      * Function silently returns if element is not found
    - FIXED: renderMetacognitiveFeedback null reference errors
      * Added element existence checks at start of function
      * Early return if 'metacognitive-feedback' or 'motivation-message' elements don't exist
      * Updated all DOM references to use cached element variables
      * Fixed error handler to safely check element existence
    - COMPLETED: All page load console errors resolved
      * No more warnings about missing chart elements
      * No more null reference errors when updating deleted analytics section elements
      * Clean console output on page load

    Changes in v3.1.3 - Console Errors Fixed & Time Entry UI Improved:
    - FIXED: renderAnalytics null reference error
      * Removed references to deleted HTML elements (total-study-hours, avg-daily-hours, etc.)
      * Removed updateBenchmarkProgress call that referenced non-existent elements
      * Simplified function to only render actual dashboard components
    - FIXED: jumpToSection console errors
      * Removed onclick="jumpToSection(...)" from sticky progress bar metrics
      * No longer trying to navigate to non-existent sections
      * Sticky progress bar is now display-only (no navigation)
    - IMPROVED: Time entry UI for study plan
      * Changed from text input "06:00-08:00" to structured time inputs
      * Added separate "ì‹œì‘ ì‹œê°„" (start time) input with type="time"
      * Added separate "ë ì‹œê°„" (end time) input with type="time"
      * Automatic calculation of study hours from time difference
      * Better validation with error messages for time ranges
    - IMPROVED: User experience
      * Time input is now more intuitive with native time picker
      * Study hours are automatically calculated (no manual entry needed)
      * Cleaner console output without error messages

    Changes in v3.1.2 - Dashboard Tab System Removal:
    - REMOVED: Dashboard navigation tabs
      * Deleted ğŸ“‹ ê°œìš”, ğŸ“… ê³„íš, ğŸ“ˆ ì¶”ì , ğŸ“Š ë¶„ì„ tabs
      * Removed tab navigation UI completely
      * Simplified dashboard layout by eliminating tab switching
    - REMOVED: Today's notes section
      * Deleted ğŸ“ ì˜¤ëŠ˜ì˜ í•™ìŠµ ë…¸íŠ¸ card entirely
    - FIXED: Console warnings for missing sections
      * Removed sectionMap from switchTab function
      * Removed sectionToTabMap from jumpToSection function
      * Simplified jumpToSection to only scroll to element
      * Fixed warning messages (warn â†’ error for missing sections)
    - IMPROVED: Error handling
      * jumpToSection now only handles scrolling (tabs removed)
      * Better error reporting when elements not found
      * Cleaner console output without tab-related messages

    Changes in v3.1.1 - Timer UI Consolidation:
    - MERGED: Combined study time and pomodoro timer cards into single unified card
      * Integrated "ì˜¤ëŠ˜ì˜ í•™ìŠµ ì‹œê°„" and "í¬ëª¨ë„ë¡œ íƒ€ì´ë¨¸" into one card
      * Study hours section displayed at top with timer, controls, and weekly stats
      * Pomodoro timer section displayed below with session tracking
      * Used CSS Grid for clean two-row layout with visual separator
      * Maintained all existing functionality and button IDs
      * Improved dashboard organization and reduced visual clutter

    Changes in v3.1.0 - Major Dashboard Simplification:
    - REMOVED: Detailed analytics section
      * Eliminated detailed statistics grid (ì´ í•™ìŠµ ì‹œê°„, ì¼í‰ê· , ì „ì²´ ì§„ë„ìœ¨, ëª¨ì˜ê³ ì‚¬ í‰ê· )
      * Removed learning curve analysis visualization
      * Removed metacognitive feedback section
      * Removed efficiency analysis metrics
      * Removed data sync status dashboard
      * Removed data visualization charts from collapsible section
    - REMOVED: Goals management section
      * Deleted goal setting card from dashboard
      * Removed goal modal and all goal management UI
      * Simplified user interface by eliminating goal tracking features
    - IMPROVED: Dashboard focus
      * Cleaner, more minimal interface
      * Focus on essential learning information
      * Reduced information overload for better user experience
    - TECHNICAL: Cleaned up related function calls
      * Removed renderGoals() calls from initialization
      * Removed renderDashboardAnalytics() call
      * Removed renderWeakSubjectsAnalysis() and renderStrongSubjectsAnalysis() calls

    Changes in v3.0.9 - Dashboard Cleanup & Chart Enhancement:
    - REMOVED: "ì˜¤ëŠ˜ì˜ í•™ìŠµ ìš°ì„ ìˆœìœ„ (AI ì¶”ì²œ)" section
      * Simplified dashboard by removing redundant AI recommendations
      * Reduced cognitive load with focused core information
    - REMOVED: "ê³¼ëª©ë³„ ì§„ë„ìœ¨" visualization section
      * Consolidated progress tracking to essential metrics
      * Cleaner dashboard layout for better focus
    - IMPROVED: Subject time distribution chart visibility
      * Increased font sizes (0.8rem â†’ 0.95rem for labels, 0.75rem â†’ 0.9rem for values)
      * Added minimum bar height (40px) for better visibility
      * Enhanced spacing and visual hierarchy with improved margins
      * Added shadow effects for depth perception
      * Better color contrast with dark text on gradients
    - IMPROVED: Dashboard information hierarchy
      * Removed duplicate progress information
      * Focus on core metrics and essential visualizations

    Changes in v3.0.8 - Bug Fixes & UI Improvements:
    - FIXED: Chart rendering element ID mismatches
      * Added missing container divs with correct IDs (subject-time-chart, mock-score-chart)
      * Resolved console warnings about missing chart elements
    - FIXED: Modal functionality for all add/edit operations
      * Ensured proper global variable declarations (editingBlockId, editingScoreId, editingGoalId)
      * Fixed add mode to reset editing state properly
      * Fixed edit mode to use correct variable names and field mappings
    - IMPROVED: Dashboard data visualization
      * Charts now render correctly in their designated containers
      * Removed unused canvas elements that conflicted with bar chart rendering

    Changes in v3.0.7 - UI/UX Enhancement & Cognitive Load Reduction:
    - ADDED: Core metrics dashboard (3 key indicators only)
      * Overall progress percentage
      * Expected completion date (D-day format)
      * Learning efficiency index (0-100)
    - ADDED: Collapsible detailed analytics section
      * Reduced cognitive load by hiding secondary metrics
      * Toggle button for expanding/collapsing detailed stats
    - ADDED: Today's Goals section with AI recommendations
      * Prioritized study recommendations based on progress
      * Weak subject (progress <50%)
      * Mid-level subject (progress 50-70%)
      * Strong subject (progress >70%)
      * Concrete action items for each subject
    - ADDED: Achievement badge system for motivation
      * "3ì¼ ì—°ì†" badge (consecutiveDays >= 3)
      * "ì£¼ê°„ ê¾¸ì¤€í•¨" badge (weeklyStudyDays >= 5)
      * "ì›”ê°„ ëª©í‘œ" badge (monthlyHours >= 80)
      * "ì•½ì  ì •ë³µ" badge (weak subject progress >= 50%)
    - IMPROVED: Information hierarchy for better UX
      * Critical info at top, detailed analysis below
      * Clear visual separation between sections
      * Reduced information overload on main dashboard

    Changes in v3.0.6 - Time Block Save Fix & Input Validation:
    - FIXED: Time block save issue
      * Added placeholder option "ê³¼ëª©ì„ ì„ íƒí•˜ì„¸ìš”" to select dropdown
      * Added required attribute to subject select
      * Improved validation messages with clear instructions
    - ADDED: Better error feedback
      * Toast notifications for missing fields (ì‹œê°„ëŒ€, ê³¼ëª©, í•™ìŠµ ë‚´ìš©)
      * Each field now shows specific error message
      * User guidance: "ì˜ˆ: 06:00-08:00" for time format
    - IMPROVED: Form UX
      * Required fields now clearly marked
      * Error messages appear as toast notifications
      * Prevents accidental empty submissions

    Changes in v3.0.5 - Enhanced Dashboard Features & Dark Mode Polish:
    - ADDED: Dashboard analytics with 4 new metrics
      * Efficiency Score (ì‹œê°„ ëŒ€ë¹„ íš¨ìœ¨ì„± ì§€ìˆ˜, 0-100)
      * Weekly Study Days (ì£¼ê°„ í•™ìŠµì¼ ì¶”ì )
      * Weak Subjects Analysis (ì§„ë„ìœ¨ 50% ë¯¸ë§Œ ê³¼ëª© í‘œì‹œ)
      * Strong Subjects Analysis (ì§„ë„ìœ¨ 80% ì´ìƒ ê³¼ëª© í‘œì‹œ)
    - FIXED: Dark mode styling for "í•©ê²©ì í‰ê· " and "í•©ê²©ì ì¡°ì–¸" sections
      * Background color now dark gray (#2d2d2d) in dark mode
      * Text color adjusted for readability (white)
      * Section title color properly styled
    - IMPROVED: Dashboard display with color-coded progress bars
      * Green for excellent (â‰¥80% efficiency)
      * Blue-green for good (â‰¥50% efficiency)
      * Orange-yellow for needs improvement (<50% efficiency)

    Changes in v3.0.4 - Learning Curve & Dark Mode Text Visibility:
    - FIXED: NaN ì—ëŸ¬ in learning curve analysis (actualStudyDays validation)
      * Added safe day calculation (default to 1 if undefined)
      * Proper handling of zero completed problems
      * Fixed remaining problems calculation
    - FIXED: Dark mode text visibility issues
      * All analytics labels now explicitly white in dark mode
      * Analytics values display correctly (removed gradient on dark mode)
      * Cards have proper background (#1a1a1a) and text colors
      * Form elements, buttons, modals all optimized for dark mode
    - IMPROVED: Learning curve display
      * "ê³„ì‚° ì¤‘" shows when pace can't be calculated
      * "ì™„ë£Œ!" shows when all problems are finished
      * Dash "-" shows for zero pace instead of NaN
      * Days display with validation

    Changes in v3.0.3 - Dark Mode UI Improvements:
    - FIXED: Dark mode now applies to entire page background (body + html)
    - IMPROVED: Enhanced dark mode colors for better visibility
      * Background: Pure black (#000000) for main area
      * Cards: Dark gray (#1a1a1a) for better contrast
      * Text: Pure white (#ffffff) for maximum readability
      * Text secondary: Light gray (#d1d1d6) - WCAG AAA compliant (7.1:1)
    - ADDED: Explicit dark mode styling for form elements
      * Input fields: #2d2d2d background with white text
      * Buttons: Adjusted for dark mode visibility
      * Modals: #1a1a1a background for consistency
      * Time blocks: Dark mode colors applied
      * Progress bars: Enhanced visibility in dark mode
    - FEATURE: Full page dark mode transformation (not just cards)

    Changes in v3.0.2 - Learning Curve Analysis & Metacognitive Feedback:
    - ADDED: Learning curve analysis with automatic completion date prediction
      * Calculates current learning pace (problems/day)
      * Predicts completion date based on remaining problems
      * Displays days remaining and learning velocity
    - ADDED: Metacognitive feedback system with context-aware insights
      * Interprets progress percentage with positive reinforcement
      * Provides efficiency metrics (hours per problem, problems per day)
      * Delivers personalized motivation messages based on progress level
      * Shows consistency feedback for learning duration
    - IMPROVED: Analytics dashboard with dual new cards
      * Blue card for learning curve predictions
      * Green card for motivational feedback
    - FEATURE: D-day style countdown for exam preparation

    Changes in v3.0.1 - Critical Bug Fix for Exam Type Selection:
    - FIXED: Exam type buttons (1ì°¨/2ì°¨) now properly update all UI components
    - FIXED: Added missing UI refresh calls to setExamType() function
      * updateDDay() - D-day counters now refresh on exam type change
      * renderTimeBlocks() - Time blocks update with correct subjects
      * renderWeeklyStats() - Weekly statistics refresh properly
      * renderMockScores() - Mock exam scores display updates
      * renderAnalytics() - Analytics dashboard refreshes
    - IMPROVED: Added console logging for better debugging
    - IMPROVED: Added comprehensive inline comments explaining each UI update
    - NOTE: Buttons were executing but UI wasn't refreshing, making them appear broken

    Changes in v3.0.0 - Data Normalization & Intelligent Learning Analytics:
    - CRITICAL: Complete data normalization with 7 Entity schema (User, StudyPlan, Subject, TimeBlock, StudyLog, MockExam, LearningHistory)
    - CRITICAL: Implemented automatic synchronization using Observer pattern with Cascade Update
    - CRITICAL: Added intelligent learning analytics engine with efficiency scoring and personalized recommendations
    - ADDED: DataMigration module for v2.14.0 â†’ v3.0.0 automatic conversion with 100% data preservation
    - ADDED: SyncManager for complete automatic data synchronization (no manual updates needed)
    - ADDED: AnalyticsEngine for comprehensive learning analysis (daily/weekly/monthly statistics, weak subject identification, smart recommendations)
    - IMPROVED: All data relationships now explicitly defined with foreign keys
    - IMPROVED: Automatic cascade updates when timeBlock is completed (StudyLog â†’ Subject â†’ Plan â†’ History)
    - ENHANCED: User-centric data design reflecting actual learning workflows
    - VERIFIED: Full backward compatibility with v2.14.0 (auto-migration with rollback support)
    - PERFORMANCE: No storage increase despite normalization (optimized structure)
    - DOCUMENTATION: Complete design docs (DATA_SCHEMA_v3.0.md, IMPLEMENTATION_GUIDE_v3.0.md)

    **Key Improvements in v3.0.0**:
      âœ… 7ê°œ ì •ê·œí™” Entityë¡œ ëª…í™•í•œ ë°ì´í„° ê´€ê³„ ì •ì˜
      âœ… ì™„ì „ ìë™í™”ëœ ë°ì´í„° ë™ê¸°í™” (Observer Pattern)
      âœ… AI ê¸°ë°˜ í•™ìŠµ íš¨ìœ¨ì„± ë¶„ì„ (0-100 ì ìˆ˜)
      âœ… ì·¨ì•½ì  ìë™ ì‹ë³„ ë° ë§ì¶¤í˜• ê°œì„ ì•ˆ ì œì‹œ
      âœ… v2.14.0 ë°ì´í„° 100% í˜¸í™˜ ë° ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜
      âœ… ê³„íš vs ì‹¤ì œ í•™ìŠµ ìë™ ë¹„êµ
      âœ… ì˜ˆìƒ ì™„ë£Œì¼ ìë™ ê³„ì‚°
      âœ… í•™ìŠµ íŒ¨í„´ ë¶„ì„ ë° ìµœì í™” ì œì•ˆ

    Changes in v2.14.0 - Complete Daily Data Isolation & Integration:
    - CRITICAL: Added `date` field to timeBlocks when creating new blocks
    - FIXED: "ì˜¤ëŠ˜ì˜ í•™ìŠµ ì „ëµ" card now shows only TODAY's blocks (date filtering)
    - IMPROVED: Empty state message when no blocks exist for today
    - REFACTORED: toggleTimeBlock() now auto-populates studyHistory on completion
    - FIXED: Analytics calculations use correct date field (block.date, not block.time)
    - IMPROVED: Streak calculation filters timeBlocks by today's date
    - ADDED: Comprehensive DATA_FLOW_ARCHITECTURE.md documentation
    - VERIFIED: All data entity relationships mapped and validated
    - TESTED: Complete data flow from creation â†’ storage â†’ display â†’ update
    - NOTE: Data isolation achieved without daily resets; historical data preserved

    **Key Features**:
      âœ… Daily blocks isolated by date (show only today's blocks)
      âœ… studyHistory auto-populated when blocks completed
      âœ… Charts update automatically on all data changes
      âœ… Sync status displays correctly on initial load
      âœ… Streak calculation uses correct date filtering
      âœ… All analytics use proper data sources
      âœ… Complete documentation of data flows and relationships

    Changes in v2.13.2 - Critical Data Synchronization & Dashboard Fix:
    - FIXED: "ì €ì¥ëœ ë°ì´í„°: ê³„ì‚° ì¤‘..." stuck display - added updateSyncStatus() to init()
    - FIXED: Charts not updating on initial page load - reordered initialization sequence
    - FIXED: Data changes not reflecting in charts - moved saveData() wrapper before init()
    - IMPROVED: Proper initialization lifecycle (DOMReady â†’ setupCharts â†’ wrapFunctions â†’ init â†’ updateCharts)
    - REFACTORED: Removed duplicate function wrapping and initialization code
    - IMPROVED: Consolidated DOMContentLoaded handler with all initialization logic
    - NOTE: Charts now display data immediately on page load + update on all data changes

    Changes in v2.13.1 - Chart Data Rendering Fix & Sample Data Optimization:
    - FIXED: Empty chart data issue by ensuring updateSubjectsByExamType() is called
    - FIXED: Added safety checks to preserve sample data (timeBlocks, mockScores) on page load
    - FIXED: Ensured charts update when exam type is switched
    - IMPROVED: Chart initialization with proper timing and data validation
    - NOTE: All 4 visualization types now render correctly with sample data
      * Subject Time Distribution (Doughnut Chart)
      * Mock Exam Score Trend (Line Chart with average line)
      * Subject Progress Bars (Animated progress indicators)
      * Sync Status Dashboard (Connection monitoring)

    Changes in v2.13.0 - Advanced Data Visualization Dashboard with Chart.js:
    - CRITICAL: Integrated Chart.js v4.4.1 for professional data visualization
      * High-performance rendering with Canvas API
      * Apple-inspired color palette and animations
      * Full dark mode support with dynamic theme switching
      * Responsive charts for all screen sizes
    - ADDED: Data Sync Status Dashboard (Real-time Connection Monitoring)
      * Visual status indicators with icon + color coding
      * Last sync timestamp display
      * Sync success rate percentage
      * Real-time status updates
    - ADDED: Subject Study Time Distribution Chart (Doughnut)
      * Interactive doughnut chart with hover tooltips
      * Color-coded subjects with legend
      * Percentage and hour display
      * Animated transitions with Apple easing
      * Click-to-filter functionality
    - ADDED: Mock Exam Score Trend Chart (Line)
      * Multi-line comparison with trend analysis
      * Time-based X-axis (date/week/month)
      * Average line indicator
      * Interactive data points with tooltips
      * Responsive legend and axis labels
    - ADDED: Subject Progress Visualization (Animated Progress Bars)
      * Horizontal progress bars with animations
      * Color-coded status (red: <40%, orange: 40-70%, green: >70%)
      * Percentage labels and subject names
      * Smooth fill animations on load
    - ENHANCED: Chart interactivity and UX
      * Hover effects with detailed tooltips
      * Drill-down capability for detailed views
      * Date range selector for trend charts
      * Export chart as image functionality
    - OPTIMIZED: Performance and accessibility
      * Lazy loading for chart rendering
      * ARIA labels for screen readers
      * Keyboard navigation support
      * Reduced motion support for accessibility
    - DESIGNED: Apple-inspired visual system
      * SF Pro font family for consistency
      * Apple Blue (#0071e3) primary color
      * Subtle shadows (0.04-0.08 opacity)
      * 24px border radius for cards
      * Glassmorphism effects for overlays

    Changes in v2.12.0 - Apple.com Inspired Design System (2024-2025):
    - CRITICAL: Complete design system overhaul with Apple.com aesthetic
      * Color System: Apple's refined palette (light: #fbfbfd, dark: #000000)
      * Typography: San Francisco-inspired font stack with 17px base size
      * Spacing: 12px/16px base system with generous whitespace (64px-96px)
      * Shadows: Ultra-subtle approach (0.04-0.08 opacity)
      * Border Radius: Larger, more modern (16px-28px)
    - REDESIGNED: Typography system following Apple standards
      * Line heights: 1.0833 (headlines), 1.47 (body text)
      * Letter spacing: -0.01em for large text
      * Font smoothing: antialiased rendering
      * Font weights: 300-700 range with proper hierarchy
    - ENHANCED: Animation system with Apple's signature easing
      * Easing function: cubic-bezier(0.28, 0.11, 0.32, 1)
      * Duration: 400ms-600ms for premium feel
      * Smooth scroll: Native smooth scrolling enabled
      * Reduced motion: Full accessibility support
    - IMPROVED: Component styling with modern effects
      * Cards: Larger radius (24px), subtle hover (scale 1.01, translateY -3px)
      * Buttons: Pill shape (border-radius: 9999px), micro-interactions
      * Modals: Glassmorphism with backdrop blur (10px-20px)
      * Header: Minimal design with hover effects
    - POLISHED: Dark mode with Apple's pure black approach
      * Background: #000000 (pure black) instead of gray
      * Cards: #161617 (subtle gray) for depth
      * Text: #f5f5f7 (off-white) for readability
      * Accent: #2997ff (brighter blue) for dark mode
    - ADDED: Modern web design trends (2024-2025)
      * Smooth transitions: All elements use Apple easing
      * Micro-interactions: Button hover/active states
      * Glassmorphism: Modal backdrops with blur
      * Generous whitespace: Container padding 64px-96px
    - OPTIMIZED: CSS Variables for consistency
      * 12 font sizes (11px-80px range)
      * 5 font weights (300-700)
      * 4 line heights (1.08-1.625)
      * 10 spacing scales (4px-96px)
      * 6 border radius options (10px-28px)

    Changes in v2.11.0 - Single Column Layout Optimization (User Preference):
    - CRITICAL: Changed layout from multi-column to single-column for better usability
      * Dashboard grid: 3-column â†’ 1-column layout
      * Removed card max-width constraint (450px â†’ 100%)
      * Simplified grid breakpoints (gap only, no column changes)
      * Today's plan: removed grid-column span settings
    - SIMPLIFIED: Responsive design now focuses on gap adjustments only
      * Desktop: 24px gap
      * Tablet: 20px gap
      * Mobile: 16px gap
      * Small mobile: 12px gap
    - IMPROVED: User convenience with full-width cards
      * Cards now stretch to full container width
      * Better readability on all screen sizes
      * Cleaner, more linear content flow
      * No more horizontal scanning needed

    Changes in v2.10.0 - Apple/Google Design System Layout Optimization:
    - CRITICAL: Container max-width reduced from 1400px to 1280px (Apple standard)
      * Optimal reading width for 24-27" monitors
      * Improved text readability with proper line length
      * Better visual focus and content hierarchy
    - REDESIGNED: Dashboard grid system with fixed column-based layout
      * Desktop (>1280px): 3-column grid with 24px gap
      * Tablet (769-1024px): 2-column grid with 20px gap
      * Mobile (481-768px): 2-column grid with 16px gap
      * Small mobile (<480px): 1-column grid with 12px gap
      * Changed from auto-fit minmax(320px, 1fr) to fixed column counts
    - ENHANCED: Card maximum width constraint (450px)
      * Prevents cards from stretching excessively on wide screens
      * Maintains optimal text line length (50-75 characters)
      * Cards centered within grid cells with justify-items: center
      * Google Material Design 3 compliant card sizing
    - IMPROVED: Responsive padding system with percentage-based values
      * Desktop: 40px + 5% side margins
      * Tablet: 32px + 4% side margins
      * Mobile: 24px + 4% side margins
      * Small mobile: 16px + 4% side margins
    - OPTIMIZED: Visual hierarchy and spacing consistency
      * Professional grid gaps: 24px (desktop), 20px (tablet), 16px (mobile), 12px (small)
      * Better balance between content and whitespace
      * Improved scan-ability and information architecture
    - DESIGN RATIONALE: Based on Apple.com and Google Material Design 3 standards
      * Apple: 1280px container, 480px max card width, 5-8% side margins
      * Google: 1200px container, 500px max card width, 4-column grid system
      * Hybrid approach: 1280px container + 450px cards + 3-column grid

    Changes in v2.9.0 - Advanced Responsive Design & Layout Optimization:
    - CRITICAL: Implemented comprehensive responsive design for Desktop, Tablet, and Mobile
      * Dashboard grid minmax optimized: 320px-1fr for better wrapping
      * Tablet breakpoint (769px-1024px): 2-column layout for optimal viewing
      * Mobile breakpoint (768px): Full responsive with 1-column layout
      * Extra small breakpoint (480px): Compact layout with minimal spacing
    - REDESIGNED: Form elements for mobile accessibility
      * Input fields with proper padding and 16px font size (iOS zoom prevention)
      * Enhanced focus states with visible outlines
      * Placeholder color accessibility improvements
      * Modal buttons with flex layout for better mobile touch
    - ENHANCED: Time-block layout with improved responsiveness
      * Time-block cards with hidden action buttons on desktop (hover reveal)
      * Always visible action buttons on mobile for better UX
      * Responsive grid: 2-column (tablet), 1-column (mobile)
      * Improved padding with CSS variables (var(--spacing-*))
    - IMPROVED: Subject rotation display
      * Flex-wrap support for better responsive behavior
      * Mobile layout: stacked subject names and rotation circles
      * Improved rotation circle sizing (32px) with better touch targets
      * Better font sizing for mobile devices
    - POLISHED: Today's plan section
      * Desktop: 2-column span, Tablet/Mobile: 1-column
      * Minmax reduction for better mobile wrapping
      * Consistent spacing throughout
    - OPTIMIZED: Data management card styling
      * Mobile: Full-width button layout (1-column)
      * Smaller padding and font sizes for mobile
      * Better text contrast with reduced opacity
      * Improved button sizing for touch devices
    - FIXED: Text overflow issues
      * Added word-wrap and overflow handling
      * Modal content max-height with scroll for long forms
      * Better line-height and text sizing consistency
      * Improved card header flex-direction for mobile stacking
    - ENHANCED: Notes section responsiveness
      * Proper textarea min-height and padding
      * Toolbar improved with space-between layout
      * Mobile-optimized toolbar alignment
      * Better visual feedback with transitions

    Changes in v2.8.0 - Comprehensive UX/UI Refinement & Accessibility Enhancement:
    - CRITICAL: Fixed dark mode modal support - all modals now properly use CSS variables
      * Modal background now uses var(--bg-primary) for proper dark mode rendering
      * Form inputs and modals fully responsive to dark mode theme
    - CRITICAL: Enhanced accessibility with proper touch targets
      * Increased action button sizes from 28px to 36px (desktop) and 44px (mobile)
      * Improved keyboard navigation and focus states
    - CRITICAL: Reorganized z-index hierarchy for proper modal layering
      * Fixed modal stacking order when multiple modals are opened
      * Proper backdrop layering with blur effects
    - REDESIGNED: Improved layout consistency and spacing system
      * Standardized all padding/margin to use CSS variables
      * Fixed D-Day card container with CSS grid for better responsiveness
      * Enhanced score entry layout with flexbox for better content flow
    - ENHANCED: Mobile responsiveness improvements
      * Added 480px breakpoint for small mobile devices
      * Improved analytics grid and weekly stats responsive behavior
      * Better touch target positioning on smaller screens
      * Theme toggle button repositioned for mobile clarity
    - IMPROVED: Visual hierarchy and semantic styling
      * Reduced motion support with prefers-reduced-motion media query
      * Better focus-visible states for keyboard navigation
      * Enhanced empty state designs with clear user guidance
      * Improved data management card contrast with backdrop filter
    - POLISHED: Overall accessibility and user experience
      * Added ARIA labels to interactive elements
      * Better semantic HTML structure for score entries
      * Smooth transitions with cubic-bezier timing functions
      * Complete dark mode support for all themed components

    Changes in v2.7.0 - Professional UX/UI Redesign & Dark Mode Fixes:
    - CRITICAL: Fixed dark mode implementation - all components now properly support dark theme
      * Fixed .header and .card to use CSS variables instead of hardcoded white background
      * Fixed all buttons, inputs, and interactive elements for proper dark mode support
      * Enhanced color contrast ratios for better readability in dark mode
    - REDESIGNED: Analytics dashboard with professional card-based layout
      * Enhanced visual hierarchy with gradient backgrounds and depth effects
      * Improved spacing and typography for better readability
      * Added subtle shadows and hover effects for better interactivity
    - ENHANCED: Benchmark progress bars with improved visual design
      * Larger, more prominent progress bars (12px height)
      * Better color coding: green (excellent), blue (good), orange/red (needs improvement)
      * Added percentage labels for instant comprehension
      * Improved animations and transitions
    - IMPROVED: Color system consistency across light and dark modes
      * Unified color palette using CSS variables throughout
      * Better semantic color usage (success, warning, danger)
      * Enhanced accessibility with WCAG-compliant contrast ratios
    - POLISHED: Overall design language and visual consistency
      * Modern card designs with subtle gradients
      * Consistent spacing system (8px base unit)
      * Professional typography hierarchy
      * Smooth transitions and micro-interactions

    Changes in v2.6.0 - Dashboard UX Redesign & Benchmark Integration:
    - REMOVED: "ì˜¤ëŠ˜ì˜ í•™ìŠµ ì¶”ì²œ" section for cleaner interface
    - REMOVED: "ì§‘ì¤‘ í•„ìš” ê³¼ëª©" section to reduce clutter
    - ADDED: Benchmark comparison bars in analytics dashboard
      * Total study hours benchmark: 800-1200h for exam preparation
      * Daily average benchmark: 4-5h/day target
      * Mock exam benchmark: 60 points (passing grade)
      * Progress bars with color-coded indicators (green/blue/orange based on performance)
    - ENHANCED: Analytics dashboard now shows user's position vs. exam pass standards
      * Visual progress bars with animated shimmer effect
      * Responsive color coding based on achievement level
      * Real-time benchmark comparison updates
    - IMPROVED: Overall dashboard layout and visual hierarchy
    - CLEANED: Removed unnecessary backup files and temporary scripts

    Changes in v2.5.0 - Analytics Enhancement, Dark Mode & UX Improvements:
    - CRITICAL: Fixed analytics dashboard to use REAL user data instead of sample data
      * Subject time distribution now calculates from actual time blocks, timer, and progress
      * Mock exam score chart displays real user scores, not hardcoded samples
      * All metrics (total hours, daily average, overall progress) based on actual data
    - Implemented complete DARK MODE with smooth transitions
      * Toggle switch in header with moon/sun icon
      * Dark color palette with proper contrast ratios
      * Saved to localStorage with auto-load on page load
      * All components styled for dark mode (cards, modals, buttons, charts)
    - Enhanced subject focus logic ("ì§‘ì¤‘ í•„ìš” ê³¼ëª©")
      * Priority based on progress percentage, rotation count, and mock exam performance
      * Clear visual indicators (red/orange/yellow badges)
      * Sorted by actual priority (lowest progress first)
      * Shows success message when all subjects on track
    - Added professional SVG-based favicon (book with checkmark icon)
    - Updated all "ë²•ë¬´ì‚¬" references to "ì‹œí—˜" for generic exam tracking
    - Improved chart visualizations with better animations and responsiveness
    - Enhanced real-time analytics updates when user adds data
    - Better error handling and edge case management
    - Optimized performance for chart rendering

Changes in v2.4.0 - Professional Design System & Data Management (ACTUAL IMPLEMENTATION):
    - CRITICAL: Added comprehensive Import/Export functionality for all study data
      * Export data to JSON file (study-data-YYYY-MM-DD.json)
      * Import data with validation and preview modal
      * Automatic backup to session storage before import
      * Comprehensive error handling and recovery
    - Implemented dedicated Data Management section with gradient card design
    - Enhanced CSS design system with complete color palette and spacing variables
    - Added import preview modal with detailed data statistics
    - Improved button system with glassmorphism effects for data management
    - Enhanced mobile responsiveness with 56px/60px touch targets for data buttons
    - Added loading states and smooth animations for import/export operations
    - Implemented professional typography scale and spacing system
    - Enhanced accessibility with better focus states and ARIA labels
    - Added comprehensive data validation and error handling
    - Improved visual hierarchy with gradient backgrounds for data management
    - Better user feedback with toast notifications for all operations

    Changes in v2.3.0 - UX/UI Major Upgrade:
    - CRITICAL: Completely replaced all alert()/prompt()/confirm() with modern modal dialogs
    - Added separate D-day counters for both 1ì°¨ and 2ì°¨ exams with editable dates
    - Implemented visual urgency indicators (color changes as exam approaches)
    - Added comprehensive toast notification system (non-blocking, auto-dismiss)
    - Modal-based editing for ALL operations (subject progress, time blocks, mock scores, goals)
    - All edit forms now show multiple fields in ONE modal (no more sequential prompts)
    - Enhanced keyboard shortcuts (ESC to close modals, better accessibility)
    - Improved mobile responsiveness with better touch targets
    - Added form validation with clear error messages
    - Better visual feedback for all user actions
    - Removed redundant Pomodoro timer (regular timer serves same purpose)
    - Improved loading states and error handling throughout

    Changes in v2.2.0:
    - Added Pomodoro timer (25min work / 5min break) with visual & audio notifications
    - Enhanced time block completion to use actual hours instead of hardcoded 2 hours
    - Added customizable target problem count per subject
    - Added hours field to time blocks for accurate time tracking
    - Corrected 2ì°¨ exam subjects based on official ë²•ë¬´ì‚¬ exam structure
    - Removed study mode selector (ì§ì¥ì¸/ì „ì—…/ì£¼ë§ì „ì‚¬ modes)
    - Improved UX with better time tracking and progress customization

    Changes in v2.1.0:
    - Added comprehensive Study Analytics Dashboard with visual charts
    - Added Goal Setting & Milestone tracking system
    - Added Weak Subject Identifier with priority recommendations
    - Added Study Streak Tracker with gamification elements
    - Added Smart Study Recommendations based on patterns
    - Enhanced UI with collapsible sections and improved data visualization

    Changes in v2.0.0:
    - Added support for 2ì°¨ (secondary) exam subjects
    - Fixed subject progress editing functionality
    - Fixed mock exam score delete functionality (always visible now)
    - Fixed study strategy (time blocks) edit/delete functionality
    - Improved event handlers to use proper onclick bindings
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹œí—˜ ì „ëµì  í•™ìŠµ ì‹œìŠ¤í…œ (1ì°¨/2ì°¨) v3.6.0</title>
    <!-- Favicon: Book with checkmark icon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect x='20' y='15' width='60' height='70' rx='3' fill='%233182CE'/%3E%3Cpath d='M25 20h50v60H25z' fill='%23fff'/%3E%3Cpath d='M30 30h40M30 40h35M30 50h40M30 60h30' stroke='%233182CE' stroke-width='2' fill='none'/%3E%3Ccircle cx='75' cy='75' r='18' fill='%2348BB78'/%3E%3Cpath d='M67 75l6 6 12-12' stroke='%23fff' stroke-width='3' fill='none'/%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect x='20' y='15' width='60' height='70' rx='3' fill='%233182CE'/%3E%3Cpath d='M25 20h50v60H25z' fill='%23fff'/%3E%3Cpath d='M30 30h40M30 40h35M30 50h40M30 60h30' stroke='%233182CE' stroke-width='2' fill='none'/%3E%3Ccircle cx='75' cy='75' r='18' fill='%2348BB78'/%3E%3Cpath d='M67 75l6 6 12-12' stroke='%23fff' stroke-width='3' fill='none'/%3E%3C/svg%3E">
    <!-- Chart.js v4.4.1 - Data Visualization Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Smooth scrolling - Apple style */
        html {
            scroll-behavior: smooth;
        }

        /* Reduced motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }
        
        :root {
            /* ============================================
               APPLE.COM INSPIRED DESIGN SYSTEM (2024-2025)
               ============================================ */

            /* Primary Font Stack - San Francisco inspired */
            --font-primary: -apple-system, BlinkMacSystemFont, "SF Pro Display",
                            "SF Pro Text", "Segoe UI", "Pretendard",
                            "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;

            /* Apple Light Mode Colors */
            --bg-primary: #fbfbfd;          /* Softer than pure white */
            --bg-secondary: #ffffff;        /* Pure white for cards */
            --bg-tertiary: #f5f5f7;         /* Subtle gray background */
            --bg-light: #fbfbfd;
            --bg-dark: #1A202C;

            --text-primary: #1d1d1f;        /* Apple's softer black */
            --text-secondary: #6e6e73;      /* Medium gray */
            --text-tertiary: #86868b;       /* Light gray */
            --text-light: #FFFFFF;

            /* Apple Color Palette */
            --primary-color: #1d1d1f;
            --primary-dark: #000000;
            --primary-light: #6e6e73;

            --accent-color: #0071e3;        /* Apple Blue */
            --accent-dark: #006edb;
            --accent-light: #0077ed;
            --accent-hover: #0077ed;

            --success-color: #30d158;       /* Apple Green */
            --success-dark: #28a745;
            --success-light: #4de072;

            --warning-color: #ff9f0a;       /* Apple Orange */
            --warning-dark: #e68900;
            --warning-light: #ffb340;

            --danger-color: #ff3b30;        /* Apple Red */
            --danger-dark: #e6342a;
            --danger-light: #ff6259;

            --info-color: #007aff;          /* Apple Info Blue */

            /* Borders & Dividers - Very subtle */
            --border-color: rgba(0, 0, 0, 0.06);
            --border-light: rgba(0, 0, 0, 0.04);
            --border-dark: rgba(0, 0, 0, 0.12);
            --border-hover: rgba(0, 0, 0, 0.12);

            /* Shadows - Enhanced depth perception */
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.12), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
            --shadow-glow: 0 0 20px rgba(0, 113, 227, 0.3);

            /* Spacing Scale - Apple uses 12px/16px base */
            --spacing-2xs: 4px;
            --spacing-xs: 8px;
            --spacing-sm: 12px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --spacing-2xl: 48px;
            --spacing-3xl: 64px;
            --spacing-4xl: 80px;
            --spacing-5xl: 96px;

            /* Typography Scale - Apple inspired */
            --font-size-2xs: 0.6875rem;     /* 11px */
            --font-size-xs: 0.8125rem;      /* 13px */
            --font-size-sm: 0.9375rem;      /* 15px */
            --font-size-base: 1.0625rem;    /* 17px - Apple's body text */
            --font-size-lg: 1.3125rem;      /* 21px */
            --font-size-xl: 1.625rem;       /* 26px */
            --font-size-2xl: 2rem;          /* 32px */
            --font-size-3xl: 2.5rem;        /* 40px */
            --font-size-4xl: 3rem;          /* 48px */
            --font-size-5xl: 4rem;          /* 64px */
            --font-size-6xl: 5rem;          /* 80px */

            /* Font Weights */
            --font-light: 300;
            --font-normal: 400;
            --font-medium: 500;
            --font-semibold: 600;
            --font-bold: 700;

            /* Line Heights - Apple's standards */
            --line-height-tight: 1.0833;    /* Headlines */
            --line-height-snug: 1.1667;     /* Subheadings */
            --line-height-normal: 1.47;     /* Body - Apple's standard */
            --line-height-relaxed: 1.625;   /* Large text */

            /* Letter Spacing */
            --letter-spacing-tight: -0.01em;
            --letter-spacing-normal: 0;
            --letter-spacing-wide: 0.01em;

            /* Border Radius - Larger, more modern */
            --radius-sm: 10px;
            --radius-md: 16px;
            --radius-lg: 20px;
            --radius-xl: 24px;
            --radius-2xl: 28px;
            --radius-full: 9999px;

            /* Transitions - Apple's smooth animations */
            --transition-fast: 200ms;
            --transition-base: 400ms;
            --transition-slow: 600ms;
            --transition-slower: 800ms;

            /* Easing Functions - Apple signature */
            --ease-apple: cubic-bezier(0.28, 0.11, 0.32, 1);
            --ease-apple-in: cubic-bezier(0.4, 0, 1, 1);
            --ease-apple-out: cubic-bezier(0, 0, 0.2, 1);
            --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);

            /* Z-index Scale */
            --z-base: 1;
            --z-dropdown: 100;
            --z-sticky: 200;
            --z-modal: 1000;
            --z-toast: 2000;
            --z-tooltip: 3000;

            /* Glassmorphism - Apple style */
            --glass-bg: rgba(255, 255, 255, 0.72);
            --glass-border: rgba(255, 255, 255, 0.18);
            --glass-blur: 20px;

            /* Legacy support (maintain backwards compatibility) */
            --primary: var(--primary-color);
            --accent: var(--accent-color);
            --success: var(--success-color);
            --warning: var(--warning-color);
            --danger: var(--danger-color);
            --border: var(--border-color);
        }

        /* Apple Dark Mode - Deep Black with Vibrant Accents (v3.6.0 Enhanced) */
        [data-theme="dark"] {
            /* Dark Background Colors - Ultra Deep Black Approach */
            --bg-primary: #0a0a0a;          /* Nearly black - sophisticated main background */
            --bg-secondary: #141414;        /* Elevated cards - enhanced contrast */
            --bg-tertiary: #1f1f1f;         /* Tertiary surfaces - clear hierarchy */
            --bg-light: #0a0a0a;
            --bg-dark: #000000;

            /* Dark Text Colors - Maximum Visibility & Warmth */
            --text-primary: #f5f5f5;        /* Warm white - softer on eyes (WCAG AAA 18.5:1) */
            --text-secondary: #e0e0e0;      /* Bright light gray - WCAG AAA compliant (15:1) */
            --text-tertiary: #b0b0b0;       /* Medium gray - clear hierarchy (9:1) */
            --text-light: #f5f5f5;

            /* Dark Borders & Dividers - Enhanced Clarity */
            --border-color: rgba(255, 255, 255, 0.18);   /* More visible borders */
            --border-light: rgba(255, 255, 255, 0.08);
            --border-dark: rgba(255, 255, 255, 0.25);
            --border-hover: rgba(255, 255, 255, 0.35);

            /* Dark Shadows - Deep Depth with Subtle Glow */
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.8), 0 1px 2px rgba(0, 0, 0, 0.7), 0 0 8px rgba(255, 255, 255, 0.02);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.85), 0 2px 4px rgba(0, 0, 0, 0.75), 0 0 12px rgba(255, 255, 255, 0.03);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.9), 0 4px 8px rgba(0, 0, 0, 0.8), 0 0 16px rgba(255, 255, 255, 0.04);
            --shadow-xl: 0 20px 30px rgba(0, 0, 0, 0.95), 0 10px 15px rgba(0, 0, 0, 0.85), 0 0 24px rgba(255, 255, 255, 0.05);
            --shadow-2xl: 0 30px 60px rgba(0, 0, 0, 0.98), 0 15px 30px rgba(0, 0, 0, 0.9);
            --shadow-glow: 0 0 24px rgba(41, 151, 255, 0.4), 0 0 12px rgba(41, 151, 255, 0.2);
            --shadow-glow-success: 0 0 24px rgba(48, 209, 88, 0.4), 0 0 12px rgba(48, 209, 88, 0.2);
            --shadow-glow-warning: 0 0 24px rgba(255, 159, 10, 0.4), 0 0 12px rgba(255, 159, 10, 0.2);
            --shadow-glow-danger: 0 0 24px rgba(255, 69, 58, 0.4), 0 0 12px rgba(255, 69, 58, 0.2);

            /* Adjusted Colors for Dark Mode - Vibrant & Clear */
            --primary-color: #f5f5f5;
            --primary-dark: #ffffff;
            --primary-light: #e0e0e0;

            --accent-color: #3da1ff;        /* Vibrant blue - enhanced visibility */
            --accent-dark: #1a8fff;
            --accent-light: #5cb3ff;
            --accent-hover: #5cb3ff;

            --success-color: #32d760;       /* Vivid green - enhanced saturation */
            --success-dark: #2abd4f;
            --success-light: #52e77c;

            --warning-color: #ffaa00;       /* Vivid orange - enhanced visibility */
            --warning-dark: #ff9500;
            --warning-light: #ffc040;

            --danger-color: #ff5545;        /* Vivid red - enhanced saturation */
            --danger-dark: #ff3b30;
            --danger-light: #ff7569;

            --info-color: #0a84ff;

            /* Glassmorphism - Dark mode Enhanced */
            --glass-bg: rgba(20, 20, 20, 0.8);
            --glass-border: rgba(255, 255, 255, 0.12);
            --glass-blur: 24px;
        }

        /* Dark Mode Form Elements Override - Enhanced Visibility */
        [data-theme="dark"] .form-input,
        [data-theme="dark"] .form-select,
        [data-theme="dark"] textarea {
            background-color: #1f1f1f;
            color: #f5f5f5;
            border-color: rgba(255, 255, 255, 0.18);
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        [data-theme="dark"] .form-input:hover,
        [data-theme="dark"] .form-select:hover,
        [data-theme="dark"] textarea:hover {
            background-color: #262626;
            border-color: rgba(255, 255, 255, 0.25);
        }

        [data-theme="dark"] .form-input:focus,
        [data-theme="dark"] .form-select:focus,
        [data-theme="dark"] textarea:focus {
            background-color: #2a2a2a;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(61, 161, 255, 0.2), inset 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        [data-theme="dark"] .form-input::placeholder,
        [data-theme="dark"] textarea::placeholder {
            color: #b0b0b0;
            opacity: 1;
        }

        /* Dark Mode Button Adjustments - Enhanced Visibility */
        [data-theme="dark"] .btn-secondary {
            background-color: #1f1f1f;
            border-color: rgba(255, 255, 255, 0.18);
            color: #f5f5f5;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        [data-theme="dark"] .btn-secondary:hover {
            background-color: #2a2a2a;
            border-color: rgba(255, 255, 255, 0.30);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.6), 0 0 12px rgba(255, 255, 255, 0.05);
            transform: translateY(-1px);
        }

        [data-theme="dark"] .btn-secondary:active {
            background-color: #262626;
            transform: translateY(0);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
        }

        /* Dark Mode Modal Adjustments - Enhanced Depth */
        [data-theme="dark"] .modal-content {
            background-color: #141414;
            border-color: rgba(255, 255, 255, 0.18);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.95),
                        0 15px 30px rgba(0, 0, 0, 0.85),
                        0 0 0 1px rgba(255, 255, 255, 0.08);
        }

        /* Dark Mode Time Block Cards - Enhanced Contrast */
        [data-theme="dark"] .time-block {
            background-color: #1f1f1f;
            border-color: rgba(255, 255, 255, 0.18);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6), 0 0 8px rgba(255, 255, 255, 0.02);
        }

        [data-theme="dark"] .time-block:hover {
            background-color: #262626;
            border-color: rgba(255, 255, 255, 0.25);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7), 0 0 12px rgba(255, 255, 255, 0.04);
        }

        /* Dark Mode Progress Bars - Enhanced Visibility */
        [data-theme="dark"] .progress-bar-track {
            background-color: #1f1f1f;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        /* Dark Mode Analytics Elements - Enhanced Readability */
        [data-theme="dark"] .analytics-label {
            color: #e0e0e0;
            font-weight: 500;
        }

        [data-theme="dark"] .analytics-value {
            -webkit-text-fill-color: unset;
            background: unset;
            background-clip: unset;
            color: #f5f5f5;
            font-weight: 700;
        }

        [data-theme="dark"] .benchmark-label {
            color: #b0b0b0;
        }

        [data-theme="dark"] .benchmark-percentage {
            color: #3da1ff;
            font-weight: 600;
        }

        [data-theme="dark"] .analytics-benchmark {
            border-color: rgba(255, 255, 255, 0.18);
        }

        [data-theme="dark"] .analytics-stat {
            background-color: #141414;
            border-color: rgba(255, 255, 255, 0.18);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6), 0 0 8px rgba(255, 255, 255, 0.02);
        }

        [data-theme="dark"] .analytics-stat:hover {
            background-color: #1a1a1a;
            border-color: rgba(255, 255, 255, 0.25);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7), 0 0 12px rgba(255, 255, 255, 0.04);
        }

        /* Dark Mode Card Elements - Enhanced Depth & Contrast */
        [data-theme="dark"] .card {
            background-color: #141414;
            border-color: rgba(255, 255, 255, 0.18);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7), 0 0 12px rgba(255, 255, 255, 0.03);
        }

        [data-theme="dark"] .card:hover {
            background-color: #1a1a1a;
            border-color: rgba(255, 255, 255, 0.25);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.8), 0 0 16px rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
        }

        [data-theme="dark"] .card-title {
            color: #f5f5f5;
            font-weight: 600;
        }

        /* Dark Mode General Text Override - Enhanced Brightness */
        [data-theme="dark"] body,
        [data-theme="dark"] .card,
        [data-theme="dark"] .analytics-stat,
        [data-theme="dark"] .time-block,
        [data-theme="dark"] .modal-content {
            color: #f5f5f5;
        }

        /* Dark Mode Timer Display - Enhanced Glow */
        [data-theme="dark"] .timer-display {
            background: linear-gradient(135deg, #3da1ff 0%, #5cb3ff 50%, #7dc5ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 0 12px rgba(61, 161, 255, 0.4));
        }

        [data-theme="dark"] .timer-display::before {
            background: linear-gradient(90deg, #3da1ff, #5cb3ff, #7dc5ff);
        }

        /* Dark Mode Streak Enhancements - Vivid Gradient */
        [data-theme="dark"] .streak-number {
            background: linear-gradient(135deg, #ff7575 0%, #ff9b85 50%, #ffb199 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 0 12px rgba(255, 117, 117, 0.4));
        }

        [data-theme="dark"] .streak-stat-item {
            background: #1f1f1f;
            border-color: rgba(255, 255, 255, 0.18);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6), 0 0 8px rgba(255, 255, 255, 0.02);
        }

        [data-theme="dark"] .streak-stat-item:hover {
            background: #262626;
            border-color: var(--accent-color);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7),
                        0 0 12px rgba(61, 161, 255, 0.3);
            transform: translateY(-2px);
        }

        /* Dark Mode Progress Bar - Enhanced Contrast */
        [data-theme="dark"] .progress-bar {
            background: #1f1f1f;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        [data-theme="dark"] .progress-fill {
            background: linear-gradient(90deg, #3da1ff, #5cb3ff, #32d760);
            box-shadow: 0 0 12px rgba(61, 161, 255, 0.4);
        }

        /* Light Mode: Gradient Cards with White Text */
        .analytics-stat[style*="background: linear-gradient"] {
            color: white !important;
        }

        .analytics-stat[style*="background: linear-gradient"] > div {
            color: white !important;
        }

        .analytics-stat[style*="background: linear-gradient"] div[style*="font-size"],
        .analytics-stat[style*="background: linear-gradient"] #completion-date-display,
        .analytics-stat[style*="background: linear-gradient"] #days-remaining-display,
        .analytics-stat[style*="background: linear-gradient"] #learning-pace-display,
        .analytics-stat[style*="background: linear-gradient"] #metacognitive-feedback,
        .analytics-stat[style*="background: linear-gradient"] #motivation-message {
            color: white !important;
        }

        /* Dark Mode: Override gradient cards for better readability - Enhanced */
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] {
            background: linear-gradient(135deg, #3da1ff, #2080dd) !important;
            color: white !important;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7),
                        0 0 16px rgba(61, 161, 255, 0.3) !important;
            border-color: rgba(61, 161, 255, 0.4) !important;
        }

        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"]:hover {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.8),
                        0 0 24px rgba(61, 161, 255, 0.4) !important;
        }

        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] > div,
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] div[style*="font-size"],
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] #completion-date-display,
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] #days-remaining-display,
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] #learning-pace-display,
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] #metacognitive-feedback,
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] #motivation-message {
            color: white !important;
        }

        /* Dark Mode: Advice and Average Sections - Enhanced Contrast */
        [data-theme="dark"] div[style*="background: #FFF5F5"] {
            background-color: #1f1f1f !important;
            border: 1px solid rgba(255, 85, 69, 0.3) !important;
            color: #f5f5f5 !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6) !important;
        }

        [data-theme="dark"] div[style*="background: #FFF5F5"] div {
            color: #f5f5f5 !important;
        }

        [data-theme="dark"] div[style*="color: var(--danger)"] {
            color: #ff5545 !important;
        }

        /* Apple-style smooth transitions */
        body, .card, .modal-content, .time-block, .subject-rotation,
        .score-entry, .goal-item, .weak-subject, .form-input, .form-select {
            transition: background-color 0.4s var(--ease-apple),
                        color 0.4s var(--ease-apple),
                        border-color 0.4s var(--ease-apple);
        }

        /* Apply Apple easing to all transitions */
        * {
            transition-timing-function: var(--ease-apple);
        }

        /* Dark mode toggle button */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: var(--accent-color);
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            min-width: 50px;
            min-height: 50px;
        }

        .theme-toggle:hover {
            transform: scale(1.1) rotate(15deg);
            box-shadow: var(--shadow-xl);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        .theme-toggle:focus-visible {
            outline: 3px solid var(--accent-light);
            outline-offset: 3px;
        }

        @media (max-width: 768px) {
            .theme-toggle {
                top: 10px;
                right: 10px;
                width: 44px;
                height: 44px;
                font-size: 1.2rem;
            }
        }

        
        body {
            font-family: var(--font-primary);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-size: var(--font-size-base);
            line-height: var(--line-height-normal);
            letter-spacing: var(--letter-spacing-normal);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: background-color 0.4s var(--ease-apple),
                        color 0.4s var(--ease-apple);
            min-height: 100vh;
        }

        html {
            background-color: var(--bg-primary);
            transition: background-color 0.4s var(--ease-apple);
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: var(--spacing-3xl) 5%;
        }

        /* Responsive container padding - Apple style with generous spacing */
        @media (max-width: 1024px) {
            .container {
                padding: var(--spacing-2xl) 4%;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: var(--spacing-xl) 4%;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: var(--spacing-lg) 4%;
            }
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ - Apple minimalist approach */
        .header {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: all 0.4s var(--ease-apple);
        }

        .header:hover {
            box-shadow: var(--shadow-lg);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
            flex-wrap: wrap;
            gap: var(--spacing-lg);
        }
        
        .title {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            line-height: var(--line-height-tight);
            letter-spacing: var(--letter-spacing-tight);
        }
        
        .d-day-badge {
            background: var(--danger);
            color: white;
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 1.3rem;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        .study-mode-selector {
            display: flex;
            gap: 10px;
            background: var(--bg-light);
            padding: 5px;
            border-radius: 8px;
        }
        
        .mode-btn {
            padding: 12px 24px;
            border: 2px solid var(--border-color);
            background: var(--bg-secondary);
            border-radius: var(--radius-full);
            cursor: pointer;
            transition: all var(--transition-base) var(--ease-apple);
            font-weight: 600;
            font-size: 1rem;
            color: var(--text-secondary);
            position: relative;
            overflow: hidden;
        }

        .mode-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 113, 227, 0.1), transparent);
            transition: left 0.5s;
        }

        .mode-btn:hover::before {
            left: 100%;
        }

        .mode-btn:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .mode-btn.active {
            background: linear-gradient(135deg, var(--accent-color), var(--accent-light));
            color: white;
            border-color: transparent;
            box-shadow: var(--shadow-lg);
            transform: scale(1.05);
        }

        .mode-btn.active:hover {
            transform: scale(1.05) translateY(-2px);
        }
        
        /* ëŒ€ì‹œë³´ë“œ ê·¸ë¦¬ë“œ - Apple/Google style with max-width cards */
        /* ëŒ€ì‹œë³´ë“œ ê·¸ë¦¬ë“œ - Single Column Layout (User Preference) */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
            margin-bottom: var(--spacing-lg);
            width: 100%;
        }

        /* Responsive grid gaps only */
        @media (max-width: 1024px) {
            .dashboard-grid {
                gap: 20px;
            }
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                gap: 16px;
            }
        }

        @media (max-width: 480px) {
            .dashboard-grid {
                gap: 12px;
            }
        }
        
        /* Card Design - Apple minimalist style */
        .card {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: transform var(--transition-base) var(--ease-apple),
                        box-shadow var(--transition-base) var(--ease-apple),
                        background-color var(--transition-base) var(--ease-apple);
            position: relative;
            width: 100%;
            animation: cardFadeIn 0.6s var(--ease-apple) backwards;
        }

        @keyframes cardFadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Stagger card animations */
        .card:nth-child(1) { animation-delay: 0.05s; }
        .card:nth-child(2) { animation-delay: 0.1s; }
        .card:nth-child(3) { animation-delay: 0.15s; }
        .card:nth-child(4) { animation-delay: 0.2s; }
        .card:nth-child(5) { animation-delay: 0.25s; }
        .card:nth-child(6) { animation-delay: 0.3s; }
        .card:nth-child(7) { animation-delay: 0.35s; }
        .card:nth-child(8) { animation-delay: 0.4s; }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
        }

        .card:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 3px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }
        
        .card-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            line-height: var(--line-height-snug);
            letter-spacing: var(--letter-spacing-tight);
        }
        
        .card-actions {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: var(--bg-light);
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.9rem;
            padding: 0;
            min-width: 36px;
            min-height: 36px;
        }

        .action-btn:hover {
            background: var(--accent);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .action-btn.edit:hover {
            background: var(--warning);
        }

        .action-btn.delete:hover {
            background: var(--danger);
        }

        .action-btn:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        @media (max-width: 768px) {
            .action-btn {
                width: 44px;
                height: 44px;
                min-width: 44px;
                min-height: 44px;
                font-size: 1rem;
            }
        }
        
        /* ì˜¤ëŠ˜ì˜ í•™ìŠµ ê³„íš */
        /* ì˜¤ëŠ˜ì˜ í•™ìŠµ ê³„íš - Desktopì—ì„œ 2ì—´ ì°¨ì§€, max-width ì œì•½ ì œê±° */
        /* ì˜¤ëŠ˜ì˜ í•™ìŠµ ê³„íš - Single Column */
        .today-plan {
            width: 100%;
        }

        .time-blocks {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }

        @media (max-width: 768px) {
            .time-blocks {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--spacing-xs);
                margin-bottom: var(--spacing-md);
            }
        }

        @media (max-width: 480px) {
            .time-blocks {
                grid-template-columns: 1fr;
                gap: var(--spacing-xs);
            }
        }
        
        .time-block {
            background: var(--bg-light);
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            border-left: 4px solid var(--accent);
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .time-block.completed {
            background: var(--success-light);
            border-left-color: var(--success);
        }

        [data-theme="dark"] .time-block.completed {
            background: rgba(72, 187, 120, 0.15);
        }

        .time-block:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow-sm);
        }

        .time-block:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        .time-block-actions {
            position: absolute;
            top: var(--spacing-sm);
            right: var(--spacing-sm);
            display: flex;
            gap: var(--spacing-xs);
            opacity: 0;
            transition: opacity var(--transition-base);
        }

        .time-block:hover .time-block-actions {
            opacity: 1;
        }

        @media (max-width: 768px) {
            .time-block-actions {
                opacity: 1;
            }
        }
        
        .time-block-btn {
            width: 20px;
            height: 20px;
            border: none;
            background: rgba(255,255,255,0.8);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.7rem;
            transition: all 0.3s;
        }
        
        .time-block-btn:hover {
            background: var(--accent);
            color: white;
        }
        
        .time-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }
        
        .time-subject {
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .time-detail {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .check-btn {
            margin-top: 10px;
            padding: 6px 12px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            color: var(--text-primary);
            transition: all 0.3s;
        }

        .check-btn:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        .check-btn.checked {
            background: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        /* í¬ëª¨ë„ë¡œ íƒ€ì´ë¨¸ */
        .pomodoro-display {
            text-align: center;
            padding: 20px 0;
        }

        .pomodoro-mode {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .pomodoro-mode.break {
            color: var(--success);
        }

        /* Pomodoro Quick Time Buttons */
        .pomodoro-quick-time {
            margin-top: 16px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .quick-time-btn {
            padding: 12px;
            background: linear-gradient(135deg, rgba(0, 113, 227, 0.08), rgba(0, 122, 255, 0.12));
            border: 1.5px solid rgba(0, 113, 227, 0.25);
            color: var(--accent-color);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all var(--transition-base) var(--ease-apple);
            position: relative;
            overflow: hidden;
        }

        .quick-time-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(0, 113, 227, 0.3), transparent);
            transform: translate(-50%, -50%);
            transition: width 0.4s, height 0.4s;
            border-radius: 50%;
        }

        .quick-time-btn:hover::before {
            width: 200px;
            height: 200px;
        }

        .quick-time-btn:hover {
            background: linear-gradient(135deg, rgba(0, 113, 227, 0.15), rgba(0, 122, 255, 0.2));
            border-color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .quick-time-btn:active {
            transform: translateY(0) scale(0.97);
            box-shadow: var(--shadow-sm);
        }

        .quick-time-hint {
            margin-top: 10px;
            font-size: 0.85rem;
            color: var(--text-tertiary);
            text-align: center;
            font-weight: 500;
        }

        /* Dark mode quick time buttons */
        [data-theme="dark"] .quick-time-btn {
            background: linear-gradient(135deg, rgba(41, 151, 255, 0.12), rgba(64, 156, 255, 0.18));
            border-color: rgba(41, 151, 255, 0.3);
            color: var(--accent-color);
        }

        [data-theme="dark"] .quick-time-btn:hover {
            background: linear-gradient(135deg, rgba(41, 151, 255, 0.2), rgba(64, 156, 255, 0.3));
            border-color: var(--accent-color);
        }

        .pomodoro-mode.work {
            color: var(--danger);
        }

        .pomodoro-session-count {
            margin-top: 15px;
            font-size: 1rem;
            color: var(--text-secondary);
        }

        .pomodoro-session-count span {
            font-weight: bold;
            color: var(--accent);
            font-size: 1.2rem;
        }

        /* ê¸°ì¶œë¬¸ì œ íšŒë… íŠ¸ë˜ì»¤ */
        .rotation-tracker {
            margin-top: var(--spacing-md);
        }

        .subject-rotation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-sm);
            background: var(--bg-light);
            border-radius: var(--radius-md);
            margin-bottom: var(--spacing-sm);
            position: relative;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }

        .subject-name {
            font-weight: 600;
            flex: 1;
            cursor: pointer;
            min-width: 100px;
            font-size: var(--font-size-sm);
        }

        .rotation-circles {
            display: flex;
            gap: var(--spacing-xs);
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        .rotation-circle {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-xs);
            cursor: pointer;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            flex-shrink: 0;
        }

        .rotation-circle:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        @media (max-width: 768px) {
            .rotation-circles {
                flex-basis: 100%;
                justify-content: flex-start;
            }
        }

        @media (max-width: 480px) {
            .subject-rotation {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-xs);
            }

            .rotation-circles {
                width: 100%;
                gap: var(--spacing-xs);
            }
        }
        
        .rotation-circle.completed {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }
        
        .rotation-circle.current {
            background: var(--warning);
            color: white;
            border-color: var(--warning);
            animation: blink 1.5s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        
        /* í•™ìŠµ íƒ€ì´ë¨¸ */
        .timer-display {
            font-size: 5.5rem;
            font-weight: 700;
            text-align: center;
            margin: 30px 0;
            font-family: 'SF Mono', 'Consolas', 'Monaco', monospace;
            background: linear-gradient(135deg, var(--accent-color) 0%, var(--info-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.02em;
            line-height: 1;
            text-shadow: 0 4px 20px rgba(0, 113, 227, 0.2);
            position: relative;
            padding: 20px 0;
        }

        .timer-display::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-color), var(--info-color));
            border-radius: 2px;
            opacity: 0.6;
        }
        
        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .timer-btn {
            padding: 14px 28px;
            border: none;
            border-radius: var(--radius-full);
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all var(--transition-base) var(--ease-apple);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-md);
        }

        .timer-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .timer-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .timer-btn.start {
            background: linear-gradient(135deg, var(--success-color), var(--success-light));
            color: white;
        }

        .timer-btn.start:hover {
            background: linear-gradient(135deg, var(--success-dark), var(--success-color));
        }

        .timer-btn.pause {
            background: linear-gradient(135deg, var(--warning-color), var(--warning-light));
            color: white;
        }

        .timer-btn.pause:hover {
            background: linear-gradient(135deg, var(--warning-dark), var(--warning-color));
        }

        .timer-btn.reset {
            background: linear-gradient(135deg, var(--danger-color), var(--danger-light));
            color: white;
        }

        .timer-btn.reset:hover {
            background: linear-gradient(135deg, var(--danger-dark), var(--danger-color));
        }

        .timer-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: var(--shadow-xl);
        }

        .timer-btn:active {
            transform: translateY(-1px) scale(0.98);
            box-shadow: var(--shadow-sm);
        }

        .timer-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* ì£¼ê°„ í•™ìŠµ í†µê³„ */
        .weekly-stats {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .day-stat {
            text-align: center;
            padding: 10px;
            background: var(--bg-light);
            border-radius: 8px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .day-stat.today {
            background: var(--accent);
            color: white;
        }
        
        .day-stat.completed {
            background: var(--success);
            color: white;
        }
        
        .day-name {
            font-size: 0.85rem;
            margin-bottom: 5px;
        }
        
        .day-hours {
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        /* ê³¼ëª©ë³„ ì§„ë„ */
        .subject-progress {
            margin-top: 15px;
        }
        
        .progress-item {
            margin-bottom: 15px;
            position: relative;
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            cursor: pointer;
        }
        
        .progress-label {
            font-weight: 600;
        }
        
        .progress-value {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .progress-bar {
            height: 24px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-full);
            overflow: hidden;
            cursor: pointer;
            border: 1px solid var(--border-color);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
            position: relative;
        }

        .progress-bar:hover {
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.08), var(--shadow-sm);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color), var(--info-color), var(--success-color));
            background-size: 200% 100%;
            animation: progressShine 3s ease-in-out infinite;
            border-radius: 10px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        /* ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ íŠ¸ë˜ì»¤ */
        .mock-scores {
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .score-entry {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: var(--bg-light);
            border-radius: 8px;
            margin-bottom: 8px;
            position: relative;
        }
        
        .score-date {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .score-value {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 20px;
            background: var(--bg-primary);
        }
        
        .score-value.pass {
            color: var(--success);
            border: 2px solid var(--success);
        }
        
        .score-value.fail {
            color: var(--danger);
            border: 2px solid var(--danger);
        }
        
        .score-actions {
            position: absolute;
            right: 80px;
            display: flex;
            gap: 5px;
            opacity: 1;
            transition: opacity 0.3s;
        }

        .score-action-btn {
            width: 24px;
            height: 24px;
            border: none;
            background: var(--bg-secondary);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            color: var(--text-primary);
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
        }

        .score-action-btn:hover {
            background: var(--accent-color);
            color: white;
            transform: scale(1.1);
        }
        
        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        /* Apple-style Modal with Glassmorphism */
        .modal {
            display: none;
            position: fixed;
            z-index: var(--z-modal);
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            animation: fadeIn 0.4s var(--ease-apple);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes progressShine {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .modal.show {
            display: block;
        }

        .modal-content {
            background: var(--bg-secondary);
            color: var(--text-primary);
            margin: 10% auto;
            padding: var(--spacing-2xl);
            border-radius: var(--radius-2xl);
            width: 90%;
            max-width: 540px;
            animation: slideInUp 0.5s var(--ease-apple);
            box-shadow: var(--shadow-2xl);
            border: 1px solid var(--border-color);
            z-index: calc(var(--z-modal) + 10);
        }

        @keyframes slideInUp {
            from {
                transform: translateY(30px) scale(0.96);
                opacity: 0;
            }
            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: var(--font-size-xl);
            font-weight: var(--font-semibold);
            line-height: var(--line-height-tight);
            letter-spacing: var(--letter-spacing-tight);
            color: var(--text-primary);
        }
        
        .modal-close {
            width: 30px;
            height: 30px;
            border: none;
            background: var(--bg-light);
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
        }
        
        .modal-close:hover {
            background: var(--danger);
            color: white;
        }
        
        .modal-body {
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: var(--spacing-md);
        }

        .form-label {
            display: block;
            margin-bottom: var(--spacing-xs);
            font-weight: 500;
            color: var(--text-secondary);
            font-size: var(--font-size-sm);
        }

        .form-input {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--bg-primary);
            color: var(--text-primary);
            box-sizing: border-box;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
            transform: translateY(-1px);
        }

        .form-input:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        .form-input::placeholder {
            color: var(--text-tertiary);
        }

        .form-select {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            background: var(--bg-primary);
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            box-sizing: border-box;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
        }

        .form-select:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        @media (max-width: 480px) {
            .form-input,
            .form-select {
                padding: var(--spacing-sm);
                font-size: 16px; /* iOS zoom prevention */
            }

            .form-group {
                margin-bottom: var(--spacing-sm);
            }
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-sm);
            margin-top: var(--spacing-lg);
            flex-wrap: wrap;
        }

        .modal-btn {
            padding: var(--spacing-sm) var(--spacing-lg);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: var(--font-size-sm);
            cursor: pointer;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
        }

        .modal-btn.cancel {
            background: var(--bg-light);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .modal-btn.cancel:hover {
            background: var(--bg-secondary);
            border-color: var(--border-dark);
        }

        .modal-btn.save {
            background: var(--accent-color);
            color: white;
        }

        .modal-btn.save:hover {
            background: var(--accent-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .modal-btn:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        .modal-btn:active {
            transform: translateY(0);
        }

        @media (max-width: 480px) {
            .modal-footer {
                gap: var(--spacing-xs);
            }

            .modal-btn {
                flex: 1;
                min-width: 100px;
                padding: var(--spacing-sm) var(--spacing-md);
            }
        }
        
        /* ë…¸íŠ¸ ì„¹ì…˜ */
        .notes-section {
            margin-top: var(--spacing-lg);
        }

        .notes-input {
            width: 100%;
            min-height: 120px;
            padding: var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            resize: vertical;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--bg-primary);
            color: var(--text-primary);
            box-sizing: border-box;
            line-height: var(--line-height-relaxed);
        }

        .notes-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
            transform: translateY(-1px);
        }

        .notes-input:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        .notes-input::placeholder {
            color: var(--text-tertiary);
        }

        .notes-toolbar {
            margin-top: var(--spacing-sm);
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
        }
        
        .notes-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .notes-btn:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .today-plan {
                grid-column: span 1;
            }
            
            .timer-display {
                font-size: 2.5rem;
            }
            
            .weekly-stats {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .time-blocks {
                grid-template-columns: 1fr;
            }
        }
        
        /* í† ìŠ¤íŠ¸ ì•Œë¦¼ - Enhanced */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary-dark);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 2000;
            animation: slideInToast 0.3s ease;
            min-width: 300px;
            max-width: 500px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toast.success {
            background: var(--success);
        }

        .toast.error {
            background: var(--danger);
        }

        .toast.warning {
            background: var(--warning);
        }

        .toast.info {
            background: var(--accent);
        }

        .toast-icon {
            font-size: 1.2rem;
        }

        .toast-message {
            flex: 1;
        }

        @keyframes slideInToast {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutToast {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* D-Day ì¹´ë“œ ìŠ¤íƒ€ì¼ - Enhanced */
        .dday-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .dday-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: var(--spacing-lg);
            text-align: center;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .dday-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .dday-card:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 3px;
        }

        .dday-card.urgent {
            background: linear-gradient(135deg, #F56565 0%, #FC8181 100%);
            color: white;
        }

        .dday-card.warning {
            background: linear-gradient(135deg, #F6AD55 0%, #FBD38D 100%);
            color: white;
        }

        .dday-card.normal {
            background: linear-gradient(135deg, #48BB78 0%, #68D391 100%);
            color: white;
        }

        .dday-label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .dday-value {
            font-size: var(--font-size-5xl);
            font-weight: 800;
            margin: var(--spacing-md) 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.15);
            letter-spacing: -1px;
        }

        .dday-date {
            font-size: 0.85rem;
            opacity: 0.85;
            margin-top: 8px;
        }

        .dday-edit-btn {
            margin-top: 10px;
            padding: 6px 12px;
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 6px;
            color: inherit;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85rem;
        }

        .dday-edit-btn:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }

        /* Import/Export Buttons */
        .data-management {
            display: flex;
            gap: var(--spacing-md);
            flex-wrap: wrap;
            margin-top: var(--spacing-lg);
        }

        .btn-primary {
            padding: 12px 24px;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: var(--font-size-base);
            cursor: pointer;
            transition: all var(--transition-base);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            min-height: 44px;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            background: var(--accent-dark);
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            padding: 12px 24px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: var(--font-size-base);
            cursor: pointer;
            transition: all var(--transition-base);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            min-height: 44px;
        }

        .btn-secondary:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent-color);
            color: var(--accent-color);
            transform: translateY(-2px);
        }

        .btn-icon {
            font-size: var(--font-size-lg);
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }


        /* í™•ì¸ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .confirm-modal .modal-content {
            max-width: 400px;
        }

        .confirm-message {
            padding: 20px 0;
            font-size: 1.1rem;
            text-align: center;
            color: var(--text-primary);
        }

        /* ìŠ¤íŠ¸ë¦­ íŠ¸ë˜ì»¤ ìŠ¤íƒ€ì¼ */
        .streak-display {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #FF6B6B 0%, #FFD93D 100%);
            border-radius: 12px;
            color: white;
            margin-bottom: 15px;
        }

        .streak-number {
            font-size: 4.5rem;
            font-weight: 800;
            margin: 20px 0;
            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E72 50%, #FFA07A 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.03em;
            line-height: 1;
            position: relative;
            animation: streakPulse 2s ease-in-out infinite;
        }

        @keyframes streakPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .streak-number.milestone {
            animation: streakGlow 1.5s ease-in-out infinite;
            filter: drop-shadow(0 0 15px rgba(255, 107, 107, 0.6));
        }

        @keyframes streakGlow {
            0%, 100% {
                filter: drop-shadow(0 0 15px rgba(255, 107, 107, 0.6));
            }
            50% {
                filter: drop-shadow(0 0 25px rgba(255, 107, 107, 0.9));
            }
        }

        .streak-label {
            font-size: 1.2rem;
            opacity: 0.9;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .streak-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.3);
        }

        .streak-stat-item {
            text-align: center;
            padding: 20px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-color);
            transition: all var(--transition-base) var(--ease-apple);
            cursor: default;
        }

        .streak-stat-item:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent-color);
        }

        .streak-stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-color), var(--info-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .streak-stat-label {
            font-size: 0.9rem;
            opacity: 0.85;
            font-weight: 500;
            color: var(--text-secondary);
        }

        /* ë¶„ì„ ëŒ€ì‹œë³´ë“œ ìŠ¤íƒ€ì¼ - Enhanced Professional Design */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .analytics-stat {
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            padding: 24px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-md);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .analytics-stat::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, var(--accent-color) 0%, var(--accent-light) 100%);
        }

        .analytics-stat:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent-light);
        }

        .analytics-label {
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .analytics-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-color) 0%, var(--info-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 8px 0 16px 0;
            line-height: 1.2;
        }

        .analytics-benchmark {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
            text-align: left;
        }

        .benchmark-label {
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-tertiary);
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .benchmark-percentage {
            font-weight: 600;
            color: var(--accent-color);
            font-size: 0.8rem;
        }

        .benchmark-bar {
            height: 12px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .benchmark-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color) 0%, var(--success-color) 100%);
            border-radius: 6px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .benchmark-fill.excellent {
            background: linear-gradient(90deg, #10B981 0%, #34D399 100%);
        }

        .benchmark-fill.good {
            background: linear-gradient(90deg, var(--accent-color) 0%, var(--accent-light) 100%);
        }

        .benchmark-fill.needs-improvement {
            background: linear-gradient(90deg, #F59E0B 0%, #FBBF24 100%);
        }

        .benchmark-fill.poor {
            background: linear-gradient(90deg, #EF4444 0%, #F87171 100%);
        }

        .benchmark-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* ì°¨íŠ¸ ìŠ¤íƒ€ì¼ */
        .chart-container {
            background: var(--bg-light);
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .bar-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 200px;
            padding: 10px;
        }

        .bar-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 8px;
            min-height: 280px;
        }

        .bar {
            width: 100%;
            min-height: 40px;
            background: linear-gradient(to top, var(--accent), var(--success));
            border-radius: 4px 4px 0 0;
            transition: all 0.3s;
            position: relative;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .bar:hover {
            opacity: 0.9;
            transform: scaleY(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .bar-label {
            margin-top: 12px;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-primary);
            text-align: center;
            word-break: break-word;
            max-width: 100%;
        }

        .bar-value {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--accent);
        }

        /* ëª©í‘œ ì„¤ì • ìŠ¤íƒ€ì¼ */
        .goal-item {
            background: var(--bg-light);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid var(--warning);
            transition: all 0.3s;
        }

        .goal-item.achieved {
            border-left-color: var(--success);
            background: var(--success-light);
        }

        [data-theme="dark"] .goal-item.achieved {
            background: rgba(72, 187, 120, 0.15);
        }

        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .goal-title {
            font-weight: 600;
            flex: 1;
        }

        .goal-date {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-right: 10px;
        }

        .goal-progress-bar {
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }

        .goal-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--warning), var(--success));
            transition: width 0.5s ease;
        }

        .goal-actions {
            display: flex;
            gap: 5px;
        }

        .goal-btn {
            width: 24px;
            height: 24px;
            border: none;
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
        }

        .goal-btn:hover {
            background: var(--accent-color);
            color: white;
        }

        /* ì•½ì  ê³¼ëª© ìŠ¤íƒ€ì¼ */
        .weak-subject {
            background: #FFF5F5;
            border: 2px solid var(--danger);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .weak-subject-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .weak-subject-name {
            font-weight: 600;
            color: var(--danger);
            font-size: 1.1rem;
        }

        .priority-badge {
            background: var(--danger);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .weak-subject-info {
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        .recommendation {
            background: var(--bg-secondary);
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 0.85rem;
            border-left: 3px solid var(--warning-color);
        }

        /* ì¶”ì²œ ì‚¬í•­ ìŠ¤íƒ€ì¼ */
        .recommendation-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
        }

        .recommendation-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .recommendation-list {
            list-style: none;
            padding: 0;
        }

        .recommendation-list li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            line-height: 1.5;
        }

        .recommendation-list li:before {
            content: 'â†’';
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        /* ì ‘ì„ ìˆ˜ ìˆëŠ” ì„¹ì…˜ */
        .collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .collapse-icon {
            transition: transform 0.3s;
            font-size: 1.2rem;
        }

        .collapse-icon.collapsed {
            transform: rotate(-90deg);
        }

        .collapsible-content {
            max-height: 2000px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .collapsible-content.collapsed {
            max-height: 0;
        }

        /* ë°ì´í„° ê´€ë¦¬ ì„¹ì…˜ */
        .data-management-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-top: var(--spacing-lg);
        }

        .data-management-card .card-title {
            color: white;
        }

        .data-management-section {
            padding: var(--spacing-md) 0;
        }

        .data-management-desc {
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: var(--spacing-lg);
            font-size: var(--font-size-base);
            line-height: var(--line-height-relaxed);
        }

        .data-management-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .data-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-md) var(--spacing-lg);
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-lg);
            color: white;
            font-size: var(--font-size-base);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-base);
            min-height: 56px;
        }

        .data-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .data-btn:active {
            transform: translateY(0);
        }

        .data-btn .btn-icon {
            font-size: 1.5rem;
        }

        .data-btn .btn-text {
            font-size: var(--font-size-lg);
        }

        .export-btn:hover {
            background: rgba(72, 187, 120, 0.3);
            border-color: var(--success-light);
        }

        .import-btn:hover {
            background: rgba(66, 153, 225, 0.3);
            border-color: var(--info-color);
        }

        .data-management-info {
            padding: var(--spacing-md);
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--radius-md);
            color: rgba(255, 255, 255, 0.9);
            line-height: var(--line-height-relaxed);
        }

        .data-management-info small {
            font-size: var(--font-size-sm);
            line-height: 1.8;
        }

        /* Import Preview Modal */
        .import-preview {
            margin-top: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            max-height: 300px;
            overflow-y: auto;
        }

        .import-preview-item {
            display: flex;
            justify-content: space-between;
            padding: var(--spacing-sm) 0;
            border-bottom: 1px solid var(--border-color);
        }

        .import-preview-item:last-child {
            border-bottom: none;
        }

        .import-preview-label {
            font-weight: 600;
            color: var(--text-secondary);
        }

        .import-preview-value {
            color: var(--text-primary);
            font-weight: 500;
        }

        /* Loading state */
        .btn-loading {
            position: relative;
            pointer-events: none;
            opacity: 0.7;
        }

        .btn-loading::after {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            top: 50%;
            left: 50%;
            margin: -8px 0 0 -8px;
            border: 2px solid white;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spinner 0.6s linear infinite;
        }

        @keyframes spinner {
            to { transform: rotate(360deg); }
        }

        /* Mobile optimizations for data management */
        @media (max-width: 600px) {
            .data-management-actions {
                grid-template-columns: 1fr;
            }

            .data-btn {
                min-height: 60px;
                font-size: var(--font-size-lg);
            }
        }

        /* Empty States */
        .empty-state {
            text-align: center;
            padding: var(--spacing-xl) var(--spacing-md);
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: var(--spacing-md);
            opacity: 0.6;
        }

        .empty-state-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .empty-state-description {
            font-size: var(--font-size-sm);
            margin-bottom: var(--spacing-lg);
            line-height: var(--line-height-relaxed);
        }

        .empty-state-action {
            display: inline-block;
            padding: var(--spacing-sm) var(--spacing-lg);
            background: var(--accent-color);
            color: white;
            border-radius: var(--radius-md);
            text-decoration: none;
            font-weight: 600;
            transition: all var(--transition-base);
            cursor: pointer;
            border: none;
        }

        .empty-state-action:hover {
            background: var(--accent-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* Enhanced Button Consistency */
        /* Apple-style Button System */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-lg);
            border: none;
            border-radius: var(--radius-full);
            font-family: var(--font-primary);
            font-weight: var(--font-medium);
            font-size: var(--font-size-base);
            cursor: pointer;
            transition: all var(--transition-base) var(--ease-apple);
            min-height: 44px;
            letter-spacing: -0.005em;
            -webkit-font-smoothing: antialiased;
        }

        .btn-primary {
            background: var(--accent-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-2px) scale(1.02);
            box-shadow: var(--shadow-lg);
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-secondary);
            border-color: var(--border-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: var(--success-light);
            transform: translateY(-2px) scale(1.02);
            box-shadow: var(--shadow-md);
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: var(--danger-light);
            transform: translateY(-2px) scale(1.02);
            box-shadow: var(--shadow-md);
        }

        .btn-sm {
            padding: var(--spacing-xs) var(--spacing-sm);
            font-size: var(--font-size-sm);
            min-height: 36px;
        }

        .btn-lg {
            padding: var(--spacing-md) var(--spacing-xl);
            font-size: var(--font-size-lg);
            min-height: 56px;
        }

        /* Focus states for accessibility */
        .btn:focus-visible,
        .data-btn:focus-visible,
        .action-btn:focus-visible,
        .modal-btn:focus-visible {
            outline: 3px solid var(--accent-light);
            outline-offset: 2px;
        }

        /* Improved Card Shadows */
        .card {
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-base);
        }

        .card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        /* Loading Spinner for Better Feedback */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spinner 0.6s linear infinite;
        }

        /* Tablet devices (769px to 1024px) */
        @media (min-width: 769px) and (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .container {
                max-width: 100%;
                padding: var(--spacing-lg);
            }

            .card {
                padding: var(--spacing-md);
            }

            .time-blocks {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--spacing-sm);
            }

            .analytics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Enhanced Mobile Responsiveness (768px and below) */
        @media (max-width: 768px) {
            .modal-content {
                max-width: 95%;
                margin: 20px auto;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: var(--spacing-sm);
            }

            .header-top {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-sm);
            }

            .title {
                font-size: var(--font-size-xl);
            }

            .card-title {
                font-size: var(--font-size-base);
            }

            .card {
                padding: var(--spacing-md);
                margin-bottom: var(--spacing-sm);
            }

            .time-blocks {
                grid-template-columns: 1fr;
                gap: var(--spacing-sm);
            }

            .analytics-grid {
                grid-template-columns: 1fr;
                gap: var(--spacing-sm);
            }

            .weekly-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--spacing-xs);
            }

            .dday-container {
                gap: var(--spacing-sm);
            }

            /* Larger touch targets on mobile */
            .action-btn,
            .rotation-circle,
            .check-btn {
                min-width: 44px;
                min-height: 44px;
            }

            .data-management-actions {
                grid-template-columns: 1fr;
                gap: var(--spacing-sm);
            }

            .data-btn {
                padding: var(--spacing-sm) var(--spacing-md);
                min-height: 48px;
                font-size: var(--font-size-sm);
            }

            .data-btn .btn-text {
                font-size: var(--font-size-base);
            }
        }

        /* Extra small mobile devices (480px and below) */
        @media (max-width: 480px) {
            .container {
                padding: var(--spacing-sm);
                max-width: 100%;
            }

            .header {
                padding: var(--spacing-md);
                margin-bottom: var(--spacing-md);
                border-radius: var(--radius-lg);
            }

            .header-top {
                gap: var(--spacing-xs);
                margin-bottom: var(--spacing-sm);
            }

            .title {
                font-size: var(--font-size-lg);
                line-height: var(--line-height-tight);
            }

            .dday-container {
                grid-template-columns: 1fr;
                gap: var(--spacing-xs);
                margin-bottom: var(--spacing-md);
            }

            .dday-card {
                padding: var(--spacing-md);
                min-height: auto;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: var(--spacing-xs);
                margin-bottom: var(--spacing-md);
            }

            .card {
                padding: var(--spacing-sm);
                margin-bottom: var(--spacing-xs);
                border-radius: var(--radius-lg);
            }

            .card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-xs);
            }

            .card-title {
                font-size: var(--font-size-base);
                line-height: var(--line-height-tight);
            }

            .card-actions {
                gap: var(--spacing-xs);
                width: 100%;
                justify-content: flex-end;
            }

            .timer-display {
                font-size: 3.5rem;
                margin: 20px 0;
                padding: 15px 0;
            }

            .streak-number {
                font-size: 3rem;
            }

            .streak-stat-value {
                font-size: 1.8rem;
            }

            .analytics-grid {
                grid-template-columns: 1fr;
                gap: var(--spacing-xs);
            }

            .analytics-stat {
                padding: var(--spacing-sm);
            }

            .weekly-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--spacing-xs);
            }

            .time-blocks {
                grid-template-columns: 1fr;
                gap: var(--spacing-xs);
            }

            .time-block {
                padding: var(--spacing-sm);
                min-height: auto;
            }

            .modal-content {
                max-width: 95%;
                margin: 30% auto;
                padding: var(--spacing-md);
                max-height: 80vh;
                overflow-y: auto;
            }

            .modal-header {
                margin-bottom: var(--spacing-sm);
            }

            .modal-title {
                font-size: var(--font-size-lg);
            }

            .data-management-actions {
                grid-template-columns: 1fr;
                gap: var(--spacing-xs);
            }

            .data-btn {
                padding: var(--spacing-xs) var(--spacing-sm);
                min-height: 44px;
                font-size: var(--font-size-xs);
                flex-wrap: wrap;
            }

            .data-btn .btn-icon {
                font-size: 1.2rem;
            }

            .data-btn .btn-text {
                font-size: var(--font-size-xs);
            }

            .data-management-desc {
                font-size: var(--font-size-sm);
            }

            .data-management-info {
                padding: var(--spacing-sm);
                font-size: var(--font-size-xs);
            }
        }

        /* Smooth Transitions for Better UX */
        * {
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Respect user's motion preferences */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Better Visual Hierarchy */
        h1, h2, h3, h4 {
            line-height: var(--line-height-tight);
            font-weight: 700;
        }

        p {
            line-height: var(--line-height-relaxed);
        }

        /* Empty State Styles */
        .empty-state {
            text-align: center;
            padding: var(--spacing-2xl) var(--spacing-lg);
            color: var(--text-secondary);
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            margin: var(--spacing-lg) 0;
            border: 2px dashed var(--border-color);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: var(--spacing-md);
            opacity: 0.8;
        }

        .empty-state-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .empty-state-description {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
            margin-bottom: var(--spacing-md);
            line-height: var(--line-height-relaxed);
        }

        .empty-state-action {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: var(--font-size-sm);
            font-weight: 600;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
        }

        .empty-state-action:hover {
            background: var(--accent-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .empty-state-action:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        /* ============================================
           DATA VISUALIZATION DASHBOARD - v2.13.0
           Apple-inspired Chart.js integration
           ============================================ */

        /* Data Visualization Container */
        .data-viz-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }

        /* Sync Status Dashboard */
        .sync-status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .sync-status-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
            transition: all var(--transition);
        }

        .sync-status-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .sync-status-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xs);
        }

        .sync-status-icon {
            font-size: var(--text-2xl);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-md);
            background: var(--bg-secondary);
        }

        .sync-status-icon.success {
            background: rgba(52, 199, 89, 0.1);
            color: #34c759;
        }

        .sync-status-icon.warning {
            background: rgba(255, 149, 0, 0.1);
            color: #ff9500;
        }

        .sync-status-icon.error {
            background: rgba(255, 59, 48, 0.1);
            color: #ff3b30;
        }

        .sync-status-title {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sync-status-value {
            font-size: var(--text-3xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            line-height: 1;
        }

        .sync-status-timestamp {
            font-size: var(--text-xs);
            color: var(--text-tertiary);
            margin-top: var(--spacing-xs);
        }

        /* Chart Container */
        .chart-wrapper {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-xl);
            padding: var(--spacing-xl);
            margin-bottom: var(--spacing-lg);
            transition: all var(--transition);
        }

        .chart-wrapper:hover {
            box-shadow: var(--shadow-lg);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
            gap: var(--spacing-sm);
        }

        .chart-title {
            font-size: var(--text-xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0;
        }

        .chart-actions {
            display: flex;
            gap: var(--spacing-xs);
        }

        .chart-btn {
            padding: var(--spacing-xs) var(--spacing-sm);
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition);
            font-family: inherit;
        }

        .chart-btn:hover {
            background: var(--accent-light);
            color: white;
            border-color: var(--accent-light);
            transform: translateY(-1px);
        }

        .chart-btn.active {
            background: var(--accent-light);
            color: white;
            border-color: var(--accent-light);
        }

        .chart-canvas-container {
            position: relative;
            width: 100%;
            height: 400px;
            margin-bottom: var(--spacing-md);
        }

        .chart-canvas-container.small {
            height: 300px;
        }

        .chart-canvas-container canvas {
            max-width: 100%;
            height: auto !important;
        }

        /* Progress Bars Visualization */
        .progress-bars-container {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .progress-bar-item {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .progress-bar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xs);
        }

        .progress-bar-label {
            font-size: var(--text-base);
            font-weight: var(--font-medium);
            color: var(--text-primary);
        }

        .progress-bar-value {
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            color: var(--text-secondary);
        }

        .progress-bar-track {
            width: 100%;
            height: 12px;
            background: var(--bg-secondary);
            border-radius: 9999px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar-fill {
            height: 100%;
            border-radius: 9999px;
            transition: width 1s cubic-bezier(0.28, 0.11, 0.32, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.3),
                transparent
            );
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-bar-fill.low {
            background: linear-gradient(90deg, #ff3b30, #ff6b5e);
        }

        .progress-bar-fill.medium {
            background: linear-gradient(90deg, #ff9500, #ffb340);
        }

        .progress-bar-fill.high {
            background: linear-gradient(90deg, #34c759, #5dd97c);
        }

        /* Chart Empty State */
        .chart-empty-state {
            text-align: center;
            padding: var(--spacing-2xl);
            color: var(--text-tertiary);
        }

        .chart-empty-icon {
            font-size: 64px;
            margin-bottom: var(--spacing-md);
            opacity: 0.3;
        }

        .chart-empty-text {
            font-size: var(--text-base);
            margin-bottom: var(--spacing-sm);
        }

        .chart-empty-subtext {
            font-size: var(--text-sm);
            color: var(--text-tertiary);
        }

        /* Date Range Selector */
        .date-range-selector {
            display: flex;
            gap: var(--spacing-xs);
            flex-wrap: wrap;
        }

        /* Responsive Design for Charts */
        @media (max-width: 768px) {
            .chart-canvas-container {
                height: 300px;
            }

            .chart-canvas-container.small {
                height: 250px;
            }

            .sync-status-grid {
                grid-template-columns: 1fr;
            }

            .chart-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .chart-actions {
                width: 100%;
                justify-content: flex-start;
            }
        }

        @media (max-width: 480px) {
            .chart-wrapper {
                padding: var(--spacing-md);
            }

            .chart-canvas-container {
                height: 250px;
            }

            .chart-title {
                font-size: var(--text-lg);
            }
        }

        /* Dark mode specific chart styles - Enhanced */
        body.dark-mode .chart-wrapper,
        body.dark-mode .sync-status-card {
            background: #141414;
            border-color: rgba(255, 255, 255, 0.18);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7), 0 0 12px rgba(255, 255, 255, 0.03);
        }

        body.dark-mode .chart-btn {
            background: #1f1f1f;
            border-color: rgba(255, 255, 255, 0.18);
            color: #e0e0e0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        body.dark-mode .chart-btn:hover {
            background: #262626;
            border-color: var(--accent-color);
            color: #3da1ff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6), 0 0 8px rgba(61, 161, 255, 0.3);
        }

        body.dark-mode .chart-btn.active {
            background: linear-gradient(135deg, #3da1ff, #2080dd);
            border-color: transparent;
            color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7), 0 0 16px rgba(61, 161, 255, 0.4);
        }

        /* Dark mode: Exam type buttons (1ì°¨/2ì°¨) - Enhanced Clarity */
        body.dark-mode .mode-btn,
        [data-theme="dark"] .mode-btn {
            color: #e0e0e0;
            background: #1f1f1f;
            border: 2px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        body.dark-mode .mode-btn:hover,
        [data-theme="dark"] .mode-btn:hover {
            color: #3da1ff;
            background: rgba(61, 161, 255, 0.15);
            border-color: var(--accent-color);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6), 0 0 12px rgba(61, 161, 255, 0.3);
            transform: translateY(-1px);
        }

        body.dark-mode .mode-btn.active,
        [data-theme="dark"] .mode-btn.active {
            background: linear-gradient(135deg, #3da1ff, #5cb3ff);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7), 0 0 16px rgba(61, 161, 255, 0.5);
            font-weight: 600;
        }

        body.dark-mode .progress-bar-track {
            background: #1f1f1f;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        /* Dark mode: D-Day Cards - Enhanced */
        body.dark-mode .dday-card,
        [data-theme="dark"] .dday-card {
            background: #141414;
            border-color: rgba(255, 255, 255, 0.18);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7), 0 0 12px rgba(255, 255, 255, 0.03);
        }

        body.dark-mode .dday-card:hover,
        [data-theme="dark"] .dday-card:hover {
            background: #1a1a1a;
            border-color: rgba(255, 255, 255, 0.25);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.8), 0 0 16px rgba(255, 255, 255, 0.05);
        }

        body.dark-mode .dday-label,
        [data-theme="dark"] .dday-label {
            color: #e0e0e0;
        }

        body.dark-mode .dday-value,
        [data-theme="dark"] .dday-value {
            color: #f5f5f5;
        }

        body.dark-mode .dday-date,
        [data-theme="dark"] .dday-date {
            color: #b0b0b0;
        }

        /* Dark mode: Sync Badge - Enhanced */
        body.dark-mode .sync-badge,
        [data-theme="dark"] .sync-badge {
            background: #1f1f1f;
            border-color: rgba(255, 255, 255, 0.18);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7), 0 0 12px rgba(255, 255, 255, 0.04);
        }

        body.dark-mode .sync-badge.syncing,
        [data-theme="dark"] .sync-badge.syncing {
            background: rgba(61, 161, 255, 0.15);
            border-color: var(--accent-color);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7), 0 0 16px rgba(61, 161, 255, 0.4);
        }

        body.dark-mode .sync-badge-text,
        [data-theme="dark"] .sync-badge-text {
            color: #f5f5f5;
        }

        /* Dark mode: Dashboard Tabs - Enhanced */
        body.dark-mode .dashboard-tabs,
        [data-theme="dark"] .dashboard-tabs {
            border-bottom-color: rgba(255, 255, 255, 0.18);
        }

        body.dark-mode .tab-btn,
        [data-theme="dark"] .tab-btn {
            color: #e0e0e0;
        }

        body.dark-mode .tab-btn:hover,
        [data-theme="dark"] .tab-btn:hover {
            color: #f5f5f5;
            border-bottom-color: var(--accent-light);
        }

        body.dark-mode .tab-btn.active,
        [data-theme="dark"] .tab-btn.active {
            color: var(--accent-color);
            border-bottom-color: var(--accent-color);
        }

        /* Loading Animation for Charts */
        .chart-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 400px;
            color: var(--text-tertiary);
        }

        .chart-loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--bg-secondary);
            border-top-color: var(--accent-light);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== v3.0.0 SYNC BADGE (ê³ ì • ìœ„ì¹˜ ë™ê¸°í™” í‘œì‹œ) ===== */
        .sync-badge {
            position: fixed;
            bottom: 24px;
            right: 24px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-full);
            box-shadow: var(--shadow-md);
            font-size: 12px;
            color: var(--text-secondary);
            z-index: 1000;
            transition: all 0.3s ease;
            animation: slideIn 0.3s ease-out;
        }

        .sync-badge.syncing {
            background: var(--bg-tertiary);
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        .sync-badge.saving {
            background: var(--accent-light);
            color: #ffffff;
        }

        .sync-badge-icon {
            display: inline-block;
            font-size: 14px;
            animation: sync-pulse 2s infinite;
        }

        .sync-badge.syncing .sync-badge-icon {
            animation: sync-spin 1s linear infinite;
        }

        .sync-badge-text {
            font-weight: 500;
            color: var(--text-primary);
        }

        .sync-badge.syncing .sync-badge-text {
            color: var(--accent-color);
        }

        .sync-badge-time {
            font-size: 11px;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translate(200px, 0);
            }
            to {
                opacity: 1;
                transform: translate(0, 0);
            }
        }

        @keyframes sync-pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.1); }
        }

        @keyframes sync-spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ëª¨ë°”ì¼ì—ì„œ ë™ê¸°í™” í‘œì‹œ ìœ„ì¹˜ ì¡°ì • */
        @media (max-width: 768px) {
            .sync-badge {
                bottom: 16px;
                right: 16px;
                padding: 6px 10px;
                font-size: 11px;
            }

            .sync-badge-icon {
                font-size: 12px;
            }
        }

        /* ===== v3.0.0 STICKY PROGRESS BAR ===== */
        .sticky-progress-bar {
            position: sticky;
            top: 0;
            z-index: 99;
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            padding: var(--spacing-md) 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--spacing-sm);
            padding: var(--spacing-md) var(--spacing-lg);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .sticky-progress-bar {
            backdrop-filter: blur(24px);
            background: rgba(10, 10, 10, 0.9);
            border-bottom: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.8);
        }

        [data-theme="dark"] .progress-metric {
            background: #1f1f1f;
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        [data-theme="dark"] .progress-metric:hover {
            background: #262626;
            border-color: var(--accent-color);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7), 0 0 12px rgba(61, 161, 255, 0.3);
        }

        [data-theme="dark"] .metric-label {
            color: #b0b0b0;
        }

        [data-theme="dark"] .metric-value {
            color: #f5f5f5;
        }

        .progress-metric {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }

        .progress-metric:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .metric-icon {
            font-size: 20px;
            display: inline-block;
        }

        .metric-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .metric-label {
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            .sticky-progress-bar {
                grid-template-columns: repeat(2, 1fr);
                padding: var(--spacing-sm) var(--spacing-md);
                gap: var(--spacing-xs);
            }

            .progress-metric {
                padding: var(--spacing-xs) var(--spacing-sm);
                gap: var(--spacing-xs);
            }

            .metric-icon {
                font-size: 16px;
            }

            .metric-value {
                font-size: 14px;
            }

            .metric-label {
                font-size: 10px;
            }
        }

        /* ===== v3.0.0 DASHBOARD TAB NAVIGATION ===== */
        .dashboard-tabs {
            display: flex;
            gap: var(--spacing-sm);
            padding: var(--spacing-lg) 0;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: var(--spacing-xl);
            overflow-x: auto;
            scroll-behavior: smooth;
        }

        .dashboard-tabs::-webkit-scrollbar {
            height: 4px;
        }

        .dashboard-tabs::-webkit-scrollbar-track {
            background: transparent;
        }

        .dashboard-tabs::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        .tab-btn {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-sm) var(--spacing-md);
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            border-bottom-color: var(--accent-light);
        }

        .tab-btn.active {
            color: var(--accent-color);
            border-bottom-color: var(--accent-color);
        }

        .tab-icon {
            font-size: 18px;
        }

        .tab-label {
            display: inline;
        }

        @media (max-width: 768px) {
            .dashboard-tabs {
                padding: var(--spacing-md) 0;
                margin-bottom: var(--spacing-lg);
            }

            .tab-btn {
                padding: var(--spacing-xs) var(--spacing-sm);
                font-size: 13px;
            }

            .tab-icon {
                font-size: 16px;
            }
        }

        /* TAB CONTENT - ì²˜ìŒì—ëŠ” ëª¨ë‘ ìˆ¨ê¹€ */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

    </style>
</head>
<body>

    <!-- Dark Mode Toggle -->
    <button class="theme-toggle" onclick="toggleDarkMode()" title="Toggle Dark Mode">
        <span id="theme-icon">ğŸŒ™</span>
    </button>

    <div class="container">
        <!-- í—¤ë” -->
        <div class="header">
            <div class="header-top">
                <h1 class="title">ğŸ¯ ì‹œí—˜ ì „ëµì  í•™ìŠµ ì‹œìŠ¤í…œ v3.6.0</h1>
            </div>

            <!-- D-Day ì¹´ìš´í„° (1ì°¨/2ì°¨) -->
            <div class="dday-container">
                <div class="dday-card" id="dday-1st-card" onclick="editExamDate('1ì°¨')">
                    <div class="dday-label">ğŸ“š 1ì°¨ ì‹œí—˜</div>
                    <div class="dday-value" id="dday-1st-value">D-?</div>
                    <div class="dday-date" id="dday-1st-date">ë‚ ì§œ ë¯¸ì„¤ì •</div>
                    <button class="dday-edit-btn" onclick="event.stopPropagation(); editExamDate('1ì°¨')">ë‚ ì§œ ì„¤ì •</button>
                </div>
                <div class="dday-card" id="dday-2nd-card" onclick="editExamDate('2ì°¨')">
                    <div class="dday-label">âœï¸ 2ì°¨ ì‹œí—˜</div>
                    <div class="dday-value" id="dday-2nd-value">D-?</div>
                    <div class="dday-date" id="dday-2nd-date">ë‚ ì§œ ë¯¸ì„¤ì •</div>
                    <button class="dday-edit-btn" onclick="event.stopPropagation(); editExamDate('2ì°¨')">ë‚ ì§œ ì„¤ì •</button>
                </div>
            </div>

            <div class="study-mode-selector">
                <button class="mode-btn" onclick="setExamType('1ì°¨')">1ì°¨ ì‹œí—˜</button>
                <button class="mode-btn" onclick="setExamType('2ì°¨')">2ì°¨ ì‹œí—˜</button>
            </div>
        </div>

        <!-- v3.0.0 STICKY PROGRESS BAR (í•­ìƒ ë³´ì´ëŠ” ì§„ë„ í‘œì‹œ) -->
        <div class="sticky-progress-bar" id="stickyProgressBar">
            <div class="progress-metric">
                <span class="metric-icon">ğŸ“Š</span>
                <div class="metric-info">
                    <span class="metric-label">ì „ì²´ ì§„ë„</span>
                    <span class="metric-value" id="stickyProgress">0%</span>
                </div>
            </div>

            <div class="progress-metric">
                <span class="metric-icon">ğŸ”¥</span>
                <div class="metric-info">
                    <span class="metric-label">ì—°ì† í•™ìŠµ</span>
                    <span class="metric-value" id="stickyStreak">0ì¼</span>
                </div>
            </div>

            <div class="progress-metric">
                <span class="metric-icon">âœ…</span>
                <div class="metric-info">
                    <span class="metric-label">ì˜¤ëŠ˜ ì™„ë£Œ</span>
                    <span class="metric-value" id="stickyCompleted">0/0</span>
                </div>
            </div>

            <div class="progress-metric">
                <span class="metric-icon">â±ï¸</span>
                <div class="metric-info">
                    <span class="metric-label">ì˜¤ëŠ˜ í•™ìŠµì‹œê°„</span>
                    <span class="metric-value" id="stickyHours">0h</span>
                </div>
            </div>
        </div>

        <!-- v3.0.0 DASHBOARD TAB NAVIGATION -->
        <!-- í•™ìŠµ ìŠ¤íŠ¸ë¦­ & ì¶”ì²œ (ìµœìƒë‹¨ ê°•ì¡°) -->
        <div class="dashboard-grid">
            <!-- í•™ìŠµ ìŠ¤íŠ¸ë¦­ íŠ¸ë˜ì»¤ -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">ğŸ”¥ í•™ìŠµ ìŠ¤íŠ¸ë¦­</h2>
                    <div class="card-actions">
                        <button class="action-btn" onclick="resetStreak()">ğŸ”„</button>
                    </div>
                </div>
                <div class="streak-display">
                    <div class="streak-label">í˜„ì¬ ì—°ì† í•™ìŠµì¼</div>
                    <div class="streak-number" id="current-streak">0</div>
                    <div class="streak-label">ì¼ ì—°ì† ğŸ”¥</div>

                    <!-- ìŠ¤íŠ¸ë¦­ ì§„í–‰ ë°” -->
                    <div style="width: 100%; height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; margin: 16px 0; overflow: hidden;">
                        <div id="streak-progress-bar" style="height: 100%; background: linear-gradient(90deg, #FF6B6B, #FF8E72); width: 0%; transition: width 0.3s ease;"></div>
                    </div>

                    <div class="streak-stats">
                        <div class="streak-stat-item">
                            <div class="streak-stat-value" id="longest-streak">0</div>
                            <div class="streak-stat-label">ìµœì¥ ê¸°ë¡</div>
                        </div>
                        <div class="streak-stat-item">
                            <div class="streak-stat-value" id="total-study-days">0</div>
                            <div class="streak-stat-label">ì´ í•™ìŠµì¼</div>
                        </div>
                    </div>

                    <!-- ì¶”ê°€ ì •ë³´ -->
                    <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(255,255,255,0.1);">
                        <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 8px;">
                            <span>ğŸ“… ë§ˆì§€ë§‰ í•™ìŠµ: <span id="last-study-date">-</span></span>
                        </div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">
                            <span id="streak-status" style="display: inline-block; padding: 4px 12px; border-radius: 20px; background: rgba(255, 107, 107, 0.2); color: #FF6B6B;">ğŸ“Š ì§„í–‰ ì¤‘</span>
                        </div>
                    </div>
                </div>
            </div>

        <!-- í•™ìŠµ ë¶„ì„ ëŒ€ì‹œë³´ë“œ v3.0.7 - Enhanced with Core Metrics -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">ğŸ“Š í•™ìŠµ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h2>
            </div>


        <!-- ëŒ€ì‹œë³´ë“œ ê·¸ë¦¬ë“œ -->
        <div class="dashboard-grid">
            <!-- ì˜¤ëŠ˜ì˜ í•™ìŠµ ê³„íš -->
            <div class="card today-plan">
                <div class="card-header">
                    <h2 class="card-title">ğŸ“š ì˜¤ëŠ˜ì˜ í•™ìŠµ ì „ëµ</h2>
                    <div class="card-actions">
                        <button class="action-btn" onclick="addTimeBlock()" aria-label="í•™ìŠµ ì‹œê°„ ë¸”ë¡ ì¶”ê°€">â•</button>
                    </div>
                </div>
                <div class="time-blocks" id="time-blocks-container">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
                <div style="background: #FFF5F5; padding: 15px; border-radius: 8px; border-left: 4px solid var(--danger); margin-top: 15px;">
                    <div style="font-weight: 600; margin-bottom: 10px; color: var(--danger);">ğŸ’¡ í•©ê²©ì í‰ê·  (ì§ì¥ë³‘í–‰ ê¸°ì¤€)</div>
                    <div style="font-size: 0.9rem; line-height: 1.6;">
                        â€¢ ì¼ì¼ í•™ìŠµì‹œê°„: í‰ì¼ 4-5ì‹œê°„<br>
                        â€¢ ê¸°ì¶œë¬¸ì œ íšŒë…: ê³¼ëª©ë‹¹ 6-7íšŒ<br>
                        â€¢ 1ì°¨ ì¤€ë¹„ê¸°ê°„: 12-18ê°œì›”
                    </div>
                </div>
            </div>
            
            <!-- ê¸°ì¶œë¬¸ì œ íšŒë… íŠ¸ë˜ì»¤ -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">ğŸ”„ ê¸°ì¶œë¬¸ì œ íšŒë… í˜„í™©</h2>
                    <div class="card-actions">
                        <button class="action-btn" onclick="resetRotations()">ğŸ”„</button>
                    </div>
                </div>
                <div class="rotation-tracker" id="rotation-tracker">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>
            
            <!-- í†µí•© í•™ìŠµ íƒ€ì´ë¨¸ -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">â±ï¸ ì˜¤ëŠ˜ì˜ í•™ìŠµ ì‹œê°„ & í¬ëª¨ë„ë¡œ</h2>
                </div>
                <div class="card-body" style="display: grid; grid-template-columns: 1fr; gap: 20px; padding: 20px;">
                    <!-- ì˜¤ëŠ˜ì˜ í•™ìŠµ ì‹œê°„ ì„¹ì…˜ -->
                    <div style="border-bottom: 2px solid #e9ecef; padding-bottom: 20px;">
                        <h3 style="font-size: 1rem; font-weight: 600; color: #495057; margin-bottom: 15px;">â±ï¸ ì˜¤ëŠ˜ì˜ í•™ìŠµ ì‹œê°„</h3>
                        <div class="timer-display" id="timer">00:00:00</div>
                        <div class="timer-controls">
                            <button class="timer-btn start" onclick="startTimer()">ì‹œì‘</button>
                            <button class="timer-btn pause" onclick="pauseTimer()">ì¼ì‹œì •ì§€</button>
                            <button class="timer-btn reset" onclick="resetTimer()">ë¦¬ì…‹</button>
                        </div>
                        <div class="weekly-stats" id="weekly-stats">
                            <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>

                    <!-- í¬ëª¨ë„ë¡œ íƒ€ì´ë¨¸ ì„¹ì…˜ -->
                    <div>
                        <h3 style="font-size: 1rem; font-weight: 600; color: #495057; margin-bottom: 15px;">ğŸ… í¬ëª¨ë„ë¡œ íƒ€ì´ë¨¸</h3>
                        <div class="pomodoro-display">
                            <div class="pomodoro-mode" id="pomodoro-mode">ì‘ì—… ì„¸ì…˜</div>
                            <div class="timer-display" id="pomodoro-timer">25:00</div>
                            <div class="pomodoro-session-count">
                                ì™„ë£Œëœ ì„¸ì…˜: <span id="pomodoro-count">0</span>ê°œ
                            </div>
                        </div>
                        <div class="timer-controls">
                            <button class="timer-btn start" id="pomodoro-start" onclick="startPomodoro()">ì‹œì‘</button>
                            <button class="timer-btn pause" id="pomodoro-pause" onclick="pausePomodoro()" style="display:none;">ì¼ì‹œì •ì§€</button>
                            <button class="timer-btn reset" onclick="resetPomodoro()">ë¦¬ì…‹</button>
                            <button class="timer-btn" onclick="showPomodoroSettings()" style="background: #6c757d;">âš™ï¸ ì‹œê°„ ì„¤ì •</button>
                        </div>

                        <!-- ë¹ ë¥¸ ì‹œê°„ ì˜µì…˜ -->
                        <div class="pomodoro-quick-time">
                            <button onclick="setPomodoroQuickTime(15)" class="quick-time-btn">15ë¶„</button>
                            <button onclick="setPomodoroQuickTime(25)" class="quick-time-btn">25ë¶„</button>
                            <button onclick="setPomodoroQuickTime(45)" class="quick-time-btn">45ë¶„</button>
                            <button onclick="setPomodoroQuickTime(60)" class="quick-time-btn">1ì‹œê°„</button>
                            <button onclick="setPomodoroQuickTime(90)" class="quick-time-btn">90ë¶„</button>
                            <button onclick="setPomodoroQuickTime(120)" class="quick-time-btn">2ì‹œê°„</button>
                        </div>
                        <div class="quick-time-hint">
                            ğŸ’¡ ì‘ì—… ì‹œê°„ ë¹ ë¥¸ ì„ íƒ
                        </div>
                    </div>
                </div>
            </div>

            <!-- ê³¼ëª©ë³„ ì§„ë„ í˜„í™© -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">ğŸ“Š ê³¼ëª©ë³„ ì§„ë„ìœ¨</h2>
                    <div class="card-actions">
                        <button class="action-btn" onclick="updateAllProgress()" aria-label="ê³¼ëª©ë³„ ì§„ë„ ìˆ˜ì •">âœï¸</button>
                    </div>
                </div>
                <div class="subject-progress" id="subject-progress">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>
            
            <!-- ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ íŠ¸ë˜ì»¤ -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">ğŸ“ ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ ì¶”ì´</h2>
                    <div class="card-actions">
                        <button class="action-btn" onclick="showScoreModal()" aria-label="ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ ì¶”ê°€">â•</button>
                    </div>
                </div>
                <div class="mock-scores" id="mock-scores">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>
            
            <!-- ë™ê¸°ë¶€ì—¬ ì¹´ë“œ -->
            <div class="card">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; text-align: center;">
                    <div style="font-size: 1.1rem; font-style: italic; margin-bottom: 10px;" id="motivation-quote">
                        "í¬ê¸°í•˜ì§€ ì•Šìœ¼ë©´ ë°˜ë“œì‹œ í•©ê²©í•œë‹¤. ì‹œí—˜ì€ ëê¹Œì§€ ë²„í‹°ëŠ” ê²ƒì…ë‹ˆë‹¤."
                    </div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">- 29íšŒ í•©ê²©ì -</div>
                </div>
                <div style="background: #FFF5F5; padding: 15px; border-radius: 8px; border-left: 4px solid var(--danger); margin-top: 15px;">
                    <div style="font-weight: 600; margin-bottom: 10px; color: var(--danger);">ğŸ† í•©ê²©ì ì¡°ì–¸</div>
                    <div style="font-size: 0.9rem; line-height: 1.6;">
                        â€¢ ê¸°ì¶œë¬¸ì œ 6-7íšŒë…ì´ í•µì‹¬<br>
                        â€¢ ìµœì‹ íŒë¡€ëŠ” ë°˜ë“œì‹œ ì²´í¬<br>
                        â€¢ ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ì— ì—°ì—°í•˜ì§€ ë§ ê²ƒ<br>
                        â€¢ ë§¤ì¼ ê¾¸ì¤€íˆê°€ ë‹µì…ë‹ˆë‹¤
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ë°ì´í„° ê´€ë¦¬ ì„¹ì…˜ -->
        <div class="card data-management-card">
            <div class="card-header">
                <h2 class="card-title">ğŸ’¾ ë°ì´í„° ê´€ë¦¬</h2>
            </div>
            <div class="data-management-section">
                <p class="data-management-desc">í•™ìŠµ ë°ì´í„°ë¥¼ ì•ˆì „í•˜ê²Œ ë°±ì—…í•˜ê³  ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                <div class="data-management-actions">
                    <button class="data-btn export-btn" onclick="exportData()">
                        <span class="btn-icon">â¬‡ï¸</span>
                        <span class="btn-text">ë°ì´í„° ë‚´ë³´ë‚´ê¸°</span>
                    </button>
                    <button class="data-btn import-btn" onclick="document.getElementById('importFileInput').click()">
                        <span class="btn-icon">â¬†ï¸</span>
                        <span class="btn-text">ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</span>
                    </button>
                    <input type="file" id="importFileInput" accept=".json" style="display: none;" onchange="importData(event)">
                </div>
                <div class="data-management-info">
                    <small>ë‚´ë³´ë‚´ê¸°: ëª¨ë“  í•™ìŠµ ë°ì´í„°ë¥¼ JSON íŒŒì¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤</small><br>
                    <small>ê°€ì ¸ì˜¤ê¸°: ì´ì „ì— ì €ì¥í•œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤ (í˜„ì¬ ë°ì´í„°ëŠ” ëŒ€ì²´ë©ë‹ˆë‹¤)</small>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div style="text-align: center; padding: 20px; color: var(--text-secondary); font-size: 0.85rem;">
            ì‹œí—˜ ì „ëµì  í•™ìŠµ ì‹œìŠ¤í…œ v2.13.0 | Chart.js ë°ì´í„° ì‹œê°í™” ëŒ€ì‹œë³´ë“œ | Apple ë””ìì¸ ì‹œìŠ¤í…œ | ì‹¤ì‹œê°„ ë™ê¸°í™” ìƒíƒœ ëª¨ë‹ˆí„°ë§
        </div>
    </div>
    
    <!-- ëª¨ë‹¬ë“¤ -->
    <div id="scoreModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ ì¶”ê°€</h3>
                <button class="modal-close" aria-label="ë‹«ê¸°" onclick="closeModal('scoreModal')" aria-label="ë‹«ê¸°">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ì‹œí—˜ ë‚ ì§œ</label>
                    <input type="date" class="form-input" id="scoreDate">
                </div>
                <div class="form-group">
                    <label class="form-label">ì ìˆ˜</label>
                    <input type="number" step="0.5" class="form-input" id="scoreValue" placeholder="ì˜ˆ: 58.5">
                </div>
                <div class="form-group">
                    <label class="form-label">ë©”ëª¨ (ì„ íƒ)</label>
                    <input type="text" class="form-input" id="scoreMemo" placeholder="ì˜ˆ: 3ì°¨ ëª¨ì˜ê³ ì‚¬">
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('scoreModal')">ì·¨ì†Œ</button>
                <button class="modal-btn save" onclick="saveScore()">ì €ì¥</button>
            </div>
        </div>
    </div>
    
    <div id="timeBlockModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">í•™ìŠµ ì‹œê°„ ë¸”ë¡ ì¶”ê°€</h3>
                <button class="modal-close" aria-label="ë‹«ê¸°" onclick="closeModal('timeBlockModal')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ì‹œì‘ ì‹œê°„</label>
                    <input type="time" class="form-input" id="blockStartTime">
                </div>
                <div class="form-group">
                    <label class="form-label">ë ì‹œê°„</label>
                    <input type="time" class="form-input" id="blockEndTime">
                </div>
                <div class="form-group">
                    <label class="form-label">ê³¼ëª©</label>
                    <select class="form-select" id="blockSubject" required>
                        <option value="" disabled selected>ê³¼ëª©ì„ ì„ íƒí•˜ì„¸ìš”</option>
                        <optgroup label="1ì°¨ ì‹œí—˜">
                            <option value="í—Œë²•">í—Œë²•</option>
                            <option value="ë¯¼ë²•">ë¯¼ë²•</option>
                            <option value="ìƒë²•">ìƒë²•</option>
                            <option value="ë¯¼ì‚¬ì§‘í–‰ë²•">ë¯¼ì‚¬ì§‘í–‰ë²•</option>
                            <option value="ë¶€ë™ì‚°ë“±ê¸°ë²•">ë¶€ë™ì‚°ë“±ê¸°ë²•</option>
                            <option value="ìƒì—…ë“±ê¸°ë²•">ìƒì—…ë“±ê¸°ë²•</option>
                            <option value="ê³µíƒë²•">ê³µíƒë²•</option>
                        </optgroup>
                        <optgroup label="2ì°¨ ì‹œí—˜">
                            <option value="ë¯¼ë²• (2ì°¨)">ë¯¼ë²• (2ì°¨)</option>
                            <option value="í˜•ë²• (2ì°¨)">í˜•ë²• (2ì°¨)</option>
                            <option value="í˜•ì‚¬ì†Œì†¡ë²• (2ì°¨)">í˜•ì‚¬ì†Œì†¡ë²• (2ì°¨)</option>
                            <option value="ë¯¼ì‚¬ì†Œì†¡ë²• (2ì°¨)">ë¯¼ì‚¬ì†Œì†¡ë²• (2ì°¨)</option>
                            <option value="ë¯¼ì‚¬ì‚¬ê±´ì„œë¥˜ì‘ì„± (2ì°¨)">ë¯¼ì‚¬ì‚¬ê±´ì„œë¥˜ì‘ì„± (2ì°¨)</option>
                            <option value="ë¶€ë™ì‚°ë“±ê¸°ë²• (2ì°¨)">ë¶€ë™ì‚°ë“±ê¸°ë²• (2ì°¨)</option>
                            <option value="ë“±ê¸°ì‹ ì²­ì„œë¥˜ì‘ì„± (2ì°¨)">ë“±ê¸°ì‹ ì²­ì„œë¥˜ì‘ì„± (2ì°¨)</option>
                        </optgroup>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">ì˜ˆìƒ í•™ìŠµ ì‹œê°„ (ì‹œê°„)</label>
                    <input type="number" class="form-input" id="blockHours" placeholder="ì˜ˆ: 2" min="0.5" step="0.5" value="2">
                </div>
                <div class="form-group">
                    <label class="form-label">í•™ìŠµ ë‚´ìš©</label>
                    <input type="text" class="form-input" id="blockDetail" placeholder="ì˜ˆ: ê¸°ì¶œë¬¸ì œ #201-250">
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('timeBlockModal')">ì·¨ì†Œ</button>
                <button class="modal-btn save" onclick="saveTimeBlock()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- ì‹œí—˜ ë‚ ì§œ ì„¤ì • ëª¨ë‹¬ -->
    <div id="examDateModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="examDateModalTitle">ì‹œí—˜ ë‚ ì§œ ì„¤ì •</h3>
                <button class="modal-close" aria-label="ë‹«ê¸°" onclick="closeModal('examDateModal')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ì‹œí—˜ ë‚ ì§œ</label>
                    <input type="date" class="form-input" id="examDateInput">
                </div>
                <div class="form-group">
                    <label class="form-label">ë©”ëª¨ (ì„ íƒ)</label>
                    <input type="text" class="form-input" id="examDateMemo" placeholder="ì˜ˆ: í•„ê¸°ì‹œí—˜">
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('examDateModal')">ì·¨ì†Œ</button>
                <button class="modal-btn save" onclick="saveExamDate()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- ê³¼ëª© ì§„ë„ ìˆ˜ì • ëª¨ë‹¬ -->
    <div id="subjectProgressModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="subjectProgressModalTitle">ê³¼ëª© ì§„ë„ ìˆ˜ì •</h3>
                <button class="modal-close" aria-label="ë‹«ê¸°" onclick="closeModal('subjectProgressModal')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ì™„ë£Œ ë¬¸ì œìˆ˜</label>
                    <input type="number" class="form-input" id="subjectCompleted" min="0">
                </div>
                <div class="form-group">
                    <label class="form-label">ëª©í‘œ ë¬¸ì œìˆ˜</label>
                    <input type="number" class="form-input" id="subjectTotal" min="1">
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('subjectProgressModal')">ì·¨ì†Œ</button>
                <button class="modal-btn save" onclick="saveSubjectProgress()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- ì£¼ê°„ í•™ìŠµ ì‹œê°„ ìˆ˜ì • ëª¨ë‹¬ -->
    <div id="weeklyHoursModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="weeklyHoursModalTitle">í•™ìŠµ ì‹œê°„ ìˆ˜ì •</h3>
                <button class="modal-close" aria-label="ë‹«ê¸°" onclick="closeModal('weeklyHoursModal')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">í•™ìŠµ ì‹œê°„ (ì‹œê°„)</label>
                    <input type="number" class="form-input" id="weeklyHoursInput" min="0" step="0.5">
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('weeklyHoursModal')">ì·¨ì†Œ</button>
                <button class="modal-btn save" onclick="saveWeeklyHours()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- í¬ëª¨ë„ë¡œ íƒ€ì´ë¨¸ ì„¤ì • ëª¨ë‹¬ -->
    <div id="pomodoroSettingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">âš™ï¸ í¬ëª¨ë„ë¡œ íƒ€ì´ë¨¸ ì„¤ì •</h3>
                <button class="modal-close" aria-label="ë‹«ê¸°" onclick="closeModal('pomodoroSettingsModal')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ì‘ì—… ì‹œê°„ (ë¶„)</label>
                    <input type="number" class="form-input" id="pomodoroWorkMinutes" min="1" max="120" step="1" value="25">
                    <small style="color: #6c757d; font-size: 0.85rem; display: block; margin-top: 5px;">ê¶Œì¥: 25ë¶„ (ê¸°ë³¸ í¬ëª¨ë„ë¡œ)</small>
                </div>
                <div class="form-group" style="margin-top: 15px;">
                    <label class="form-label">íœ´ì‹ ì‹œê°„ (ë¶„)</label>
                    <input type="number" class="form-input" id="pomodoroBreakMinutes" min="1" max="30" step="1" value="5">
                    <small style="color: #6c757d; font-size: 0.85rem; display: block; margin-top: 5px;">ê¶Œì¥: 5ë¶„</small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('pomodoroSettingsModal')">ì·¨ì†Œ</button>
                <button class="modal-btn save" onclick="savePomodoroSettings()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- í™•ì¸ ëª¨ë‹¬ (confirm ëŒ€ì²´) -->
    <div id="confirmModal" class="modal confirm-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="confirmModalTitle">í™•ì¸</h3>
                <button class="modal-close" aria-label="ë‹«ê¸°" onclick="closeModal('confirmModal')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="confirm-message" id="confirmMessage">ì •ë§ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('confirmModal')">ì·¨ì†Œ</button>
                <button class="modal-btn save" id="confirmOkBtn">í™•ì¸</button>
            </div>
        </div>
    </div>

    <!-- í‹€ë¦° ë¬¸ì œ ë…¸íŠ¸ ëª¨ë‹¬ -->
    <div id="wrongNoteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">í‹€ë¦° ë¬¸ì œ ë…¸íŠ¸ ì¶”ê°€</h3>
                <button class="modal-close" aria-label="ë‹«ê¸°" onclick="closeModal('wrongNoteModal')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ê³¼ëª©ëª…</label>
                    <input type="text" class="form-input" id="wrongSubject" placeholder="ì˜ˆ: ë¯¼ë²•">
                </div>
                <div class="form-group">
                    <label class="form-label">í‹€ë¦° ë¬¸ì œ ë²ˆí˜¸ ë˜ëŠ” ë‚´ìš©</label>
                    <input type="text" class="form-input" id="wrongQuestion" placeholder="ì˜ˆ: 2024ë…„ 1íšŒ 35ë²ˆ">
                </div>
                <div class="form-group">
                    <label class="form-label">í‹€ë¦° ì´ìœ </label>
                    <textarea class="form-input" id="wrongReason" rows="3" placeholder="ì´ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('wrongNoteModal')">ì·¨ì†Œ</button>
                <button class="modal-btn save" onclick="saveWrongNote()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- ë°ì´í„° ê°€ì ¸ì˜¤ê¸° í™•ì¸ ëª¨ë‹¬ -->
    <div id="importConfirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ë°ì´í„° ê°€ì ¸ì˜¤ê¸° í™•ì¸</h3>
                <button class="modal-close" aria-label="ë‹«ê¸°" onclick="closeModal('importConfirmModal')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="confirm-message" style="margin-bottom: 20px; color: var(--warning-dark); font-weight: 600;">
                    âš ï¸ í˜„ì¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ ë°ì´í„°ë¡œ êµì²´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?<br>
                    <span style="font-size: 0.9rem; color: var(--danger-color);">í˜„ì¬ ë°ì´í„°ëŠ” ì™„ì „íˆ ì‚­ì œë˜ë©° ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</span>
                </div>
                <div class="import-preview" id="importPreviewContainer">
                    <!-- ê°€ì ¸ì˜¬ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('importConfirmModal')">ì·¨ì†Œ</button>
                <button class="modal-btn save" id="confirmImportBtn" style="background: var(--danger-color);">í™•ì¸ ë° ê°€ì ¸ì˜¤ê¸°</button>
            </div>
        </div>
    </div>

    <!-- í† ìŠ¤íŠ¸ ì•Œë¦¼ ì»¨í…Œì´ë„ˆ -->
    <div id="toastContainer" class="toast-container"></div>

    <script>
        console.log('âœ… ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘ë¨');

        // ë°ì´í„° ì´ˆê¸°í™”
        let studyData = {
            examType: localStorage.getItem('examType') || '1ì°¨',
            examDates: {
                '1ì°¨': null,  // Format: 'YYYY-MM-DD'
                '2ì°¨': null
            },
            timer: {
                seconds: 0,
                isRunning: false,
                interval: null
            },
            pomodoro: {
                workMinutes: 25, // Configurable work time
                breakMinutes: 5, // Configurable break time
                seconds: 1500, // 25 minutes (will be updated based on workMinutes)
                isRunning: false,
                interval: null,
                mode: 'work', // 'work' or 'break'
                completedSessions: 0
            },
            subjects1st: [
                { name: 'í—Œë²•', total: 500, completed: 320, rotations: [true, true, false, false, false, false, false] },
                { name: 'ë¯¼ë²•', total: 800, completed: 580, rotations: [true, true, true, false, false, false, false] },
                { name: 'ìƒë²•', total: 500, completed: 280, rotations: [true, true, false, false, false, false, false] },
                { name: 'ë¯¼ì‚¬ì§‘í–‰ë²•', total: 400, completed: 180, rotations: [true, false, false, false, false, false, false] },
                { name: 'ë¶€ë™ì‚°ë“±ê¸°ë²•', total: 500, completed: 420, rotations: [true, true, true, true, false, false, false] },
                { name: 'ìƒì—…ë“±ê¸°ë²•', total: 300, completed: 150, rotations: [true, false, false, false, false, false, false] },
                { name: 'ê³µíƒë²•', total: 300, completed: 200, rotations: [true, true, false, false, false, false, false] }
            ],
            subjects2nd: [
                { name: 'ë¯¼ë²• (2ì°¨)', total: 100, completed: 0, rotations: [false, false, false, false, false, false, false] },
                { name: 'í˜•ë²• (2ì°¨)', total: 50, completed: 0, rotations: [false, false, false, false, false, false, false] },
                { name: 'í˜•ì‚¬ì†Œì†¡ë²• (2ì°¨)', total: 50, completed: 0, rotations: [false, false, false, false, false, false, false] },
                { name: 'ë¯¼ì‚¬ì†Œì†¡ë²• (2ì°¨)', total: 70, completed: 0, rotations: [false, false, false, false, false, false, false] },
                { name: 'ë¯¼ì‚¬ì‚¬ê±´ì„œë¥˜ì‘ì„± (2ì°¨)', total: 30, completed: 0, rotations: [false, false, false, false, false, false, false] },
                { name: 'ë¶€ë™ì‚°ë“±ê¸°ë²• (2ì°¨)', total: 70, completed: 0, rotations: [false, false, false, false, false, false, false] },
                { name: 'ë“±ê¸°ì‹ ì²­ì„œë¥˜ì‘ì„± (2ì°¨)', total: 30, completed: 0, rotations: [false, false, false, false, false, false, false] }
            ],
            subjects: [],  // Will be set dynamically based on examType
            timeBlocks: [
                { id: Date.now() - 1000000, subject: 'í—Œë²•', hours: 2.5, duration: 2.5, date: new Date(Date.now() - 6 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                { id: Date.now() - 999000, subject: 'ë¯¼ë²•', hours: 3, duration: 3, date: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                { id: Date.now() - 998000, subject: 'ìƒë²•', hours: 2, duration: 2, date: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                { id: Date.now() - 997000, subject: 'ë¶€ë™ì‚°ë“±ê¸°ë²•', hours: 2.5, duration: 2.5, date: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: false },
                { id: Date.now() - 996000, subject: 'í—Œë²•', hours: 1.5, duration: 1.5, date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                { id: Date.now() - 995000, subject: 'ë¯¼ì‚¬ì§‘í–‰ë²•', hours: 2, duration: 2, date: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true }
            ],
            mockScores: [
                { id: Date.now() - 100000, date: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 65, examType: '1ì°¨' },
                { id: Date.now() - 90000, date: new Date(Date.now() - 23 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 72, examType: '1ì°¨' },
                { id: Date.now() - 80000, date: new Date(Date.now() - 16 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 68, examType: '1ì°¨' },
                { id: Date.now() - 70000, date: new Date(Date.now() - 9 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 78, examType: '1ì°¨' },
                { id: Date.now() - 60000, date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 82, examType: '1ì°¨' }
            ],
            weeklyHours: {},
            notes: {},
            // New features data
            streak: {
                current: 5,
                longest: 12,
                lastStudyDate: new Date().toISOString().split('T')[0],
                totalDays: 18
            },
            goals: [
                { title: '1ì°¨ ì‹œí—˜ í•©ê²©', dueDate: new Date(Date.now() + 60 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], achieved: false, progress: 75 },
                { title: 'ì „ ê³¼ëª© 3íšŒë…', dueDate: new Date(Date.now() + 90 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], achieved: false, progress: 45 }
            ],
            subjectTimeSpent: {
                'í—Œë²•': 12.5,
                'ë¯¼ë²•': 15,
                'ìƒë²•': 8,
                'ë¶€ë™ì‚°ë“±ê¸°ë²•': 10,
                'ë¯¼ì‚¬ì§‘í–‰ë²•': 8,
                'ê³µíƒë²•': 5,
                'ìƒì—…ë“±ê¸°ë²•': 3
            },  // Track time spent per subject
            studyHistory: []  // Daily study records
        };

        // ì „ì—­ ë³€ìˆ˜ ì„ ì–¸ (ëª¨ë‹¬ í¸ì§‘ ìƒíƒœ ì¶”ì )
        let editingBlockId = null;  // ì‹œê°„ ë¸”ë¡ í¸ì§‘ ëª¨ë“œ ì¶”ì 
        let editingScoreId = null;  // ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ í¸ì§‘ ëª¨ë“œ ì¶”ì 
        let editingGoalId = null;   // í•™ìŠµ ëª©í‘œ í¸ì§‘ ëª¨ë“œ ì¶”ì 

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¡œë“œ
        function loadData() {
            const saved = localStorage.getItem('studyData');
            if (saved) {
                const loadedData = JSON.parse(saved);
                studyData = { ...studyData, ...loadedData };

                // 2ì°¨ ê³¼ëª©ì´ ì—†ê±°ë‚˜ êµ¬ë²„ì „ì¸ ê²½ìš° ìƒˆë¡œìš´ ê¸°ë³¸ê°’ ì„¤ì •
                if (!studyData.subjects2nd || studyData.subjects2nd.length === 4) {
                    studyData.subjects2nd = [
                        { name: 'ë¯¼ë²• (2ì°¨)', total: 100, completed: 0, rotations: [false, false, false, false, false, false, false] },
                        { name: 'í˜•ë²• (2ì°¨)', total: 50, completed: 0, rotations: [false, false, false, false, false, false, false] },
                        { name: 'í˜•ì‚¬ì†Œì†¡ë²• (2ì°¨)', total: 50, completed: 0, rotations: [false, false, false, false, false, false, false] },
                        { name: 'ë¯¼ì‚¬ì†Œì†¡ë²• (2ì°¨)', total: 70, completed: 0, rotations: [false, false, false, false, false, false, false] },
                        { name: 'ë¯¼ì‚¬ì‚¬ê±´ì„œë¥˜ì‘ì„± (2ì°¨)', total: 30, completed: 0, rotations: [false, false, false, false, false, false, false] },
                        { name: 'ë¶€ë™ì‚°ë“±ê¸°ë²• (2ì°¨)', total: 70, completed: 0, rotations: [false, false, false, false, false, false, false] },
                        { name: 'ë“±ê¸°ì‹ ì²­ì„œë¥˜ì‘ì„± (2ì°¨)', total: 30, completed: 0, rotations: [false, false, false, false, false, false, false] }
                    ];
                }

                // 1ì°¨ ê³¼ëª©ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì„¤ì • (êµ¬ë²„ì „ í˜¸í™˜ì„±)
                if (!studyData.subjects1st && studyData.subjects) {
                    studyData.subjects1st = studyData.subjects;
                }

                // Ensure sample data is preserved if empty
                if (!studyData.timeBlocks || studyData.timeBlocks.length === 0) {
                    studyData.timeBlocks = [
                        { subject: 'í—Œë²•', hours: 2.5, duration: 2.5, date: new Date(Date.now() - 6 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                        { subject: 'ë¯¼ë²•', hours: 3, duration: 3, date: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                        { subject: 'ìƒë²•', hours: 2, duration: 2, date: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                        { subject: 'ë¶€ë™ì‚°ë“±ê¸°ë²•', hours: 2.5, duration: 2.5, date: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: false },
                        { subject: 'í—Œë²•', hours: 1.5, duration: 1.5, date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                        { subject: 'ë¯¼ì‚¬ì§‘í–‰ë²•', hours: 2, duration: 2, date: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true }
                    ];
                }
                if (!studyData.mockScores || studyData.mockScores.length === 0) {
                    studyData.mockScores = [
                        { date: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 65, examType: '1ì°¨' },
                        { date: new Date(Date.now() - 23 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 72, examType: '1ì°¨' },
                        { date: new Date(Date.now() - 16 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 68, examType: '1ì°¨' },
                        { date: new Date(Date.now() - 9 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 78, examType: '1ì°¨' },
                        { date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 82, examType: '1ì°¨' }
                    ];
                }
            }

            // ì‹œí—˜ íƒ€ì…ì— ë”°ë¼ ê³¼ëª© ì„¤ì •
            updateSubjectsByExamType();

            // ì˜¤ëŠ˜ íƒ€ì´ë¨¸ ë°ì´í„° ë¡œë“œ
            const today = new Date().toISOString().split('T')[0];
            const todayTimer = localStorage.getItem(`timer_${today}`);
            if (todayTimer) {
                studyData.timer.seconds = parseInt(todayTimer);
            }
        }

        // ì‹œí—˜ íƒ€ì…ì— ë”°ë¼ ê³¼ëª© ì„¤ì •
        function updateSubjectsByExamType() {
            if (studyData.examType === '2ì°¨') {
                studyData.subjects = studyData.subjects2nd;
            } else {
                studyData.subjects = studyData.subjects1st;
            }
        }
        
        // ë°ì´í„° ì €ì¥
        function saveData() {
            localStorage.setItem('studyData', JSON.stringify(studyData));

            // ì˜¤ëŠ˜ íƒ€ì´ë¨¸ ë³„ë„ ì €ì¥
            const today = new Date().toISOString().split('T')[0];
            localStorage.setItem(`timer_${today}`, studyData.timer.seconds);

            // v3.0.0 ë™ê¸°í™” í‘œì‹œ ì—…ë°ì´íŠ¸
            updateSyncBadge();
        }

        // v3.0.0 ë™ê¸°í™” í‘œì‹œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateSyncBadge() {
            const syncBadge = document.getElementById('syncBadge');
            if (!syncBadge) return;

            // "ì €ì¥ì¤‘..." ìƒíƒœ
            syncBadge.classList.add('saving');
            syncBadge.querySelector('.sync-badge-text').textContent = 'ì €ì¥ì¤‘...';
            syncBadge.querySelector('.sync-badge-icon').textContent = 'â³';

            // 300ms í›„ "ì €ì¥ë¨" ìƒíƒœë¡œ ë³€ê²½
            setTimeout(() => {
                syncBadge.classList.remove('saving');
                syncBadge.classList.remove('syncing');
                syncBadge.querySelector('.sync-badge-text').textContent = 'ì €ì¥ë¨';
                syncBadge.querySelector('.sync-badge-icon').textContent = 'âœ“';
                syncBadge.querySelector('#syncTime').textContent = 'ë°©ê¸ˆ ì „';
            }, 300);

            // 5ì´ˆ í›„ ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹œì‘
            setTimeout(() => {
                updateSyncTime();
            }, 5000);
        }

        // ë™ê¸°í™” ì‹œê°„ ì—…ë°ì´íŠ¸
        let syncTimeInterval;
        function updateSyncTime() {
            const syncBadge = document.getElementById('syncBadge');
            if (!syncBadge) return;

            if (syncTimeInterval) clearInterval(syncTimeInterval);

            syncTimeInterval = setInterval(() => {
                const timeEl = document.getElementById('syncTime');
                if (timeEl) {
                    // "ë°©ê¸ˆ ì „" â†’ "1ë¶„ ì „" â†’ "2ë¶„ ì „" ë“±ìœ¼ë¡œ ì—…ë°ì´íŠ¸
                    // ê°„ë‹¨íˆ êµ¬í˜„í•˜ë©´:
                    const now = new Date();
                    const elapsed = Math.floor((now.getTime() - new Date().getTime()) / 1000);
                    if (elapsed < 60) {
                        timeEl.textContent = 'ë°©ê¸ˆ ì „';
                    } else if (elapsed < 3600) {
                        const minutes = Math.floor(elapsed / 60);
                        timeEl.textContent = `${minutes}ë¶„ ì „`;
                    } else {
                        const hours = Math.floor(elapsed / 3600);
                        timeEl.textContent = `${hours}ì‹œê°„ ì „`;
                    }
                }
            }, 30000); // 30ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
        }
        
        // ì´ˆê¸°í™” í•¨ìˆ˜
        function init() {
            loadData();
            updateSubjectsByExamType(); // Set subjects based on exam type
            updateDDay();
            updateStreak();
            renderTimeBlocks();
            renderRotationTracker();
            renderWeeklyStats();
            renderSubjectProgress();
            renderMockScores();
            updateTimerDisplay();
            updatePomodoroDisplay();
            document.getElementById('pomodoro-count').textContent = studyData.pomodoro.completedSessions || 0;
            rotateMotivation();
            renderAnalytics();
            updateSyncStatus(); // Update data size display on initial load

            // ì‹œí—˜ íƒ€ì… ë° ëª¨ë“œ ì„¤ì •
            document.querySelectorAll('.mode-btn').forEach(btn => {
                const btnText = btn.textContent.trim();
                // ì‹œí—˜ íƒ€ì… ë²„íŠ¼
                if (btnText === '1ì°¨ ì‹œí—˜' || btnText === '2ì°¨ ì‹œí—˜') {
                    btn.classList.remove('active');
                    if (btnText === studyData.examType + ' ì‹œí—˜') {
                        btn.classList.add('active');
                    }
                }
                // í•™ìŠµ ëª¨ë“œ ë²„íŠ¼
                else {
                    btn.classList.remove('active');
                    if(btnText.includes(studyData.mode)) {
                        btn.classList.add('active');
                    }
                }
            });

            // v3.0.0 ìƒˆ ê¸°ëŠ¥ ì´ˆê¸°í™”
            setTimeout(() => {
                startProgressUpdate(); // Sticky Progress Bar ì‹œì‘
                enableNotesAutoSave(); // Notes Auto-save í™œì„±í™”
                console.log('âœ… v3.0.0 ìƒˆ ê¸°ëŠ¥ í™œì„±í™”ë¨');
            }, 500);

            // Note: Sample data is already initialized in the studyData object above
            // This prevents overwriting sample data with old defaults
        }
        
        // D-Day ê³„ì‚° ë° ì—…ë°ì´íŠ¸ (1ì°¨/2ì°¨)
        function updateDDay() {
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            // 1ì°¨ ì‹œí—˜ D-day
            const exam1stDate = studyData.examDates?.['1ì°¨'];
            const card1st = document.getElementById('dday-1st-card');
            if (exam1stDate) {
                const targetDate = new Date(exam1stDate);
                targetDate.setHours(0, 0, 0, 0);
                const diffDays = Math.ceil((targetDate - today) / (1000 * 60 * 60 * 24));

                let ddayText, urgencyClass;
                if (diffDays > 0) {
                    ddayText = `D-${diffDays}`;
                    urgencyClass = diffDays <= 30 ? 'urgent' : (diffDays <= 90 ? 'warning' : 'normal');
                } else if (diffDays === 0) {
                    ddayText = 'D-Day';
                    urgencyClass = 'urgent';
                } else {
                    ddayText = `D+${Math.abs(diffDays)}`;
                    urgencyClass = 'normal';
                }

                document.getElementById('dday-1st-value').textContent = ddayText;
                document.getElementById('dday-1st-date').textContent = exam1stDate;
                card1st.className = `dday-card ${urgencyClass}`;
            } else {
                document.getElementById('dday-1st-value').textContent = 'D-?';
                document.getElementById('dday-1st-date').textContent = 'ë‚ ì§œ ë¯¸ì„¤ì •';
                card1st.className = 'dday-card';
            }

            // 2ì°¨ ì‹œí—˜ D-day
            const exam2ndDate = studyData.examDates?.['2ì°¨'];
            const card2nd = document.getElementById('dday-2nd-card');
            if (exam2ndDate) {
                const targetDate = new Date(exam2ndDate);
                targetDate.setHours(0, 0, 0, 0);
                const diffDays = Math.ceil((targetDate - today) / (1000 * 60 * 60 * 24));

                let ddayText, urgencyClass;
                if (diffDays > 0) {
                    ddayText = `D-${diffDays}`;
                    urgencyClass = diffDays <= 30 ? 'urgent' : (diffDays <= 90 ? 'warning' : 'normal');
                } else if (diffDays === 0) {
                    ddayText = 'D-Day';
                    urgencyClass = 'urgent';
                } else {
                    ddayText = `D+${Math.abs(diffDays)}`;
                    urgencyClass = 'normal';
                }

                document.getElementById('dday-2nd-value').textContent = ddayText;
                document.getElementById('dday-2nd-date').textContent = exam2ndDate;
                card2nd.className = `dday-card ${urgencyClass}`;
            } else {
                document.getElementById('dday-2nd-value').textContent = 'D-?';
                document.getElementById('dday-2nd-date').textContent = 'ë‚ ì§œ ë¯¸ì„¤ì •';
                card2nd.className = 'dday-card';
            }
        }

        // ì‹œí—˜ ë‚ ì§œ ì„¤ì • ëª¨ë‹¬
        let editingExamType = null;

        function editExamDate(examType) {
            editingExamType = examType;
            document.getElementById('examDateModalTitle').textContent = `${examType} ì‹œí—˜ ë‚ ì§œ ì„¤ì •`;

            const currentDate = studyData.examDates?.[examType];
            document.getElementById('examDateInput').value = currentDate || '';
            document.getElementById('examDateMemo').value = '';

            document.getElementById('examDateModal').classList.add('show');
        }

        function saveExamDate() {
            if (!editingExamType) return;

            const dateValue = document.getElementById('examDateInput').value;

            if (dateValue) {
                if (!studyData.examDates) studyData.examDates = {};
                studyData.examDates[editingExamType] = dateValue;

                saveData();
                updateDDay();
                closeModal('examDateModal');
                showToast(`${editingExamType} ì‹œí—˜ ë‚ ì§œê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤`);

                editingExamType = null;
            } else {
                showToast('ì‹œí—˜ ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
            }
        }
        
        console.log('âœ… setExamType í•¨ìˆ˜ ì •ì˜ ì§ì „');

        // ì‹œí—˜ íƒ€ì… ì„¤ì •
        function setExamType(type) {
            console.log(`ğŸ”„ Switching exam type to: ${type}`);

            studyData.examType = type;
            localStorage.setItem('examType', type);

            // ê³¼ëª© ì—…ë°ì´íŠ¸
            updateSubjectsByExamType();

            saveData();

            document.querySelectorAll('.mode-btn').forEach(btn => {
                if (btn.textContent.includes('ì‹œí—˜')) {
                    btn.classList.remove('active');
                    if (btn.textContent === type + ' ì‹œí—˜') {
                        btn.classList.add('active');
                    }
                }
            });

            // UI ì—…ë°ì´íŠ¸ - COMPLETE refresh of all exam-type dependent components
            updateDDay();              // Update D-day counters for both exams
            renderTimeBlocks();        // Refresh time blocks with new subjects
            renderRotationTracker();   // Update rotation tracker
            renderWeeklyStats();       // Refresh weekly statistics
            renderSubjectProgress();   // Update subject progress bars
            renderMockScores();        // Refresh mock exam scores display
            renderAnalytics();         // Update analytics dashboard
            initAllCharts();          // Update all charts with new subjects

            showToast(`${type} ì‹œí—˜ ëª¨ë“œë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤`);
            console.log(`âœ… Exam type changed to ${type} - All UI components updated`);
        }

        // ì‹œê°„ ë¸”ë¡ ë Œë”ë§
        function renderTimeBlocks() {
            const container = document.getElementById('time-blocks-container');
            container.innerHTML = '';

            // Get today's date and filter blocks for today only
            const today = new Date().toISOString().split('T')[0];
            const todayBlocks = studyData.timeBlocks.filter(block =>
                block.date === today  // Only show blocks from today
            );

            // If no blocks for today, show empty state message
            if (todayBlocks.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="text-align: center; padding: 20px; color: var(--text-secondary);">
                        <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“š</div>
                        <div>ì˜¤ëŠ˜ì˜ í•™ìŠµ ê³„íšì´ ì—†ìŠµë‹ˆë‹¤</div>
                        <div style="font-size: 12px; margin-top: 8px;">í•™ìŠµ ì‹œê°„ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”</div>
                    </div>
                `;
                return;
            }

            todayBlocks.forEach((block, idx) => {
                const blockEl = document.createElement('div');
                blockEl.className = `time-block ${block.completed ? 'completed' : ''}`;

                // ì•¡ì…˜ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'time-block-actions';

                // ìˆ˜ì • ë²„íŠ¼
                const editBtn = document.createElement('button');
                editBtn.className = 'time-block-btn';
                editBtn.textContent = 'âœï¸';
                editBtn.onclick = () => editTimeBlock(block);

                // ì‚­ì œ ë²„íŠ¼
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'time-block-btn';
                deleteBtn.textContent = 'ğŸ—‘ï¸';
                deleteBtn.onclick = () => deleteTimeBlock(block);

                actionsDiv.appendChild(editBtn);
                actionsDiv.appendChild(deleteBtn);

                // ì‹œê°„ ë¼ë²¨
                const timeLabel = document.createElement('div');
                timeLabel.className = 'time-label';
                const hours = block.hours || 2;
                timeLabel.textContent = `â° ${block.time} (${hours}h)`;

                // ê³¼ëª©ëª…
                const subjectDiv = document.createElement('div');
                subjectDiv.className = 'time-subject';
                subjectDiv.textContent = block.subject;

                // ìƒì„¸ ë‚´ìš©
                const detailDiv = document.createElement('div');
                detailDiv.className = 'time-detail';
                detailDiv.textContent = block.detail;

                // ì™„ë£Œ ë²„íŠ¼
                const checkBtn = document.createElement('button');
                checkBtn.className = `check-btn ${block.completed ? 'checked' : ''}`;
                checkBtn.textContent = block.completed ? 'ì™„ë£Œâœ“' : 'ì™„ë£Œ';
                checkBtn.onclick = () => toggleTimeBlock(block.id);

                // ëª¨ë‘ ì¶”ê°€
                blockEl.appendChild(actionsDiv);
                blockEl.appendChild(timeLabel);
                blockEl.appendChild(subjectDiv);
                blockEl.appendChild(detailDiv);
                blockEl.appendChild(checkBtn);

                container.appendChild(blockEl);
            });
        }
        
        // ì‹œê°„ ë¸”ë¡ í† ê¸€
        function toggleTimeBlock(id) {
            const block = studyData.timeBlocks.find(b => b.id === id);
            if (block) {
                block.completed = !block.completed;
                const hours = block.hours || 2; // Default to 2 hours if not set (legacy compatibility)
                const seconds = hours * 3600;
                const today = new Date().toISOString().split('T')[0];

                if (block.completed) {
                    studyData.timer.seconds += seconds;

                    // Populate studyHistory when block is completed
                    if (!studyData.studyHistory) {
                        studyData.studyHistory = [];
                    }

                    // Add or update today's study history entry
                    let todayHistory = studyData.studyHistory.find(h => h.date === today);
                    if (!todayHistory) {
                        todayHistory = {
                            date: today,
                            totalHours: 0,
                            completedBlocks: [],
                            note: ''
                        };
                        studyData.studyHistory.push(todayHistory);
                    }

                    // Add this block to today's history
                    todayHistory.totalHours += hours;
                    todayHistory.completedBlocks.push({
                        subject: block.subject,
                        hours: hours,
                        time: block.time
                    });

                    updateTimerDisplay();
                    showToast(`í•™ìŠµ ì™„ë£Œ! ${hours}ì‹œê°„ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤ ğŸ‘`);
                } else {
                    studyData.timer.seconds = Math.max(0, studyData.timer.seconds - seconds);

                    // Remove from studyHistory when uncompleted
                    if (studyData.studyHistory) {
                        let todayHistory = studyData.studyHistory.find(h => h.date === today);
                        if (todayHistory) {
                            // Remove this block from completed blocks
                            todayHistory.completedBlocks = todayHistory.completedBlocks.filter(
                                cb => !(cb.subject === block.subject && cb.time === block.time)
                            );
                            todayHistory.totalHours -= hours;

                            // If no more blocks, remove the entire day
                            if (todayHistory.completedBlocks.length === 0 && todayHistory.totalHours === 0) {
                                studyData.studyHistory = studyData.studyHistory.filter(h => h.date !== today);
                            }
                        }
                    }

                    updateTimerDisplay();
                }
                saveData();
                renderTimeBlocks();
                updateStreak();
                renderAnalytics();
            }
        }
        
        // ì‹œê°„ ë¸”ë¡ ì¶”ê°€
        function addTimeBlock() {
            editingBlockId = null;  // í¸ì§‘ ëª¨ë“œ ì´ˆê¸°í™”
            document.getElementById('blockStartTime').value = '';
            document.getElementById('blockEndTime').value = '';
            document.getElementById('blockSubject').value = '';
            document.getElementById('blockDetail').value = '';
            document.querySelector('#timeBlockModal .modal-title').textContent = 'í•™ìŠµ ì‹œê°„ ë¸”ë¡ ì¶”ê°€';
            document.getElementById('timeBlockModal').classList.add('show');
        }
        
        // ì‹œê°„ ë¸”ë¡ ì €ì¥
        function saveTimeBlock() {
            const startTime = document.getElementById('blockStartTime').value;
            const endTime = document.getElementById('blockEndTime').value;
            const subject = document.getElementById('blockSubject').value;
            const detail = document.getElementById('blockDetail').value;
            // Get today's date in YYYY-MM-DD format for daily tracking
            const today = new Date().toISOString().split('T')[0];

            // ê²€ì¦: í•„ìˆ˜ í•„ë“œ í™•ì¸
            if (!startTime) {
                showToast('âš ï¸ ì‹œì‘ ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”', 'warning');
                return;
            }
            if (!endTime) {
                showToast('âš ï¸ ë ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”', 'warning');
                return;
            }
            if (!subject) {
                showToast('âš ï¸ ê³¼ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”', 'warning');
                return;
            }
            if (!detail) {
                showToast('âš ï¸ í•™ìŠµ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”', 'warning');
                return;
            }

            // ì‹œê°„ ì°¨ì´ ê³„ì‚° (HH:MM í˜•ì‹)
            const [startHour, startMin] = startTime.split(':').map(Number);
            const [endHour, endMin] = endTime.split(':').map(Number);
            const startTotalMins = startHour * 60 + startMin;
            const endTotalMins = endHour * 60 + endMin;

            let diffMins = endTotalMins - startTotalMins;
            if (diffMins <= 0) {
                showToast('âš ï¸ ë ì‹œê°„ì´ ì‹œì‘ ì‹œê°„ë³´ë‹¤ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤', 'warning');
                return;
            }

            const hours = diffMins / 60; // ì‹œê°„ìœ¼ë¡œ ë³€í™˜
            const time = `${startTime}-${endTime}`; // "HH:MM-HH:MM" í˜•ì‹

            if (startTime && endTime && subject && detail) {
                if (editingBlockId) {
                    // ìˆ˜ì • ëª¨ë“œ
                    const block = studyData.timeBlocks.find(b => b.id === editingBlockId);
                    if (block) {
                        // ì–‘ë°©í–¥ ë™ê¸°í™”: ì™„ë£Œëœ ë¸”ë¡ì˜ ì‹œê°„ ë³€ê²½ ì‹œ timerì— ë°˜ì˜
                        if (block.completed) {
                            const oldSeconds = block.hours * 3600;
                            const newSeconds = hours * 3600;
                            const diffSeconds = newSeconds - oldSeconds;
                            studyData.timer.seconds = Math.max(0, studyData.timer.seconds + diffSeconds);
                        }

                        block.time = time;
                        block.subject = subject;
                        block.hours = hours;
                        block.detail = detail;
                        // Preserve date when editing, or set to today if missing
                        if (!block.date) {
                            block.date = today;
                        }
                        showToast('í•™ìŠµ ë¸”ë¡ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤');
                    }
                    editingBlockId = null;
                } else {
                    // ì¶”ê°€ ëª¨ë“œ - Always add with today's date
                    studyData.timeBlocks.push({
                        id: Date.now(),
                        time,
                        subject,
                        hours,
                        detail,
                        date: today,  // Add date field for daily tracking
                        completed: false
                    });
                    showToast('í•™ìŠµ ë¸”ë¡ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');
                }
                saveData();
                renderTimeBlocks();
                renderAnalytics();
                closeModal('timeBlockModal');

                // Reset form
                document.getElementById('blockStartTime').value = '';
                document.getElementById('blockEndTime').value = '';
                document.getElementById('blockDetail').value = '';
                document.querySelector('#timeBlockModal .modal-title').textContent = 'í•™ìŠµ ì‹œê°„ ë¸”ë¡ ì¶”ê°€';
            }
        }
        
        // ì‹œê°„ ë¸”ë¡ ì‚­ì œ
        function deleteTimeBlock(block) {
            showConfirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?', () => {
                // ë¸”ë¡ ê°ì²´ì˜ ì¸ë±ìŠ¤ë¥¼ ì°¾ì•„ì„œ ì‚­ì œ
                const index = studyData.timeBlocks.indexOf(block);
                if (index > -1) {
                    // ì–‘ë°©í–¥ ë™ê¸°í™”: ì™„ë£Œëœ ë¸”ë¡ ì‚­ì œ ì‹œ timerì—ì„œ ì°¨ê°
                    if (block.completed) {
                        const seconds = block.hours * 3600;
                        studyData.timer.seconds = Math.max(0, studyData.timer.seconds - seconds);
                    }

                    studyData.timeBlocks.splice(index, 1);
                    console.log('âœ… ì‹œê°„ ë¸”ë¡ ì‚­ì œë¨:', block.subject);
                } else {
                    console.warn('âš ï¸ ì‚­ì œí•  ë¸”ë¡ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                }
                saveData();
                renderTimeBlocks();
                renderAnalytics();
                showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
            });
        }
        
        // ì‹œê°„ ë¸”ë¡ ìˆ˜ì • (ëª¨ë‹¬ ì‚¬ìš©)
        let editingBlock = null;

        function editTimeBlock(block) {
            if (block) {
                editingBlockId = block.id;  // ìˆ˜ì •í•  ë¸”ë¡ ID ì €ì¥
                // Parse time format "HH:MM-HH:MM"
                const [startTime, endTime] = block.time.split('-');
                document.getElementById('blockStartTime').value = startTime;
                document.getElementById('blockEndTime').value = endTime;
                document.getElementById('blockSubject').value = block.subject;
                document.getElementById('blockDetail').value = block.detail;
                document.querySelector('#timeBlockModal .modal-title').textContent = 'í•™ìŠµ ì‹œê°„ ë¸”ë¡ ìˆ˜ì •';
                document.getElementById('timeBlockModal').classList.add('show');
            }
        }
        
        // íšŒë… íŠ¸ë˜ì»¤ ë Œë”ë§
        function renderRotationTracker() {
            const container = document.getElementById('rotation-tracker');
            container.innerHTML = '';
            
            studyData.subjects.forEach((subject, idx) => {
                const div = document.createElement('div');
                div.className = 'subject-rotation';
                
                let circlesHtml = '';
                subject.rotations.forEach((completed, i) => {
                    const isCurrentjsxjs = completed && !subject.rotations[i + 1];
                    circlesHtml += `
                        <div class="rotation-circle ${completed ? 'completed' : ''} ${isCurrentjsxjs ? 'current' : ''}" 
                             onclick="toggleRotation(${idx}, ${i})">
                            ${i + 1}
                        </div>
                    `;
                });
                
                div.innerHTML = `
                    <span class="subject-name">${subject.name}</span>
                    <div class="rotation-circles">${circlesHtml}</div>
                `;
                container.appendChild(div);
            });
        }
        
        // íšŒë… í† ê¸€
        function toggleRotation(subjectIdx, rotationIdx) {
            const subject = studyData.subjects[subjectIdx];
            subject.rotations[rotationIdx] = !subject.rotations[rotationIdx];
            
            // ì´ì „ íšŒë…ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìœ¼ë©´ ì™„ë£Œ ì²˜ë¦¬
            for (let i = 0; i < rotationIdx; i++) {
                subject.rotations[i] = true;
            }
            
            saveData();
            renderRotationTracker();
            
            if (subject.rotations[rotationIdx]) {
                showToast(`${subject.name} ${rotationIdx + 1}íšŒë… ì™„ë£Œ! ğŸ‰`);
            }
        }
        
        // íšŒë… ì´ˆê¸°í™”
        function resetRotations() {
            showConfirm('ëª¨ë“  íšŒë… ê¸°ë¡ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?', () => {
                studyData.subjects.forEach(subject => {
                    subject.rotations = [false, false, false, false, false, false, false];
                });
                saveData();
                renderRotationTracker();
                showToast('íšŒë… ê¸°ë¡ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
            });
        }
        
        // íƒ€ì´ë¨¸ ê¸°ëŠ¥
        function startTimer() {
            if (!studyData.timer.isRunning) {
                studyData.timer.isRunning = true;
                studyData.timer.interval = setInterval(() => {
                    studyData.timer.seconds++;
                    updateTimerDisplay();
                    
                    // 30ë¶„ë§ˆë‹¤ ìë™ ì €ì¥
                    if (studyData.timer.seconds % 1800 === 0) {
                        saveData();
                        showToast('í•™ìŠµ ì§„ë„ê°€ ìë™ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
                    }
                }, 1000);
            }
        }
        
        function pauseTimer() {
            studyData.timer.isRunning = false;
            clearInterval(studyData.timer.interval);
            saveData();
        }
        
        function resetTimer() {
            showConfirm('ì •ë§ ë¦¬ì…‹í•˜ì‹œê² ìŠµë‹ˆê¹Œ?', () => {
                studyData.timer.isRunning = false;
                clearInterval(studyData.timer.interval);
                studyData.timer.seconds = 0;
                updateTimerDisplay();
                saveData();
                showToast('íƒ€ì´ë¨¸ê°€ ë¦¬ì…‹ë˜ì—ˆìŠµë‹ˆë‹¤');
            });
        }
        
        function updateTimerDisplay() {
            const hours = Math.floor(studyData.timer.seconds / 3600);
            const minutes = Math.floor((studyData.timer.seconds % 3600) / 60);
            const secs = studyData.timer.seconds % 60;

            document.getElementById('timer').textContent =
                `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }

        // í¬ëª¨ë„ë¡œ íƒ€ì´ë¨¸ ê¸°ëŠ¥
        function startPomodoro() {
            if (!studyData.pomodoro.isRunning) {
                studyData.pomodoro.isRunning = true;
                document.getElementById('pomodoro-start').style.display = 'none';
                document.getElementById('pomodoro-pause').style.display = 'inline-block';

                studyData.pomodoro.interval = setInterval(() => {
                    if (studyData.pomodoro.seconds > 0) {
                        studyData.pomodoro.seconds--;
                        updatePomodoroDisplay();
                    } else {
                        // Timer finished
                        playNotificationSound();
                        if (studyData.pomodoro.mode === 'work') {
                            // Work session completed
                            studyData.pomodoro.completedSessions++;

                            // Sync pomodoro time (configurable work minutes) with study time
                            const workSeconds = (studyData.pomodoro.workMinutes || 25) * 60;
                            studyData.timer.seconds += workSeconds;
                            updateTimerDisplay();
                            renderAnalytics(); // Refresh dashboard analytics

                            studyData.pomodoro.mode = 'break';
                            studyData.pomodoro.seconds = (studyData.pomodoro.breakMinutes || 5) * 60;
                            showToast(`ì‘ì—… ì„¸ì…˜ ì™„ë£Œ! ${studyData.pomodoro.breakMinutes}ë¶„ íœ´ì‹ ì‹œì‘ ğŸ‰ | ğŸ“š í•™ìŠµ ì‹œê°„ì— ${studyData.pomodoro.workMinutes}ë¶„ ì¶”ê°€ë¨`);
                            document.getElementById('pomodoro-mode').textContent = 'íœ´ì‹ ì‹œê°„';
                            document.getElementById('pomodoro-mode').className = 'pomodoro-mode break';
                        } else {
                            // Break completed
                            studyData.pomodoro.mode = 'work';
                            studyData.pomodoro.seconds = (studyData.pomodoro.workMinutes || 25) * 60;
                            showToast('íœ´ì‹ ì™„ë£Œ! ìƒˆë¡œìš´ ì‘ì—… ì„¸ì…˜ ì‹œì‘ ğŸ’ª');
                            document.getElementById('pomodoro-mode').textContent = 'ì‘ì—… ì„¸ì…˜';
                            document.getElementById('pomodoro-mode').className = 'pomodoro-mode work';
                        }
                        updatePomodoroDisplay();
                        document.getElementById('pomodoro-count').textContent = studyData.pomodoro.completedSessions;
                        pausePomodoro(); // Auto pause after completion
                        saveData();
                    }
                }, 1000);
            }
        }

        function pausePomodoro() {
            studyData.pomodoro.isRunning = false;
            clearInterval(studyData.pomodoro.interval);
            document.getElementById('pomodoro-start').style.display = 'inline-block';
            document.getElementById('pomodoro-pause').style.display = 'none';
            saveData();
        }

        function resetPomodoro() {
            showConfirm('í¬ëª¨ë„ë¡œ íƒ€ì´ë¨¸ë¥¼ ë¦¬ì…‹í•˜ì‹œê² ìŠµë‹ˆê¹Œ?', () => {
                pausePomodoro();
                studyData.pomodoro.seconds = (studyData.pomodoro.workMinutes || 25) * 60; // Reset to configured work minutes
                studyData.pomodoro.mode = 'work';
                studyData.pomodoro.completedSessions = 0;
                updatePomodoroDisplay();
                document.getElementById('pomodoro-count').textContent = '0';
                document.getElementById('pomodoro-mode').textContent = 'ì‘ì—… ì„¸ì…˜';
                document.getElementById('pomodoro-mode').className = 'pomodoro-mode work';
                saveData();
                showToast('í¬ëª¨ë„ë¡œ íƒ€ì´ë¨¸ê°€ ë¦¬ì…‹ë˜ì—ˆìŠµë‹ˆë‹¤');
            });
        }

        function updatePomodoroDisplay() {
            const minutes = Math.floor(studyData.pomodoro.seconds / 60);
            const secs = studyData.pomodoro.seconds % 60;
            document.getElementById('pomodoro-timer').textContent =
                `${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }

        function showPomodoroSettings() {
            // Populate current settings
            document.getElementById('pomodoroWorkMinutes').value = studyData.pomodoro.workMinutes || 25;
            document.getElementById('pomodoroBreakMinutes').value = studyData.pomodoro.breakMinutes || 5;
            document.getElementById('pomodoroSettingsModal').classList.add('show');
        }

        function savePomodoroSettings() {
            const workMinutes = parseInt(document.getElementById('pomodoroWorkMinutes').value);
            const breakMinutes = parseInt(document.getElementById('pomodoroBreakMinutes').value);

            if (!workMinutes || workMinutes < 1 || workMinutes > 120) {
                showToast('ì‘ì—… ì‹œê°„ì€ 1-120ë¶„ ì‚¬ì´ë¡œ ì„¤ì •í•´ì£¼ì„¸ìš”', 'error');
                return;
            }

            if (!breakMinutes || breakMinutes < 1 || breakMinutes > 30) {
                showToast('íœ´ì‹ ì‹œê°„ì€ 1-30ë¶„ ì‚¬ì´ë¡œ ì„¤ì •í•´ì£¼ì„¸ìš”', 'error');
                return;
            }

            studyData.pomodoro.workMinutes = workMinutes;
            studyData.pomodoro.breakMinutes = breakMinutes;

            // Update seconds if timer is not running
            if (!studyData.pomodoro.isRunning) {
                if (studyData.pomodoro.mode === 'work') {
                    studyData.pomodoro.seconds = workMinutes * 60;
                } else {
                    studyData.pomodoro.seconds = breakMinutes * 60;
                }
                updatePomodoroDisplay();
            }

            saveData();
            closeModal('pomodoroSettingsModal');
            showToast(`í¬ëª¨ë„ë¡œ íƒ€ì´ë¨¸ ì„¤ì •ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤ (ì‘ì—…: ${workMinutes}ë¶„, íœ´ì‹: ${breakMinutes}ë¶„)`);
        }

        // í¬ëª¨ë„ë¡œ ë¹ ë¥¸ ì‹œê°„ ì„¤ì •
        function setPomodoroQuickTime(minutes) {
            if (studyData.pomodoro.isRunning) {
                showToast('íƒ€ì´ë¨¸ ì‹¤í–‰ ì¤‘ì—ëŠ” ì‹œê°„ì„ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤', 'warning');
                return;
            }

            studyData.pomodoro.workMinutes = minutes;
            studyData.pomodoro.seconds = minutes * 60;
            studyData.pomodoro.mode = 'work';

            updatePomodoroDisplay();
            saveData();
            showToast(`ì‘ì—… ì‹œê°„ì´ ${minutes}ë¶„ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤ ğŸ¯`);
        }

        function playNotificationSound() {
            // Create a simple beep sound using Web Audio API
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.frequency.value = 800;
                oscillator.type = 'sine';

                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log('Audio notification not supported');
            }
        }

        // ì£¼ê°„ í†µê³„ ë Œë”ë§
        function renderWeeklyStats() {
            const container = document.getElementById('weekly-stats');
            container.innerHTML = '';

            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];
            const today = new Date();
            const adjustedToday = today.getDay() === 0 ? 6 : today.getDay() - 1;

            // Calculate actual study hours from studyHistory for the past 7 days
            const weeklyHoursCalculated = {};
            const startOfWeek = new Date(today);
            startOfWeek.setDate(today.getDate() - adjustedToday);

            for (let i = 0; i < 7; i++) {
                const date = new Date(startOfWeek);
                date.setDate(startOfWeek.getDate() + i);
                const dateString = date.toISOString().split('T')[0];
                const dayName = days[i];

                // Find study history for this date
                const historyEntry = studyData.studyHistory?.find(h => h.date === dateString);
                weeklyHoursCalculated[dayName] = historyEntry ? historyEntry.totalHours : 0;
            }

            days.forEach((day, idx) => {
                const hours = weeklyHoursCalculated[day] || 0;
                const isToday = idx === adjustedToday;
                const isCompleted = hours >= 4;

                const div = document.createElement('div');
                div.className = `day-stat ${isToday ? 'today' : ''} ${isCompleted ? 'completed' : ''}`;
                div.innerHTML = `
                    <div class="day-name">${day}</div>
                    <div class="day-hours">${hours.toFixed(1)}h</div>
                `;
                container.appendChild(div);
            });
        }
        
        // Note: Weekly hours are now automatically calculated from studyHistory
        // Manual editing removed as it should reflect actual completed study blocks
        
        // ê³¼ëª©ë³„ ì§„ë„ ë Œë”ë§
        function renderSubjectProgress() {
            const container = document.getElementById('subject-progress');
            container.innerHTML = '';

            studyData.subjects.forEach((subject, idx) => {
                const percent = Math.round((subject.completed / subject.total) * 100);
                const div = document.createElement('div');
                div.className = 'progress-item';

                // í—¤ë” ìƒì„±
                const header = document.createElement('div');
                header.className = 'progress-header';
                header.innerHTML = `
                    <span class="progress-label">${subject.name}</span>
                    <span class="progress-value">${subject.completed}/${subject.total} ë¬¸ì œ</span>
                `;
                header.onclick = () => updateProgress(idx);

                // í”„ë¡œê·¸ë ˆìŠ¤ ë°” ìƒì„±
                const progressBar = document.createElement('div');
                progressBar.className = 'progress-bar';
                progressBar.innerHTML = `
                    <div class="progress-fill" style="width: ${percent}%">${percent}%</div>
                `;
                progressBar.onclick = () => updateProgress(idx);

                div.appendChild(header);
                div.appendChild(progressBar);
                container.appendChild(div);
            });
        }

        // ì§„ë„ ì—…ë°ì´íŠ¸ - ëª¨ë‹¬ ì‚¬ìš©
        let editingSubjectIdx = null;

        function updateProgress(idx) {
            const subject = studyData.subjects[idx];
            editingSubjectIdx = idx;

            document.getElementById('subjectProgressModalTitle').textContent = `${subject.name} ì§„ë„ ìˆ˜ì •`;
            document.getElementById('subjectCompleted').value = subject.completed;
            document.getElementById('subjectTotal').value = subject.total;
            document.getElementById('subjectProgressModal').classList.add('show');
        }

        function saveSubjectProgress() {
            if (editingSubjectIdx === null) return;

            const completed = parseInt(document.getElementById('subjectCompleted').value);
            const total = parseInt(document.getElementById('subjectTotal').value);

            if (!isNaN(completed) && !isNaN(total) && total >= 1) {
                const subject = studyData.subjects[editingSubjectIdx];
                subject.completed = completed;
                subject.total = Math.max(total, 1);

                // ì‹¤ì œ ë°ì´í„° ì†ŒìŠ¤ì—ë„ ë°˜ì˜
                if (studyData.examType === '2ì°¨') {
                    studyData.subjects2nd[editingSubjectIdx] = subject;
                } else {
                    studyData.subjects1st[editingSubjectIdx] = subject;
                }

                saveData();
                renderSubjectProgress();  // Refresh the progress display
                renderAnalytics();        // Update analytics dashboard
                closeModal('subjectProgressModal');
                showToast(`${subject.name} ì§„ë„ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤ (${subject.completed}/${subject.total})`);

                editingSubjectIdx = null;
            } else {
                showToast('ì˜¬ë°”ë¥¸ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
            }
        }
        
        // ì „ì²´ ì§„ë„ ì—…ë°ì´íŠ¸
        function updateAllProgress() {
            showToast('ê° ê³¼ëª©ì„ í´ë¦­í•˜ì—¬ ì§„ë„ë¥¼ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”');
        }
        
        // ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ ë Œë”ë§
        function renderMockScores() {
            const container = document.getElementById('mock-scores');
            container.innerHTML = '';

            studyData.mockScores.forEach(score => {
                const isPass = score.score >= 60;
                const div = document.createElement('div');
                div.className = 'score-entry';

                // ë‚ ì§œ ë° ë©”ëª¨ í‘œì‹œ
                const dateSpan = document.createElement('span');
                dateSpan.className = 'score-date';
                dateSpan.textContent = `${score.date} ${score.memo ? `(${score.memo})` : ''}`;

                // ì•¡ì…˜ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'score-actions';

                // ìˆ˜ì • ë²„íŠ¼
                const editBtn = document.createElement('button');
                editBtn.className = 'score-action-btn';
                editBtn.textContent = 'âœï¸';
                editBtn.onclick = () => editScore(score);

                // ì‚­ì œ ë²„íŠ¼
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'score-action-btn';
                deleteBtn.textContent = 'ğŸ—‘ï¸';
                deleteBtn.onclick = () => deleteScore(score);

                actionsDiv.appendChild(editBtn);
                actionsDiv.appendChild(deleteBtn);

                // ì ìˆ˜ í‘œì‹œ
                const scoreSpan = document.createElement('span');
                scoreSpan.className = `score-value ${isPass ? 'pass' : 'fail'}`;
                scoreSpan.textContent = `${score.score}ì `;

                div.appendChild(dateSpan);
                div.appendChild(actionsDiv);
                div.appendChild(scoreSpan);

                container.appendChild(div);
            });

            // ëª©í‘œ ì ìˆ˜ í‘œì‹œ
            const targetDiv = document.createElement('div');
            targetDiv.className = 'score-entry';
            targetDiv.innerHTML = `
                <span class="score-date">ëª©í‘œ ì ìˆ˜</span>
                <span class="score-value pass">65.0ì â†‘</span>
            `;
            container.appendChild(targetDiv);
        }
        
        // ì ìˆ˜ ëª¨ë‹¬ í‘œì‹œ
        function showScoreModal() {
            editingScoreId = null;  // í¸ì§‘ ëª¨ë“œ ì´ˆê¸°í™”
            document.getElementById('scoreDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('scoreValue').value = '';
            document.getElementById('scoreMemo').value = '';
            document.querySelector('#scoreModal .modal-title').textContent = 'ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ ì¶”ê°€';
            document.getElementById('scoreModal').classList.add('show');
        }
        
        // ì ìˆ˜ ì €ì¥
        function saveScore() {
            const date = document.getElementById('scoreDate').value;
            const scoreValue = parseFloat(document.getElementById('scoreValue').value);
            const memo = document.getElementById('scoreMemo').value;

            if (date && !isNaN(scoreValue)) {
                if (editingScoreId) {
                    // ìˆ˜ì • ëª¨ë“œ
                    const score = studyData.mockScores.find(s => s.id === editingScoreId);
                    if (score) {
                        score.date = date;
                        score.score = scoreValue;
                        score.memo = memo;
                        showToast('ì ìˆ˜ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤');
                    }
                    editingScoreId = null;
                } else {
                    // ì¶”ê°€ ëª¨ë“œ
                    studyData.mockScores.push({
                        id: Date.now(),
                        date,
                        score: scoreValue,
                        memo
                    });
                    showToast(`${scoreValue}ì ì´ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤`);
                }

                // ë‚ ì§œìˆœ ì •ë ¬
                studyData.mockScores.sort((a, b) => new Date(a.date) - new Date(b.date));

                saveData();
                renderMockScores();
                closeModal('scoreModal');

                // Reset form and title
                document.getElementById('scoreDate').value = new Date().toISOString().split('T')[0];
                document.getElementById('scoreValue').value = '';
                document.getElementById('scoreMemo').value = '';
                document.querySelector('#scoreModal .modal-title').textContent = 'ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ ì¶”ê°€';
            } else {
                showToast('ë‚ ì§œì™€ ì ìˆ˜ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
            }
        }
        
        // ì ìˆ˜ ì‚­ì œ
        function deleteScore(score) {
            showConfirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?', () => {
                // ì ìˆ˜ ê°ì²´ì˜ ì¸ë±ìŠ¤ë¥¼ ì°¾ì•„ì„œ ì‚­ì œ
                const index = studyData.mockScores.indexOf(score);
                if (index > -1) {
                    studyData.mockScores.splice(index, 1);
                    console.log('âœ… ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ ì‚­ì œë¨:', score.score);
                } else {
                    console.warn('âš ï¸ ì‚­ì œí•  ì ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                }
                saveData();
                renderMockScores();
                showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
            });
        }
        
        // ì ìˆ˜ ìˆ˜ì • - ëª¨ë‹¬ ì‚¬ìš©
        function editScore(score) {
            if (score) {
                editingScoreId = score.id;  // ìˆ˜ì •í•  ì ìˆ˜ ID ì €ì¥
                document.getElementById('scoreDate').value = score.date;
                document.getElementById('scoreValue').value = score.score;
                document.getElementById('scoreMemo').value = score.memo || '';
                document.querySelector('#scoreModal .modal-title').textContent = 'ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ ìˆ˜ì •';
                document.getElementById('scoreModal').classList.add('show');
            }
        }
        
        // ëª¨ë‹¬ ë‹«ê¸°
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');

            // í¸ì§‘ ìƒíƒœ ì´ˆê¸°í™”
            if (modalId === 'scoreModal') {
                editingScoreId = null;
            } else if (modalId === 'timeBlockModal') {
                editingBlockId = null;
            }
        }

        // í™•ì¸ ëª¨ë‹¬ í—¬í¼ (confirm ëŒ€ì²´)
        function showConfirm(message, onConfirm) {
            document.getElementById('confirmMessage').textContent = message;
            document.getElementById('confirmModal').classList.add('show');

            const confirmBtn = document.getElementById('confirmOkBtn');
            const newBtn = confirmBtn.cloneNode(true);
            confirmBtn.parentNode.replaceChild(newBtn, confirmBtn);

            newBtn.onclick = () => {
                closeModal('confirmModal');
                if (onConfirm) onConfirm();
            };
        }

        // ë©”ì‹œì§€ ëª¨ë‹¬ í—¬í¼ (alert ëŒ€ì²´ - HTML ì§€ì›)
        function showModalMessage(title, htmlContent) {
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">${title}</h3>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">âœ•</button>
                    </div>
                    <div class="modal-body">
                        ${htmlContent}
                    </div>
                    <div class="modal-footer">
                        <button class="modal-btn save" onclick="this.closest('.modal').remove()">í™•ì¸</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ë…¸íŠ¸ ê¸°ëŠ¥
        function saveNotes() {
            const notes = document.getElementById('study-notes').value;
            const today = new Date().toISOString().split('T')[0];
            
            if (!studyData.notes) studyData.notes = {};
            studyData.notes[today] = {
                content: notes,
                timestamp: new Date().toISOString()
            };
            
            saveData();
            showToast('ë…¸íŠ¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤ ğŸ“');
        }
        
        function loadTodayNotes() {
            const today = new Date().toISOString().split('T')[0];
            if (studyData.notes && studyData.notes[today]) {
                document.getElementById('study-notes').value = studyData.notes[today].content;
            }
        }
        
        function showPreviousNotes() {
            if (!studyData.notes) {
                showToast('ì €ì¥ëœ ë…¸íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            const dates = Object.keys(studyData.notes).sort().reverse();
            if (dates.length === 0) {
                showToast('ì €ì¥ëœ ë…¸íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            let notesList = '<h3 style="margin-bottom:15px">ğŸ“š ìµœê·¼ í•™ìŠµ ë…¸íŠ¸</h3>';
            dates.slice(0, 7).forEach(date => {
                const content = studyData.notes[date].content;
                notesList += `<div style="margin-bottom:15px;padding:10px;background:#f7fafc;border-radius:6px">
                    <strong>ğŸ“… ${date}</strong><br>
                    ${content.substring(0, 150)}...
                </div>`;
            });

            showModalMessage('ìµœê·¼ í•™ìŠµ ë…¸íŠ¸', notesList);
        }
        
        function exportNotes() {
            const dataStr = JSON.stringify(studyData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `study_data_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            showToast('ë°ì´í„°ê°€ ë‚´ë³´ë‚´ì¡ŒìŠµë‹ˆë‹¤ ğŸ’¾');
        }
        
        function addErrorNote() {
            document.getElementById('wrongSubject').value = '';
            document.getElementById('wrongQuestion').value = '';
            document.getElementById('wrongReason').value = '';
            document.getElementById('wrongNoteModal').classList.add('show');
        }

        function saveWrongNote() {
            const subject = document.getElementById('wrongSubject').value;
            const question = document.getElementById('wrongQuestion').value;
            const reason = document.getElementById('wrongReason').value;

            if (subject && question && reason) {
                const errorNote = `\n\n[ì˜¤ë‹µë…¸íŠ¸]\nê³¼ëª©: ${subject}\në¬¸ì œ: ${question}\nì´ìœ : ${reason}\n`;
                document.getElementById('study-notes').value += errorNote;
                closeModal('wrongNoteModal');
                showToast('ì˜¤ë‹µë…¸íŠ¸ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');
            } else {
                showToast('ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
            }
        }
        
        function clearNotes() {
            showConfirm('ì˜¤ëŠ˜ ë…¸íŠ¸ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?', () => {
                document.getElementById('study-notes').value = '';
                showToast('ë…¸íŠ¸ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
            });
        }

        // ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”
        function clearAllData() {
            showConfirm('ì •ë§ë¡œ ëª¨ë“  í•™ìŠµ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', () => {
                localStorage.removeItem('studyData');
                localStorage.removeItem('theme');
                sessionStorage.clear();
                showToast('ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤.', 'warning');
                setTimeout(() => {
                    location.reload();
                }, 1500);
            });
        }

        // ë™ê¸°ë¶€ì—¬ ë¬¸êµ¬ ë¡œí…Œì´ì…˜
        function rotateMotivation() {
            const quotes = [
                "í¬ê¸°í•˜ì§€ ì•Šìœ¼ë©´ ë°˜ë“œì‹œ í•©ê²©í•œë‹¤. ì‹œí—˜ì€ ëê¹Œì§€ ë²„í‹°ëŠ” ê²ƒì…ë‹ˆë‹¤.",
                "ë¨¸ë¦¬ë³´ë‹¤ ì¤‘ìš”í•œ ê²ƒì€ ì—‰ë©ì´ë¥¼ ì˜¤ë˜ ë¶™ì´ê³  ìˆì„ ìˆ˜ ìˆëŠ” ê²ƒ.",
                "ì§ì¥ë³‘í–‰ì´ë¼ë„ ë§¤ì¼ ê¾¸ì¤€íˆ í•˜ë©´ í•©ê²©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                "ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ê°€ ë‚®ì•„ë„ í¬ê¸°í•˜ì§€ ë§ˆì„¸ìš”. ëê¹Œì§€ ê°€ë©´ ë©ë‹ˆë‹¤.",
                "ê¸°ì¶œë¬¸ì œë¥¼ ì™„ì „íˆ ë‚´ ê²ƒìœ¼ë¡œ ë§Œë“œëŠ” ê²ƒì´ í•©ê²©ì˜ ì§€ë¦„ê¸¸ì…ë‹ˆë‹¤.",
                "ì˜¤ëŠ˜ ëª»í•œ ê³µë¶€ëŠ” ë‚´ì¼ ë‘ ë°°ê°€ ë©ë‹ˆë‹¤. ì˜¤ëŠ˜ í•  ì¼ì€ ì˜¤ëŠ˜!",
                "1ë…„ ë°˜ì˜ ë…¸ë ¥ì´ í‰ìƒì˜ ìê²©ì¦ì´ ë©ë‹ˆë‹¤.",
                "ì‹œí—˜ì€ ì˜ ëª¨ë¥´ëŠ” ìƒíƒœì—ì„œ ë¶™ëŠ” ê±°ë‹¤.",
                "ë‚¨ë“¤ë„ ì–´ë µìŠµë‹ˆë‹¤. ë‚˜ë§Œ ì–´ë ¤ìš´ ê²ƒì´ ì•„ë‹™ë‹ˆë‹¤.",
                "ë²„í‹°ë©´ í•©ê²©í•œë‹¤. ëê¹Œì§€ ë²„í‹°ëŠ” ê²ƒì…ë‹ˆë‹¤."
            ];
            
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            document.getElementById('motivation-quote').textContent = randomQuote;
        }
        
        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ (íƒ€ì… ì§€ì›: success, error, warning, info)
        function showToast(message, type = 'success') {
            const existing = document.querySelector('.toast');
            if (existing) existing.remove();

            const toast = document.createElement('div');
            toast.className = `toast ${type}`;

            const icons = {
                success: 'âœ“',
                error: 'âœ•',
                warning: 'âš ',
                info: 'â„¹'
            };

            toast.innerHTML = `
                <span class="toast-icon">${icons[type] || icons.success}</span>
                <span class="toast-message">${message}</span>
            `;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideOutToast 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
        
        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', function(e) {
            // ESC í‚¤ë¡œ ëª¨ë“  ëª¨ë‹¬ ë‹«ê¸°
            if (e.key === 'Escape') {
                const openModals = document.querySelectorAll('.modal.show');
                openModals.forEach(modal => {
                    if (modal.id) {
                        closeModal(modal.id);
                    } else {
                        modal.remove(); // ë™ì  ìƒì„±ëœ ëª¨ë‹¬
                    }
                });
                return;
            }

            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        saveNotes();
                        break;
                    case ' ':
                        e.preventDefault();
                        if (studyData.timer.isRunning) pauseTimer();
                        else startTimer();
                        break;
                }
            }
        });
        
        // í˜ì´ì§€ ì¢…ë£Œ ì‹œ ìë™ ì €ì¥
        window.addEventListener('beforeunload', function() {
            saveData();
            if (document.getElementById('study-notes').value) {
                saveNotes();
            }
        });
        
        // 5ë¶„ë§ˆë‹¤ ë™ê¸°ë¶€ì—¬ ë¬¸êµ¬ ë³€ê²½
        setInterval(rotateMotivation, 300000);

        // ===== ìƒˆë¡œìš´ ê¸°ëŠ¥: ìŠ¤íŠ¸ë¦­ íŠ¸ë˜ì»¤ =====
        function updateStreak() {
            const today = new Date().toISOString().split('T')[0];
            const lastStudy = studyData.streak.lastStudyDate;

            // ì´ˆê¸°í™”
            if (!studyData.streak) {
                studyData.streak = { current: 0, longest: 0, lastStudyDate: null, totalDays: 0 };
            }

            // ì˜¤ëŠ˜ í•™ìŠµ ê¸°ë¡ì´ ìˆëŠ”ì§€ í™•ì¸ (íƒ€ì´ë¨¸ ì‹œê°„ or ì™„ë£Œëœ íƒ€ì„ë¸”ë¡ from TODAY)
            const todayCompletedBlocks = studyData.timeBlocks.filter(b => b.date === today && b.completed);
            const hasStudiedToday = studyData.timer.seconds > 0 ||
                                   todayCompletedBlocks.length > 0;

            if (hasStudiedToday && lastStudy !== today) {
                if (lastStudy) {
                    const lastDate = new Date(lastStudy);
                    const todayDate = new Date(today);
                    const diffDays = Math.floor((todayDate - lastDate) / (1000 * 60 * 60 * 24));

                    if (diffDays === 1) {
                        // ì—°ì† í•™ìŠµ
                        studyData.streak.current++;
                    } else if (diffDays > 1) {
                        // ìŠ¤íŠ¸ë¦­ ëŠê¹€
                        studyData.streak.current = 1;
                    }
                } else {
                    // ì²« í•™ìŠµ
                    studyData.streak.current = 1;
                }

                studyData.streak.lastStudyDate = today;
                studyData.streak.totalDays++;

                // ìµœì¥ ê¸°ë¡ ê°±ì‹ 
                if (studyData.streak.current > studyData.streak.longest) {
                    studyData.streak.longest = studyData.streak.current;
                }

                saveData();
            }

            // UI ì—…ë°ì´íŠ¸
            document.getElementById('current-streak').textContent = studyData.streak.current || 0;
            document.getElementById('longest-streak').textContent = studyData.streak.longest || 0;
            document.getElementById('total-study-days').textContent = studyData.streak.totalDays || 0;

            // ìŠ¤íŠ¸ë¦­ ì§„í–‰ ë°” ì—…ë°ì´íŠ¸ (ìµœì¥ ê¸°ë¡ ê¸°ì¤€)
            const longestStreak = studyData.streak.longest || 1;
            const progressPercent = Math.min((studyData.streak.current / longestStreak) * 100, 100);
            const progressBar = document.getElementById('streak-progress-bar');
            if (progressBar) {
                progressBar.style.width = progressPercent + '%';
            }

            // ë§ˆì§€ë§‰ í•™ìŠµ ë‚ ì§œ í‘œì‹œ
            const lastStudyEl = document.getElementById('last-study-date');
            if (lastStudyEl && studyData.streak.lastStudyDate) {
                const lastDate = new Date(studyData.streak.lastStudyDate);
                const today = new Date();
                const daysDiff = Math.floor((today - lastDate) / (1000 * 60 * 60 * 24));

                if (daysDiff === 0) {
                    lastStudyEl.textContent = 'ì˜¤ëŠ˜ ğŸ¯';
                    lastStudyEl.style.color = '#FF6B6B';
                } else if (daysDiff === 1) {
                    lastStudyEl.textContent = 'ì–´ì œ ğŸ“…';
                    lastStudyEl.style.color = 'var(--text-secondary)';
                } else {
                    lastStudyEl.textContent = daysDiff + 'ì¼ ì „ â°';
                    lastStudyEl.style.color = 'var(--text-secondary)';
                }
            }

            // ìŠ¤íŠ¸ë¦­ ìƒíƒœ í‘œì‹œ
            const streakStatus = document.getElementById('streak-status');
            if (streakStatus) {
                const lastDate = studyData.streak.lastStudyDate ? new Date(studyData.streak.lastStudyDate) : null;
                const today = new Date().toISOString().split('T')[0];
                const lastStudyToday = lastDate && lastDate.toISOString().split('T')[0] === today;

                if (lastStudyToday) {
                    streakStatus.innerHTML = 'âœ… ì˜¤ëŠ˜ í•™ìŠµ ì™„ë£Œ!';
                    streakStatus.style.background = 'rgba(52, 211, 153, 0.2)';
                    streakStatus.style.color = '#34D399';
                } else if (studyData.streak.current > 0) {
                    streakStatus.innerHTML = 'ğŸ”¥ ' + studyData.streak.current + 'ì¼ ì—°ì† ì§„í–‰ ì¤‘';
                    streakStatus.style.background = 'rgba(255, 107, 107, 0.2)';
                    streakStatus.style.color = '#FF6B6B';
                } else {
                    streakStatus.innerHTML = 'ğŸŒ± ìŠ¤íŠ¸ë¦­ ì‹œì‘í•˜ê¸°';
                    streakStatus.style.background = 'rgba(100, 200, 255, 0.2)';
                    streakStatus.style.color = '#64C8FF';
                }
            }
        }

        function resetStreak() {
            showConfirm('ìŠ¤íŠ¸ë¦­ ê¸°ë¡ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?', () => {
                studyData.streak = { current: 0, longest: 0, lastStudyDate: null, totalDays: 0 };
                saveData();
                updateStreak();
                showToast('ìŠ¤íŠ¸ë¦­ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
            });
        }

        // ===== ìƒˆë¡œìš´ ê¸°ëŠ¥: í•™ìŠµ ë¶„ì„ ëŒ€ì‹œë³´ë“œ =====
                function renderAnalytics() {
            try {
                // Calculate REAL total study hours from single source of truth
                let totalHours = 0;

                // Use ONLY completed time blocks as single source of truth
                studyData.timeBlocks.forEach(block => {
                    if (block.completed) {
                        totalHours += block.hours || 0;
                    }
                });

                // Calculate actual study days from history (use correct date field, not time)
                const uniqueStudyDays = new Set();
                studyData.timeBlocks.forEach(block => {
                    if (block.completed && block.date) {
                        uniqueStudyDays.add(block.date);
                    }
                });

                if (studyData.studyHistory && studyData.studyHistory.length > 0) {
                    studyData.studyHistory.forEach(day => {
                        uniqueStudyDays.add(day.date);
                    });
                }

                const actualStudyDays = Math.max(uniqueStudyDays.size, studyData.streak.totalDays || 1, 1);
                const avgHours = totalHours / actualStudyDays;

                // Calculate overall progress from BOTH 1st and 2nd exam subjects
                let totalCompleted = 0;
                let totalProblems = 0;

                studyData.subjects.forEach(s => {
                    totalCompleted += s.completed;
                    totalProblems += s.total;
                });

                const overallProgress = totalProblems > 0 ? Math.round((totalCompleted / totalProblems) * 100) : 0;

                // Calculate mock exam average from REAL user data
                let avgScore = 0;
                if (studyData.mockScores && studyData.mockScores.length > 0) {
                    avgScore = studyData.mockScores.reduce((sum, s) => sum + s.score, 0) / studyData.mockScores.length;
                }

                // Render enhanced charts with real data
                renderSubjectTimeChart();
                renderMockScoreChart();

                // Render learning curve analysis and metacognitive feedback
                renderLearningCurveAnalysis(totalCompleted, totalProblems, totalHours, actualStudyDays);
                renderMetacognitiveFeedback(overallProgress, totalCompleted, totalProblems, totalHours, actualStudyDays);

                // Render v3.0.7+ new features
                // Achievement badges removed in v3.3.0

                console.log('âœ… renderAnalytics ì™„ë£Œ');
            } catch (error) {
                console.error('âŒ renderAnalytics ì—ëŸ¬:', error);
                console.error('Stack:', error.stack);
            }
        }

        function updateBenchmarkProgress(totalHours, avgHours, overallProgress, avgScore) {
            // Total study hours benchmark: 800-1200h (use 1000 as target)
            const totalHoursPercent = Math.min((totalHours / 1000) * 100, 100);
            const totalHoursBar = document.getElementById('total-hours-progress');
            if (totalHoursBar) {
                totalHoursBar.style.width = totalHoursPercent + '%';
                // Color coding
                if (totalHoursPercent >= 80) {
                    totalHoursBar.style.background = 'linear-gradient(90deg, var(--success-color), #34D399)';
                } else if (totalHoursPercent >= 50) {
                    totalHoursBar.style.background = 'linear-gradient(90deg, var(--accent-color), var(--success-color))';
                } else {
                    totalHoursBar.style.background = 'linear-gradient(90deg, var(--warning-color), var(--accent-color))';
                }
            }

            // Daily average benchmark: 4-5h (use 4.5 as target)
            const dailyHoursPercent = Math.min((avgHours / 4.5) * 100, 100);
            const dailyHoursBar = document.getElementById('daily-hours-progress');
            if (dailyHoursBar) {
                dailyHoursBar.style.width = dailyHoursPercent + '%';
                if (dailyHoursPercent >= 90) {
                    dailyHoursBar.style.background = 'linear-gradient(90deg, var(--success-color), #34D399)';
                } else if (dailyHoursPercent >= 60) {
                    dailyHoursBar.style.background = 'linear-gradient(90deg, var(--accent-color), var(--success-color))';
                } else {
                    dailyHoursBar.style.background = 'linear-gradient(90deg, var(--warning-color), var(--accent-color))';
                }
            }

            // Overall progress benchmark: 100%
            const progressBar = document.getElementById('progress-bar');
            if (progressBar) {
                progressBar.style.width = overallProgress + '%';
                if (overallProgress >= 90) {
                    progressBar.style.background = 'linear-gradient(90deg, var(--success-color), #34D399)';
                } else if (overallProgress >= 50) {
                    progressBar.style.background = 'linear-gradient(90deg, var(--accent-color), var(--success-color))';
                } else {
                    progressBar.style.background = 'linear-gradient(90deg, var(--warning-color), var(--accent-color))';
                }
            }

            // Mock score benchmark: 60 points (passing grade)
            const mockScorePercent = avgScore > 0 ? Math.min((avgScore / 100) * 100, 100) : 0;
            const mockScoreBar = document.getElementById('mock-score-progress');
            if (mockScoreBar) {
                mockScoreBar.style.width = mockScorePercent + '%';
                if (avgScore >= 60) {
                    mockScoreBar.style.background = 'linear-gradient(90deg, var(--success-color), #34D399)';
                } else if (avgScore >= 40) {
                    mockScoreBar.style.background = 'linear-gradient(90deg, var(--accent-color), var(--success-color))';
                } else if (avgScore > 0) {
                    mockScoreBar.style.background = 'linear-gradient(90deg, var(--danger-color), var(--warning-color))';
                }
            }
        }

        /**
         * í•™ìŠµ ê³¡ì„  ë¶„ì„ í•¨ìˆ˜
         * - í˜„ì¬ í•™ìŠµ ì†ë„ ê¸°ë°˜ ì˜ˆìƒ ì™„ë£Œì¼ ê³„ì‚°
         * - ë‚¨ì€ í•™ìŠµì¼ ìˆ˜ ë° í•™ìŠµ ì†ë„ í‘œì‹œ
         */
        function renderLearningCurveAnalysis(totalCompleted, totalProblems, totalHours, actualStudyDays) {
            try {
                // Check if required elements exist (they are in deleted analytics section)
                const completionDateDisplay = document.getElementById('completion-date-display');
                const daysRemainingDisplay = document.getElementById('days-remaining-display');
                const learningPaceDisplay = document.getElementById('learning-pace-display');

                // If elements don't exist, skip this function (analytics section was deleted)
                if (!completionDateDisplay || !daysRemainingDisplay || !learningPaceDisplay) {
                    return;
                }

                if (totalProblems === 0) {
                    completionDateDisplay.textContent = 'ê³¼ëª© ì„¤ì • í•„ìš”';
                    daysRemainingDisplay.textContent = 'ë‚¨ì€ í•™ìŠµì¼: - ì¼';
                    learningPaceDisplay.textContent = 'í•™ìŠµ ì†ë„: - ë¬¸ì œ/ì¼';
                    return;
                }

                // ì•ˆì „ì„± ê²€ì‚¬: actualStudyDaysê°€ ì—†ê±°ë‚˜ 0ì´ë©´ ê¸°ë³¸ê°’ ì„¤ì •
                let safeDays = Math.max(actualStudyDays || 1, 1);

                // 1. í˜„ì¬ í•™ìŠµ ì†ë„ ê³„ì‚° (ë¬¸ì œ/ì¼)
                const completedProblems = totalCompleted || 0;
                const remainingProblems = Math.max(totalProblems - completedProblems, 0);
                const learningPace = completedProblems > 0 ? completedProblems / safeDays : 0;

                // 2. ì˜ˆìƒ ì™„ë£Œì¼ ê³„ì‚°
                let daysToCompletion = 0;
                if (learningPace > 0 && remainingProblems > 0) {
                    daysToCompletion = Math.ceil(remainingProblems / learningPace);
                } else if (remainingProblems === 0) {
                    daysToCompletion = 0; // ì™„ë£Œë¨
                } else {
                    daysToCompletion = 999; // ì•„ì§ í•™ìŠµí•˜ì§€ ì•Šì€ ê²½ìš°
                }

                // 3. ì˜ˆìƒ ì™„ë£Œ ë‚ ì§œ ê³„ì‚°
                const today = new Date();
                const completionDate = new Date(today.getTime() + daysToCompletion * 24 * 60 * 60 * 1000);

                // í•œêµ­ ë‚ ì§œ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
                const completionDateStr = daysToCompletion === 0
                    ? 'ğŸ‰ ì™„ë£Œ!'
                    : completionDate.toLocaleDateString('ko-KR', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });

                // ë‚¨ì€ ì¼ìˆ˜ í‘œì‹œ (ì•ˆì „í•˜ê²Œ ì²˜ë¦¬)
                const daysText = daysToCompletion === 0
                    ? 'ì™„ë£Œ!'
                    : daysToCompletion === 999
                    ? 'ê³„ì‚° ì¤‘'
                    : `${daysToCompletion}`;

                const paceText = learningPace > 0
                    ? `${Math.round(learningPace)}`
                    : '-';

                // 4. UI ì—…ë°ì´íŠ¸
                completionDateDisplay.textContent = completionDateStr;
                daysRemainingDisplay.textContent = `ë‚¨ì€ í•™ìŠµì¼: ${daysText} ì¼`;
                learningPaceDisplay.textContent = `í•™ìŠµ ì†ë„: ${paceText} ë¬¸ì œ/ì¼`;

                console.log(`âœ… í•™ìŠµ ê³¡ì„  ë¶„ì„:
                    - ì™„ë£Œëœ ë¬¸ì œ: ${completedProblems}/${totalProblems} (${Math.round((completedProblems/totalProblems)*100)}%)
                    - ë‚¨ì€ ë¬¸ì œ: ${remainingProblems}
                    - í•™ìŠµ ì†ë„: ${learningPace.toFixed(1)} ë¬¸ì œ/ì¼
                    - ë‚¨ì€ ì¼ìˆ˜: ${daysToCompletion} ì¼
                    - ì˜ˆìƒ ì™„ë£Œì¼: ${completionDateStr}`);
            } catch (error) {
                console.error('âŒ renderLearningCurveAnalysis ì—ëŸ¬:', error);
                document.getElementById('completion-date-display').textContent = 'ê³„ì‚° ì˜¤ë¥˜';
            }
        }

        /**
         * ë©”íƒ€ì¸ì§€ í”¼ë“œë°± í•¨ìˆ˜
         * - í˜„ì¬ ì§„í–‰ë„ë¥¼ í•´ì„ì ìœ¼ë¡œ ì„¤ëª…
         * - í•™ìŠµ íš¨ìœ¨ì„± ê¸°ë°˜ ë§ì¶¤í˜• í”¼ë“œë°± ì œê³µ
         * - ë™ê¸°ë¶€ì—¬ ë©”ì‹œì§€ í‘œì‹œ
         */
        function renderMetacognitiveFeedback(overallProgress, totalCompleted, totalProblems, totalHours, actualStudyDays) {
            try {
                // Check if required elements exist (they are in deleted analytics section)
                const feedbackElement = document.getElementById('metacognitive-feedback');
                const motivationElement = document.getElementById('motivation-message');

                // If elements don't exist, skip this function (analytics section was deleted)
                if (!feedbackElement || !motivationElement) {
                    return;
                }

                if (totalProblems === 0) {
                    feedbackElement.textContent = 'ê³¼ëª©ì„ ì¶”ê°€í•˜ì—¬ í•™ìŠµì„ ì‹œì‘í•˜ì„¸ìš”!';
                    motivationElement.textContent = 'ğŸš€ ìƒˆë¡œìš´ ì—¬ì •ì„ ì‹œì‘í•´ë´…ì‹œë‹¤!';
                    return;
                }

                // 1. íš¨ìœ¨ì„± ì§€ìˆ˜ ê³„ì‚° (í•™ìŠµëŸ‰ ëŒ€ë¹„ ì„±ê³¼)
                const completionRate = (totalCompleted / totalProblems) * 100;
                const hoursPerProblem = totalHours > 0 ? totalHours / totalCompleted : 0;
                const problemsPerDay = totalCompleted > 0 ? totalCompleted / actualStudyDays : 0;

                // 2. í•™ìŠµ ì§„í–‰ë„ í‰ê°€
                let progressMessage = '';
                let motivationEmoji = '';
                let motivationMessage = '';

                if (overallProgress >= 90) {
                    progressMessage = `ğŸŒŸ ë†€ë¼ìš´ ì§„í–‰ì´ì—ìš”! ì´ë¯¸ ${overallProgress}%ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ë§ˆì§€ë§‰ ìŠ¤í¼íŠ¸ë¥¼ ì´ê²¨ë‚¼ ì¤€ë¹„ê°€ ë˜ì…¨ë‚˜ìš”?`;
                    motivationEmoji = 'ğŸ†';
                    motivationMessage = 'ê±°ì˜ ë‹¤ ì™”ì–´ìš”! ì´ëŒ€ë¡œë§Œ ê³„ì†í•˜ë©´ í™•ì‹¤íˆ ì„±ê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!';
                } else if (overallProgress >= 70) {
                    progressMessage = `ğŸ‘ ì •ë§ ì˜í•˜ê³  ê³„ì„¸ìš”! ${overallProgress}%ê¹Œì§€ ì˜¤ì…¨ìŠµë‹ˆë‹¤. ì´ ì†ë„ë©´ ì¶©ë¶„íˆ ì™„ì„±í•  ìˆ˜ ìˆì–´ìš”.`;
                    motivationEmoji = 'ğŸ’ª';
                    motivationMessage = 'ì—­ì‹œ ì‹¤ë ¥ì´ ëŠê»´ì ¸ìš”! ì¡°ê¸ˆë§Œ ë” í˜ë‚´ì„¸ìš”.';
                } else if (overallProgress >= 50) {
                    progressMessage = `âœ¨ ì¤‘ê°„ ì§€ì ì„ ë„˜ìœ¼ì…¨ì–´ìš”! í˜„ì¬ ${overallProgress}% ì™„ë£Œ. ì§€ê¸ˆê¹Œì§€ì˜ ë…¸ë ¥ì´ ì •ë§ í›Œë¥­í•©ë‹ˆë‹¤!`;
                    motivationEmoji = 'âš¡';
                    motivationMessage = 'ì¢‹ì€ í˜ì´ìŠ¤ë¥¼ ìœ ì§€í•˜ê³  ìˆì–´ìš”. ê³„ì† í™”ì´íŒ…í•˜ì„¸ìš”!';
                } else if (overallProgress >= 30) {
                    progressMessage = `ğŸ“ˆ ì¢‹ì€ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤! ${overallProgress}%ë¥¼ ë‹¬ì„±í–ˆì–´ìš”. ì´ëŒ€ë¡œ ê³„ì†í•˜ë©´ ëª©í‘œì— ë„ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`;
                    motivationEmoji = 'ğŸ¯';
                    motivationMessage = 'ê¸°ì´ˆë¥¼ íƒ„íƒ„íˆ ë‹¤ì§€ëŠ” ì¤‘ì´êµ°ìš”. ê³„ì† ì§„í–‰í•˜ì„¸ìš”!';
                } else {
                    progressMessage = `ğŸŒ± ì‹œì‘ì´ ë°˜ì´ë¼ê³  í–ˆì–ì•„ìš”! ${overallProgress}%ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. ì´ ë°œê±¸ìŒì´ ê°€ì¥ ì†Œì¤‘í•œ ìˆœê°„ì…ë‹ˆë‹¤.`;
                    motivationEmoji = 'ğŸ”¥';
                    motivationMessage = 'ì§€ê¸ˆì´ ê°€ì¥ ì¤‘ìš”í•œ ìˆœê°„ì…ë‹ˆë‹¤. ê³„ì† ì§„í–‰í•˜ì„¸ìš”!';
                }

                // 3. í•™ìŠµ íš¨ìœ¨ì„± í”¼ë“œë°±
                let efficiencyFeedback = '';
                if (hoursPerProblem > 0) {
                    if (hoursPerProblem < 0.3) {
                        efficiencyFeedback = ` íš¨ìœ¨ì„±ì´ ìš°ìˆ˜í•´ìš”! (í‰ê·  ${hoursPerProblem.toFixed(2)}ì‹œê°„/ë¬¸ì œ)`;
                    } else if (hoursPerProblem < 0.5) {
                        efficiencyFeedback = ` í•™ìŠµ ì†ë„ê°€ ì¢‹ìŠµë‹ˆë‹¤! (í‰ê·  ${hoursPerProblem.toFixed(2)}ì‹œê°„/ë¬¸ì œ)`;
                    } else {
                        efficiencyFeedback = ` ê¹Šì´ ìˆëŠ” í•™ìŠµì„ í•˜ê³  ê³„ì„¸ìš”. (í‰ê·  ${hoursPerProblem.toFixed(2)}ì‹œê°„/ë¬¸ì œ)`;
                    }
                }

                // 4. í•™ìŠµ ì¼ìˆ˜ ê¸°ë°˜ í”¼ë“œë°±
                const consistencyFeedback = actualStudyDays >= 7
                    ? ` ê¾¸ì¤€íˆ ${actualStudyDays}ì¼ ë™ì•ˆ í•™ìŠµ ì¤‘ì´ì—ìš”!`
                    : ` ì‹œì‘í•œ ì§€ ${actualStudyDays}ì¼ì…ë‹ˆë‹¤. ê¾¸ì¤€í•¨ì´ ê°€ì¥ ì¤‘ìš”í•´ìš”!`;

                // 5. ìµœì¢… í”¼ë“œë°± ë©”ì‹œì§€
                const finalFeedback = progressMessage + efficiencyFeedback + consistencyFeedback;

                // 6. ë™ê¸°ë¶€ì—¬ ë©”ì‹œì§€
                const motivationText = `${motivationEmoji} ${motivationMessage}`;

                // 7. UI ì—…ë°ì´íŠ¸
                feedbackElement.textContent = finalFeedback;
                motivationElement.textContent = motivationText;

                console.log(`âœ… ë©”íƒ€ì¸ì§€ í”¼ë“œë°± ìƒì„±:
                    - ì§„í–‰ë„: ${overallProgress}%
                    - íš¨ìœ¨ì„±: ${hoursPerProblem.toFixed(2)}ì‹œê°„/ë¬¸ì œ
                    - í•™ìŠµì¼ìˆ˜: ${actualStudyDays}ì¼
                    - ì¼ì¼ì†ë„: ${problemsPerDay.toFixed(1)}ë¬¸ì œ/ì¼`);
            } catch (error) {
                console.error('âŒ renderMetacognitiveFeedback ì—ëŸ¬:', error);
                if (feedbackElement) {
                    feedbackElement.textContent = 'í”¼ë“œë°±ì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                }
            }
        }

        /**
         * ëŒ€ì‹œë³´ë“œ ë¶„ì„: íš¨ìœ¨ì„± ì§€ìˆ˜ & ì£¼ê°„ í•™ìŠµì¼
         */
        function renderDashboardAnalytics(totalHours, overallProgress, actualStudyDays) {
            try {
                // 1. í•™ìŠµ íš¨ìœ¨ì„± ì§€ìˆ˜ (0-100)
                const hoursTarget = 1000; // ëª©í‘œ ì‹œê°„
                const progressTarget = 100; // ëª©í‘œ ì§„ë„
                const efficiencyScore = Math.round(((totalHours / hoursTarget) * 60 + (overallProgress / progressTarget) * 40));

                const efficiencyElement = document.getElementById('efficiency-score');
                if (efficiencyElement) {
                    efficiencyElement.textContent = Math.min(efficiencyScore, 100);
                    const effBar = document.getElementById('efficiency-progress');
                    if (effBar) {
                        effBar.style.width = Math.min(efficiencyScore, 100) + '%';
                        if (efficiencyScore >= 80) {
                            effBar.style.background = 'linear-gradient(90deg, var(--success-color), #34D399)';
                        } else if (efficiencyScore >= 50) {
                            effBar.style.background = 'linear-gradient(90deg, var(--accent-color), var(--success-color))';
                        } else {
                            effBar.style.background = 'linear-gradient(90deg, var(--warning-color), var(--accent-color))';
                        }
                    }
                }

                // 2. ì£¼ê°„ í•™ìŠµì¼ ê³„ì‚°
                const today = new Date();
                const weekStart = new Date(today.setDate(today.getDate() - today.getDay()));
                let weeklyStudyDays = 0;

                studyData.timeBlocks.forEach(block => {
                    if (block.completed && block.date) {
                        const blockDate = new Date(block.date);
                        if (blockDate >= weekStart) {
                            weeklyStudyDays = Math.max(weeklyStudyDays, blockDate.getDay() + 1);
                        }
                    }
                });

                const weeklyElement = document.getElementById('weekly-study-days');
                if (weeklyElement) {
                    weeklyElement.textContent = Math.min(weeklyStudyDays, 7);
                    const weekBar = document.getElementById('weekly-days-progress');
                    if (weekBar) {
                        weekBar.style.width = Math.min((weeklyStudyDays / 7) * 100, 100) + '%';
                        if (weeklyStudyDays >= 7) {
                            weekBar.style.background = 'linear-gradient(90deg, var(--success-color), #34D399)';
                        } else if (weeklyStudyDays >= 4) {
                            weekBar.style.background = 'linear-gradient(90deg, var(--accent-color), var(--success-color))';
                        } else {
                            weekBar.style.background = 'linear-gradient(90deg, var(--warning-color), var(--accent-color))';
                        }
                    }
                }
            } catch (error) {
                console.error('âŒ renderDashboardAnalytics ì—ëŸ¬:', error);
            }
        }

        /**
         * ì·¨ì•½ ê³¼ëª© ë¶„ì„ (ì§„ë„ìœ¨ 50% ë¯¸ë§Œ)
         */
        function renderWeakSubjectsAnalysis() {
            try {
                const weakSubjects = studyData.subjects.filter(s => {
                    const progress = (s.completed / s.total) * 100;
                    return progress < 50;
                }).sort((a, b) => {
                    const progressA = (a.completed / a.total) * 100;
                    const progressB = (b.completed / b.total) * 100;
                    return progressA - progressB;
                });

                const countElement = document.getElementById('weak-subjects-count');
                const listElement = document.getElementById('weak-subjects-list');

                if (countElement) {
                    countElement.textContent = weakSubjects.length;
                }

                if (listElement) {
                    if (weakSubjects.length === 0) {
                        listElement.textContent = 'ğŸ‰ ëª¨ë“  ê³¼ëª©ì˜ ì§„ë„ê°€ 50% ì´ìƒì…ë‹ˆë‹¤!';
                        listElement.style.color = 'var(--success-color)';
                    } else {
                        const subjectList = weakSubjects.map(s => {
                            const progress = Math.round((s.completed / s.total) * 100);
                            return `${s.name} (${progress}%)`;
                        }).join(', ');
                        listElement.textContent = subjectList;
                    }
                }
            } catch (error) {
                console.error('âŒ renderWeakSubjectsAnalysis ì—ëŸ¬:', error);
            }
        }

        /**
         * ê°•ì  ê³¼ëª© ë¶„ì„ (ì§„ë„ìœ¨ 80% ì´ìƒ)
         */
        function renderStrongSubjectsAnalysis() {
            try {
                const strongSubjects = studyData.subjects.filter(s => {
                    const progress = (s.completed / s.total) * 100;
                    return progress >= 80;
                }).sort((a, b) => {
                    const progressA = (a.completed / a.total) * 100;
                    const progressB = (b.completed / b.total) * 100;
                    return progressB - progressA;
                });

                const countElement = document.getElementById('strong-subjects-count');
                const listElement = document.getElementById('strong-subjects-list');

                if (countElement) {
                    countElement.textContent = strongSubjects.length;
                }

                if (listElement) {
                    if (strongSubjects.length === 0) {
                        listElement.textContent = 'ğŸ’ª ê³§ 80% ì´ìƒ ë„ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!';
                        listElement.style.color = 'var(--text-secondary)';
                    } else {
                        const subjectList = strongSubjects.map(s => {
                            const progress = Math.round((s.completed / s.total) * 100);
                            return `${s.name} (${progress}%)`;
                        }).join(', ');
                        listElement.textContent = subjectList;
                    }
                }
            } catch (error) {
                console.error('âŒ renderStrongSubjectsAnalysis ì—ëŸ¬:', error);
            }
        }

        /**
         * v3.0.7 - í•µì‹¬ ë©”íŠ¸ë¦­ ë Œë”ë§
         * ëŒ€ì‹œë³´ë“œ ìƒë‹¨ì— 3ê°œ í•µì‹¬ ì§€í‘œë§Œ í‘œì‹œ
         */
        function renderCoreMetrics(overallProgress, totalCompleted, totalProblems, totalHours, actualStudyDays) {
            try {
                // 1. ì „ì²´ ì§„ë„ìœ¨
                const coreProgressEl = document.getElementById('core-progress');
                const coreProgressFill = document.getElementById('core-progress-fill');
                if (coreProgressEl && coreProgressFill) {
                    coreProgressEl.textContent = overallProgress + '%';
                    coreProgressFill.style.width = overallProgress + '%';
                }

                // 2. ì˜ˆìƒ ì™„ë£Œì¼ & D-day
                const safeDays = Math.max(actualStudyDays || 1, 1);
                const completedProblems = totalCompleted || 0;
                const remainingProblems = Math.max(totalProblems - completedProblems, 0);
                const learningPace = completedProblems > 0 ? completedProblems / safeDays : 0;

                let daysToCompletion = 0;
                if (learningPace > 0 && remainingProblems > 0) {
                    daysToCompletion = Math.ceil(remainingProblems / learningPace);
                } else if (remainingProblems === 0) {
                    daysToCompletion = 0;
                } else {
                    daysToCompletion = 999;
                }

                const today = new Date();
                const completionDate = new Date(today.getTime() + daysToCompletion * 24 * 60 * 60 * 1000);

                const coreDateEl = document.getElementById('core-completion-date');
                const coreDdayEl = document.getElementById('core-dday');
                if (coreDateEl && coreDdayEl) {
                    if (daysToCompletion === 0) {
                        coreDateEl.textContent = 'ì™„ë£Œ!';
                        coreDdayEl.textContent = 'ì¶•í•˜í•©ë‹ˆë‹¤! ğŸ‰';
                    } else if (daysToCompletion === 999) {
                        coreDateEl.textContent = 'ê³„ì‚° ì¤‘...';
                        coreDdayEl.textContent = 'í•™ìŠµ ë°ì´í„° ë¶€ì¡±';
                    } else {
                        const dateStr = completionDate.toLocaleDateString('ko-KR', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric'
                        });
                        coreDateEl.textContent = dateStr;
                        coreDdayEl.textContent = `D-${daysToCompletion}`;
                    }
                }

                // 3. í•™ìŠµ íš¨ìœ¨ì„± ì§€ìˆ˜
                const hoursTarget = 1000;
                const progressTarget = 100;
                const efficiencyScore = Math.round(((totalHours / hoursTarget) * 60 + (overallProgress / progressTarget) * 40));

                const coreEffEl = document.getElementById('core-efficiency');
                if (coreEffEl) {
                    coreEffEl.textContent = Math.min(efficiencyScore, 100);
                }

                console.log('âœ… í•µì‹¬ ë©”íŠ¸ë¦­ ë Œë”ë§ ì™„ë£Œ:', {
                    progress: overallProgress,
                    daysToCompletion,
                    efficiency: efficiencyScore
                });
            } catch (error) {
                console.error('âŒ renderCoreMetrics ì—ëŸ¬:', error);
            }
        }

        /**
         * v3.0.7 - ì˜¤ëŠ˜ì˜ í•™ìŠµ ëª©í‘œ (AI ì¶”ì²œ)
         * ì§„ë„ìœ¨ ê¸°ë°˜ìœ¼ë¡œ ìš°ì„ ìˆœìœ„ ê³¼ëª© 3ê°œ ì¶”ì²œ
         */
        function renderTodayGoals() {
            try {
                const goalsContainer = document.getElementById('today-goals');
                if (!goalsContainer) return;

                // Calculate progress for all subjects
                const subjectsWithProgress = studyData.subjects.map(s => ({
                    ...s,
                    progress: s.total > 0 ? Math.round((s.completed / s.total) * 100) : 0,
                    remaining: s.total - s.completed
                })).filter(s => s.total > 0);

                // Categorize subjects
                const weakSubjects = subjectsWithProgress.filter(s => s.progress < 50).sort((a, b) => a.progress - b.progress);
                const midSubjects = subjectsWithProgress.filter(s => s.progress >= 50 && s.progress < 70).sort((a, b) => a.progress - b.progress);
                const strongSubjects = subjectsWithProgress.filter(s => s.progress >= 70).sort((a, b) => b.progress - a.progress);

                const recommendations = [];

                // Recommendation 1: Weak subject (highest priority)
                if (weakSubjects.length > 0) {
                    const subject = weakSubjects[0];
                    const targetProgress = Math.min(subject.progress + 5, 50);
                    const problemsNeeded = Math.ceil((targetProgress - subject.progress) * subject.total / 100);
                    recommendations.push({
                        priority: 1,
                        subject: subject.name,
                        progress: subject.progress,
                        targetProgress: targetProgress,
                        action: `ê¸°ì¶œë¬¸ì œ ${problemsNeeded}ë¬¸ì œ í’€ì´`,
                        reason: 'ì·¨ì•½ ê³¼ëª© ì§‘ì¤‘ ë³´ì™„',
                        icon: 'ğŸ¯',
                        color: '#FF6B6B'
                    });
                } else if (midSubjects.length > 0) {
                    const subject = midSubjects[0];
                    const targetProgress = Math.min(subject.progress + 5, 70);
                    const problemsNeeded = Math.ceil((targetProgress - subject.progress) * subject.total / 100);
                    recommendations.push({
                        priority: 1,
                        subject: subject.name,
                        progress: subject.progress,
                        targetProgress: targetProgress,
                        action: `ì‹¬í™” ë¬¸ì œ ${problemsNeeded}ë¬¸ì œ`,
                        reason: 'ì¤‘ê°„ ê³¼ëª© ê°•í™”',
                        icon: 'ğŸ“š',
                        color: '#4ECDC4'
                    });
                }

                // Recommendation 2: Mid-level subject
                if (midSubjects.length > 0) {
                    const subject = midSubjects[0];
                    const targetProgress = Math.min(subject.progress + 5, 70);
                    const problemsNeeded = Math.ceil((targetProgress - subject.progress) * subject.total / 100);
                    recommendations.push({
                        priority: 2,
                        subject: subject.name,
                        progress: subject.progress,
                        targetProgress: targetProgress,
                        action: `ê°œë… ë³µìŠµ 30ë¶„`,
                        reason: 'ì¤‘ê¸‰ ë‹¨ê³„ ì•ˆì •í™”',
                        icon: 'ğŸ“–',
                        color: '#95E1D3'
                    });
                } else if (weakSubjects.length > 1) {
                    const subject = weakSubjects[1];
                    const targetProgress = Math.min(subject.progress + 5, 50);
                    const problemsNeeded = Math.ceil((targetProgress - subject.progress) * subject.total / 100);
                    recommendations.push({
                        priority: 2,
                        subject: subject.name,
                        progress: subject.progress,
                        targetProgress: targetProgress,
                        action: `ê¸°ë³¸ ê°œë… ì •ë¦¬`,
                        reason: 'ë‘ ë²ˆì§¸ ì·¨ì•½ ê³¼ëª©',
                        icon: 'ğŸ“',
                        color: '#FFE66D'
                    });
                }

                // Recommendation 3: Strong subject
                if (strongSubjects.length > 0) {
                    const subject = strongSubjects[0];
                    const targetProgress = Math.min(subject.progress + 3, 100);
                    recommendations.push({
                        priority: 3,
                        subject: subject.name,
                        progress: subject.progress,
                        targetProgress: targetProgress,
                        action: `ëª¨ì˜ê³ ì‚¬ ê²€í†  1ì‹œê°„`,
                        reason: 'ê°•ì  ìœ ì§€ ë° ì™„ì„±',
                        icon: 'â­',
                        color: '#A8E6CF'
                    });
                } else if (midSubjects.length > 1) {
                    const subject = midSubjects[1];
                    recommendations.push({
                        priority: 3,
                        subject: subject.name,
                        progress: subject.progress,
                        targetProgress: Math.min(subject.progress + 5, 70),
                        action: `ì‘ìš© ë¬¸ì œ í’€ì´`,
                        reason: 'ì¶”ê°€ ê°•í™” ê³¼ëª©',
                        icon: 'ğŸ’ª',
                        color: '#FFD3B6'
                    });
                }

                // Render recommendations
                if (recommendations.length > 0) {
                    goalsContainer.innerHTML = `
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 24px; border-radius: var(--radius-lg); color: white;">
                            <div style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 20px;">
                                AIê°€ ë‹¹ì‹ ì˜ í•™ìŠµ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ì˜¤ëŠ˜ ì§‘ì¤‘í•´ì•¼ í•  ê³¼ëª©ì„ ì¶”ì²œí•©ë‹ˆë‹¤.
                            </div>
                            ${recommendations.map((rec, idx) => `
                                <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 20px; border-radius: var(--radius-md); margin-bottom: ${idx < recommendations.length - 1 ? '16px' : '0'}; border: 1px solid rgba(255,255,255,0.2);">
                                    <div style="display: flex; align-items: center; gap: 16px;">
                                        <div style="font-size: 2.5rem;">${rec.icon}</div>
                                        <div style="flex: 1;">
                                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                                <div style="font-size: 1.1rem; font-weight: 700;">${rec.priority}. ${rec.subject}</div>
                                                <div style="background: rgba(255,255,255,0.3); padding: 4px 12px; border-radius: 12px; font-size: 0.85rem; font-weight: 600;">
                                                    ì§„ë„: ${rec.progress}% â†’ ${rec.targetProgress}%
                                                </div>
                                            </div>
                                            <div style="font-size: 0.95rem; margin-bottom: 6px; opacity: 0.95;">
                                                â†’ ${rec.action}
                                            </div>
                                            <div style="font-size: 0.85rem; opacity: 0.8;">
                                                ì´ìœ : ${rec.reason}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else {
                    goalsContainer.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            <div style="font-size: 3rem; margin-bottom: 16px;">ğŸ¯</div>
                            <div style="font-size: 1.1rem; margin-bottom: 8px;">ê³¼ëª©ì„ ì¶”ê°€í•˜ë©´ AIê°€ í•™ìŠµ ëª©í‘œë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤</div>
                            <div style="font-size: 0.9rem;">ê³¼ëª© ì„¤ì •ì—ì„œ ê³¼ëª©ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”</div>
                        </div>
                    `;
                }

                console.log('âœ… ì˜¤ëŠ˜ì˜ í•™ìŠµ ëª©í‘œ ë Œë”ë§ ì™„ë£Œ:', recommendations.length + 'ê°œ ì¶”ì²œ');
            } catch (error) {
                console.error('âŒ renderTodayGoals ì—ëŸ¬:', error);
            }
        }


        function renderSubjectTimeChart() {
            const container = document.getElementById('subject-time-chart');
            if (!container) {
                return;
            }
            container.innerHTML = '';

            // Calculate REAL time spent per subject
            const subjectTime = {};

            // Initialize with 0 for all subjects
            studyData.subjects.forEach(subject => {
                subjectTime[subject.name] = 0;
            });

            // 1. Add time from completed time blocks
            studyData.timeBlocks.forEach(block => {
                if (block.completed && block.subject && block.hours) {
                    if (!subjectTime[block.subject]) {
                        subjectTime[block.subject] = 0;
                    }
                    subjectTime[block.subject] += block.hours;
                }
            });

            // 2. Add estimated time from timer (distribute evenly if multiple subjects active)
            const timerHours = studyData.timer.seconds / 3600;
            const activeSubjects = studyData.subjects.filter(s => {
                const progress = (s.completed / s.total) * 100;
                return progress > 0 && progress < 100;
            });

            if (activeSubjects.length > 0 && timerHours > 0) {
                const hoursPerSubject = timerHours / activeSubjects.length;
                activeSubjects.forEach(subject => {
                    if (!subjectTime[subject.name]) {
                        subjectTime[subject.name] = 0;
                    }
                    subjectTime[subject.name] += hoursPerSubject;
                });
            }

            // 3. Add estimated time from progress (rough estimate: 0.5h per 10 problems completed)
            studyData.subjects.forEach(subject => {
                if (subject.completed > 0 && subjectTime[subject.name] === 0) {
                    // Estimate based on completed problems
                    subjectTime[subject.name] = (subject.completed / 10) * 0.5;
                }
            });

            // Sort by time spent (descending)
            const sortedSubjects = Object.entries(subjectTime)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 8); // Show top 8

            if (sortedSubjects.length === 0 || sortedSubjects.every(([_, time]) => time === 0)) {
                container.innerHTML = '<div style="text-align: center; color: var(--text-secondary); padding: 40px;">í•™ìŠµ ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ë©´ ê³¼ëª©ë³„ ì‹œê°„ì´ í‘œì‹œë©ë‹ˆë‹¤</div>';
                return;
            }

            const maxTime = Math.max(...sortedSubjects.map(([_, time]) => time), 1);

            sortedSubjects.forEach(([subjectName, timeSpent]) => {
                const hours = Math.round(timeSpent * 10) / 10; // Round to 1 decimal
                const height = (timeSpent / maxTime) * 100;

                const barItem = document.createElement('div');
                barItem.className = 'bar-item';

                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = height + '%';
                bar.style.background = 'linear-gradient(to top, var(--accent-color), var(--success-color))';

                const barValue = document.createElement('div');
                barValue.className = 'bar-value';
                barValue.textContent = hours + 'h';

                bar.appendChild(barValue);

                const label = document.createElement('div');
                label.className = 'bar-label';
                label.textContent = subjectName.replace(' (2ì°¨)', '').substring(0, 8);

                barItem.appendChild(bar);
                barItem.appendChild(label);
                container.appendChild(barItem);
            });
        }

        
        function renderMockScoreChart() {
            const container = document.getElementById('mock-score-chart');
            if (!container) {
                return;
            }
            container.innerHTML = '';

            if (!studyData.mockScores || studyData.mockScores.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: var(--text-secondary); padding: 40px;">ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”</div>';
                return;
            }

            // Show most recent scores (up to 10)
            const recentScores = studyData.mockScores.slice(-10);
            const maxScore = 100;

            recentScores.forEach((score, idx) => {
                const height = (score.score / maxScore) * 100;

                const barItem = document.createElement('div');
                barItem.className = 'bar-item';

                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = height + '%';

                // Color based on pass/fail (60% passing grade)
                if (score.score >= 60) {
                    bar.style.background = 'linear-gradient(to top, var(--success-color), #34D399)';
                } else {
                    bar.style.background = 'linear-gradient(to top, var(--danger-color), #F87171)';
                }

                // Add transition for animation
                bar.style.transition = 'height 0.5s ease ' + (idx * 0.05) + 's';

                const barValue = document.createElement('div');
                barValue.className = 'bar-value';
                barValue.textContent = score.score;

                bar.appendChild(barValue);

                const label = document.createElement('div');
                label.className = 'bar-label';
                // Show date in MM/DD format
                const dateStr = score.date.substring(5); // Remove year
                label.textContent = dateStr;

                barItem.appendChild(bar);
                barItem.appendChild(label);
                container.appendChild(barItem);
            });
        }

        // ===== ìƒˆë¡œìš´ ê¸°ëŠ¥: ì•½ì  ê³¼ëª© ì‹ë³„ =====
                function renderWeakSubjects() {
            const container = document.getElementById('weak-subjects-container');
            container.innerHTML = '';

            // Identify weak subjects based on REAL criteria
            const weakSubjects = [];

            studyData.subjects.forEach(subject => {
                const progress = (subject.completed / subject.total) * 100;
                const rotations = subject.rotations.filter(r => r).length;

                // Find recent mock exam performance for this subject (if available)
                let recentMockPerformance = null;
                const subjectBase = subject.name.replace(' (2ì°¨)', '');
                const relevantScores = studyData.mockScores.filter(s =>
                    s.subject && s.subject.includes(subjectBase)
                ).slice(-3);

                if (relevantScores.length > 0) {
                    const avgMockScore = relevantScores.reduce((sum, s) => sum + s.score, 0) / relevantScores.length;
                    recentMockPerformance = avgMockScore;
                }

                // Priority calculation
                let priority = 0;
                let reasons = [];

                if (progress < 30) {
                    priority += 10;
                    reasons.push('ì§„ë„ìœ¨ ë§¤ìš° ë‚®ìŒ');
                } else if (progress < 50) {
                    priority += 7;
                    reasons.push('ì§„ë„ìœ¨ ë‚®ìŒ');
                }

                if (rotations < 1) {
                    priority += 8;
                    reasons.push('íšŒë… ì—†ìŒ');
                } else if (rotations < 2) {
                    priority += 5;
                    reasons.push('íšŒë… ë¶€ì¡±');
                }

                if (recentMockPerformance !== null && recentMockPerformance < 60) {
                    priority += 6;
                    reasons.push(`ëª¨ì˜ê³ ì‚¬ ${recentMockPerformance.toFixed(0)}ì `);
                }

                if (priority > 5) {
                    weakSubjects.push({
                        subject,
                        progress,
                        rotations,
                        priority,
                        reasons,
                        mockScore: recentMockPerformance
                    });
                }
            });

            // Sort by priority (highest first)
            weakSubjects.sort((a, b) => b.priority - a.priority);

            if (weakSubjects.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--success-color); font-weight: 500;">ëª¨ë“  ê³¼ëª©ì´ ìˆœì¡°ë¡­ê²Œ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤! ğŸ‘</div>';
                return;
            }

            // Show top 5 weak subjects
            weakSubjects.slice(0, 5).forEach((item, idx) => {
                const { subject, progress, rotations, priority, reasons, mockScore } = item;

                const div = document.createElement('div');
                div.className = 'weak-subject';

                let badgeText, badgeColor;
                if (priority >= 15) {
                    badgeText = 'ìµœìš°ì„ ';
                    badgeColor = 'var(--danger-color)';
                } else if (priority >= 10) {
                    badgeText = 'ìš°ì„ ';
                    badgeColor = 'var(--warning-color)';
                } else {
                    badgeText = 'ì£¼ì˜';
                    badgeColor = '#FBBF24';
                }

                const recommendation = getSubjectRecommendation(subject, progress, rotations, mockScore);

                div.innerHTML = `
                    <div class="weak-subject-header">
                        <div class="weak-subject-name">${subject.name}</div>
                        <div class="priority-badge" style="background: ${badgeColor}">${badgeText}</div>
                    </div>
                    <div class="weak-subject-info">
                        ì§„ë„ìœ¨: ${Math.round(progress)}% | íšŒë…: ${rotations}íšŒ
                        ${mockScore !== null ? ` | ìµœê·¼ ëª¨ì˜ê³ ì‚¬: ${mockScore.toFixed(0)}ì ` : ''}
                    </div>
                    <div class="recommendation">
                        ${recommendation}
                    </div>
                `;

                container.appendChild(div);
            });
        }

        
        function getSubjectRecommendation(subject, progress, rotations, mockScore) {
            if (progress < 20 && rotations < 1) {
                return `ğŸš¨ ë§¤ì¼ ${subject.name} ìµœì†Œ 1ì‹œê°„ ì´ìƒ íˆ¬ì í•„ìˆ˜! ê¸°ì´ˆë¶€í„° ì°¨ê·¼ì°¨ê·¼ ì‹œì‘í•˜ì„¸ìš”.`;
            } else if (progress < 30) {
                return `âš ï¸ ì§„ë„ë¥¼ ë¹ ë¥´ê²Œ ì˜¬ë¦¬ëŠ” ê²ƒì´ ê¸‰ì„ ë¬´ì…ë‹ˆë‹¤. í•˜ë£¨ 1-2ì‹œê°„ ì§‘ì¤‘ í•™ìŠµì„ ê¶Œì¥í•©ë‹ˆë‹¤.`;
            } else if (progress < 50) {
                return `ğŸ“š ë§¤ì¼ ê¾¸ì¤€íˆ ì§„ë„ë¥¼ ë‚˜ê°€ì„¸ìš”. ëª©í‘œ: ì£¼ë‹¹ 10-15% ì§„ë„ìœ¨ ìƒìŠ¹`;
            } else if (rotations < 2) {
                return `ğŸ”„ ì§„ë„ëŠ” ì–‘í˜¸í•˜ì§€ë§Œ íšŒë…ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. ë³µìŠµ ì‹œê°„ì„ ëŠ˜ë ¤ì£¼ì„¸ìš”.`;
            } else if (mockScore !== null && mockScore < 60) {
                return `ğŸ“ ëª¨ì˜ê³ ì‚¬ ì„±ì ì´ ë‚®ìŠµë‹ˆë‹¤. ì·¨ì•½ ë‹¨ì›ì„ ì§‘ì¤‘ ë³µìŠµí•˜ì„¸ìš”.`;
            } else {
                return `âœ… í˜„ì¬ ì§„ë„ë¥¼ ìœ ì§€í•˜ë©´ì„œ ê¾¸ì¤€íˆ íšŒë…ì„ ì§„í–‰í•˜ì„¸ìš”.`;
            }
        }

        // ===== ìƒˆë¡œìš´ ê¸°ëŠ¥: ëª©í‘œ ì„¤ì • & ë§ˆì¼ìŠ¤í†¤ =====
        function renderGoals() {
            const container = document.getElementById('goals-container');
            container.innerHTML = '';

            if (!studyData.goals) studyData.goals = [];

            if (studyData.goals.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-secondary);">ëª©í‘œë¥¼ ì„¤ì •í•˜ì—¬ í•™ìŠµ ë™ê¸°ë¥¼ ë†’ì´ì„¸ìš”! ğŸ¯</div>';
                return;
            }

            studyData.goals.forEach(goal => {
                const today = new Date();
                const goalDate = new Date(goal.date);
                const isAchieved = goal.progress >= 100;
                const isOverdue = goalDate < today && !isAchieved;

                const daysLeft = Math.ceil((goalDate - today) / (1000 * 60 * 60 * 24));
                const daysText = isOverdue ? `${Math.abs(daysLeft)}ì¼ ê²½ê³¼` : `${daysLeft}ì¼ ë‚¨ìŒ`;

                const div = document.createElement('div');
                div.className = `goal-item ${isAchieved ? 'achieved' : ''}`;

                div.innerHTML = `
                    <div class="goal-header">
                        <div class="goal-title">${isAchieved ? 'âœ“ ' : ''}${goal.title}</div>
                        <div class="goal-date" style="color: ${isOverdue ? 'var(--danger)' : 'var(--text-secondary)'}">${daysText}</div>
                        <div class="goal-actions">
                            <button class="goal-btn" aria-label="ëª©í‘œ ìˆ˜ì •" onclick="editGoal(${goal.id})">âœï¸</button>
                            <button class="goal-btn" onclick="deleteGoal(${goal.id})">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                    <div class="goal-progress-bar">
                        <div class="goal-progress-fill" style="width: ${Math.min(goal.progress, 100)}%"></div>
                    </div>
                    <div style="text-align: right; font-size: 0.8rem; color: var(--text-secondary); margin-top: 5px;">
                        ${goal.progress}% ì™„ë£Œ
                    </div>
                `;

                container.appendChild(div);
            });
        }

        function addGoal() {
            editingGoalId = null;  // í¸ì§‘ ëª¨ë“œ ì´ˆê¸°í™”
            document.getElementById('goalTitle').value = '';
            document.getElementById('goalDate').value = '';
            document.getElementById('goalProgress').value = '0';
            document.querySelector('#goalModal .modal-title').textContent = 'í•™ìŠµ ëª©í‘œ ì¶”ê°€';
            document.getElementById('goalModal').classList.add('show');
        }

        function saveGoal() {
            const title = document.getElementById('goalTitle').value;
            const date = document.getElementById('goalDate').value;
            const progress = parseInt(document.getElementById('goalProgress').value) || 0;

            if (title && date) {
                if (!studyData.goals) studyData.goals = [];

                if (editingGoalId) {
                    // ìˆ˜ì • ëª¨ë“œ
                    const goal = studyData.goals.find(g => g.id === editingGoalId);
                    if (goal) {
                        goal.title = title;
                        goal.date = date;
                        goal.progress = Math.min(progress, 100);
                        showToast('ëª©í‘œê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤');
                    }
                    editingGoalId = null;
                } else {
                    // ì¶”ê°€ ëª¨ë“œ
                    studyData.goals.push({
                        id: Date.now(),
                        title,
                        date,
                        progress: Math.min(progress, 100),
                        createdAt: new Date().toISOString()
                    });
                    showToast('ëª©í‘œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤ ğŸ¯');
                }

                saveData();
                renderGoals();
                closeModal('goalModal');

                // Reset form and title
                document.getElementById('goalTitle').value = '';
                document.getElementById('goalDate').value = '';
                document.getElementById('goalProgress').value = '0';
                document.querySelector('#goalModal .modal-title').textContent = 'í•™ìŠµ ëª©í‘œ ì¶”ê°€';
            } else {
                showToast('ëª©í‘œ ë‚´ìš©ê³¼ ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
            }
        }

        function editGoal(id) {
            const goal = studyData.goals.find(g => g.id === id);
            if (goal) {
                editingGoalId = id;
                document.getElementById('goalTitle').value = goal.title;
                document.getElementById('goalDate').value = goal.date;  // deadline â†’ date
                document.getElementById('goalProgress').value = goal.progress;
                document.querySelector('#goalModal .modal-title').textContent = 'í•™ìŠµ ëª©í‘œ ìˆ˜ì •';
                document.getElementById('goalModal').classList.add('show');
            }
        }

        function deleteGoal(id) {
            showConfirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?', () => {
                studyData.goals = studyData.goals.filter(g => g.id !== id);
                saveData();
                renderGoals();
                showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
            });
        }

        // ===== ìƒˆë¡œìš´ ê¸°ëŠ¥: ìŠ¤ë§ˆíŠ¸ í•™ìŠµ ì¶”ì²œ =====
        function renderSmartRecommendations() {
            const container = document.getElementById('smart-recommendations');
            container.innerHTML = '';

            const recommendations = generateRecommendations();

            recommendations.forEach(rec => {
                const li = document.createElement('li');
                li.textContent = rec;
                container.appendChild(li);
            });
        }

        function generateRecommendations() {
            const recs = [];
            const today = new Date();
            const examDate = new Date('2026-08-29');
            const daysLeft = Math.ceil((examDate - today) / (1000 * 60 * 60 * 24));

            // ì‹œí—˜ì¼ ê¸°ë°˜ ì¶”ì²œ
            if (daysLeft < 30) {
                recs.push('ì‹œí—˜ì´ í•œ ë‹¬ë„ ë‚¨ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤! ê¸°ì¶œë¬¸ì œ ìµœì¢… ì •ë¦¬ì— ì§‘ì¤‘í•˜ì„¸ìš”.');
            } else if (daysLeft < 90) {
                recs.push('ëª¨ì˜ê³ ì‚¬ë¥¼ ì£¼ 2-3íšŒ ì‹¤ì‹œí•˜ì—¬ ì‹¤ì „ ê°ê°ì„ ìµíˆì„¸ìš”.');
            } else if (daysLeft < 180) {
                recs.push('ì „ì²´ íšŒë… ë§ˆë¬´ë¦¬ì™€ ì·¨ì•½ì  ë³´ì™„ì— ì§‘ì¤‘í•˜ì„¸ìš”.');
            }

            // ì•½ì  ê³¼ëª© ê¸°ë°˜ ì¶”ì²œ
            const weakSubjects = studyData.subjects.filter(s => {
                const progress = (s.completed / s.total) * 100;
                return progress < 50;
            });

            if (weakSubjects.length > 0) {
                recs.push(`${weakSubjects[0].name} ê³¼ëª©ì˜ ì§„ë„ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. ì˜¤ëŠ˜ì€ ì´ ê³¼ëª©ì— ì§‘ì¤‘í•˜ì„¸ìš”.`);
            }

            // ìŠ¤íŠ¸ë¦­ ê¸°ë°˜ ì¶”ì²œ
            if (studyData.streak.current >= 7) {
                recs.push(`ëŒ€ë‹¨í•©ë‹ˆë‹¤! ${studyData.streak.current}ì¼ ì—°ì† í•™ìŠµ ì¤‘ì…ë‹ˆë‹¤. ì´ í˜ì´ìŠ¤ë¥¼ ìœ ì§€í•˜ì„¸ìš”!`);
            } else if (studyData.streak.current === 0) {
                recs.push('ì˜¤ëŠ˜ë¶€í„° ë‹¤ì‹œ ì‹œì‘í•˜ì„¸ìš”! ê¾¸ì¤€í•¨ì´ í•©ê²©ì˜ ë¹„ê²°ì…ë‹ˆë‹¤.');
            }

            // ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ ê¸°ë°˜ ì¶”ì²œ
            if (studyData.mockScores.length > 0) {
                const recentScores = studyData.mockScores.slice(-3);
                const avgRecent = recentScores.reduce((sum, s) => sum + s.score, 0) / recentScores.length;

                if (avgRecent < 55) {
                    recs.push('ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ê°€ ë‚®ìŠµë‹ˆë‹¤. ê¸°ë³¸ ê°œë… ë³µìŠµì„ ê¶Œì¥í•©ë‹ˆë‹¤.');
                } else if (avgRecent >= 60) {
                    recs.push('ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ê°€ í•©ê²©ê¶Œì…ë‹ˆë‹¤! ì‹¤ìˆ˜ ë°©ì§€ì— ì§‘ì¤‘í•˜ì„¸ìš”.');
                }
            }

            // ì¼ë°˜ ì¶”ì²œ
            if (recs.length < 3) {
                recs.push('í•˜ë£¨ 4-5ì‹œê°„ ì´ìƒ í•™ìŠµì„ ëª©í‘œë¡œ í•˜ì„¸ìš”.');
                recs.push('ë§¤ì¼ ê¸°ì¶œë¬¸ì œ 50ë¬¸ì œ ì´ìƒì„ í’€ì´í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.');
            }

            return recs.slice(0, 5);
        }

        // ===== ìœ í‹¸ë¦¬í‹°: ì ‘ì„ ìˆ˜ ìˆëŠ” ì„¹ì…˜ =====
        function toggleCollapse(sectionId) {
            const section = document.getElementById(sectionId);
            const icon = document.getElementById(sectionId.replace('-section', '-icon'));

            section.classList.toggle('collapsed');
            icon.classList.toggle('collapsed');
        }

        // ===== ë°ì´í„° Import/Export ê¸°ëŠ¥ =====

        /**
         * ëª¨ë“  í•™ìŠµ ë°ì´í„°ë¥¼ JSON íŒŒì¼ë¡œ ë‚´ë³´ë‚´ê¸°
         */
        function exportData() {
            try {
                // ë‚´ë³´ë‚¼ ë°ì´í„° ì¤€ë¹„ (ë¯¼ê°í•œ ì •ë³´ ì œì™¸, ë¶ˆí•„ìš”í•œ í•„ë“œ ì œê±°)
                const exportData = {
                    version: '2.12.0',
                    exportDate: new Date().toISOString(),
                    data: {
                        examType: studyData.examType,
                        examDates: studyData.examDates,
                        subjects1st: studyData.subjects1st,
                        subjects2nd: studyData.subjects2nd,
                        timeBlocks: studyData.timeBlocks,
                        mockScores: studyData.mockScores,
                        weeklyHours: studyData.weeklyHours,
                        notes: studyData.notes,
                        streak: studyData.streak,
                        goals: studyData.goals,
                        subjectTimeSpent: studyData.subjectTimeSpent,
                        studyHistory: studyData.studyHistory
                    }
                };

                // JSONìœ¼ë¡œ ë³€í™˜
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });

                // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;

                // íŒŒì¼ëª…: study-data-YYYY-MM-DD.json
                const today = new Date().toISOString().split('T')[0];
                link.download = `study-data-${today}.json`;

                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                // ë©”ëª¨ë¦¬ ì •ë¦¬
                URL.revokeObjectURL(url);

                showToast('ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë‚´ë³´ë‚´ì¡ŒìŠµë‹ˆë‹¤', 'success');
                console.log('Data exported successfully');

            } catch (error) {
                console.error('Export error:', error);
                showToast('ë°ì´í„° ë‚´ë³´ë‚´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
            }
        }

        /**
         * JSON íŒŒì¼ì—ì„œ í•™ìŠµ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
         */
        let pendingImportData = null;

        function importData(event) {
            const file = event.target.files[0];
            if (!file) {
                return;
            }

            // íŒŒì¼ í™•ì¥ì ê²€ì¦
            if (!file.name.endsWith('.json')) {
                showToast('JSON íŒŒì¼ë§Œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤', 'error');
                event.target.value = ''; // íŒŒì¼ ì„ íƒ ì´ˆê¸°í™”
                return;
            }

            const reader = new FileReader();

            reader.onload = function(e) {
                try {
                    // JSON íŒŒì‹±
                    const importedData = JSON.parse(e.target.result);

                    // ë°ì´í„° êµ¬ì¡° ê²€ì¦
                    if (!validateImportData(importedData)) {
                        showToast('ì˜¬ë°”ë¥´ì§€ ì•Šì€ íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤', 'error');
                        event.target.value = '';
                        return;
                    }

                    // ì„ì‹œë¡œ ì €ì¥í•˜ê³  í™•ì¸ ëª¨ë‹¬ í‘œì‹œ
                    pendingImportData = importedData.data;
                    showImportPreview(importedData);

                } catch (error) {
                    console.error('Import parsing error:', error);
                    showToast('íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì˜¬ë°”ë¥¸ JSON íŒŒì¼ì¸ì§€ í™•ì¸í•˜ì„¸ìš”.', 'error');
                    event.target.value = '';
                }
            };

            reader.onerror = function() {
                showToast('íŒŒì¼ ì½ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
                event.target.value = '';
            };

            reader.readAsText(file);
        }

        /**
         * ê°€ì ¸ì˜¨ ë°ì´í„°ì˜ ìœ íš¨ì„± ê²€ì¦
         */
        function validateImportData(data) {
            try {
                // í•„ìˆ˜ êµ¬ì¡° ê²€ì¦
                if (!data || typeof data !== 'object') {
                    console.error('Invalid data structure: not an object');
                    return false;
                }

                if (!data.data || typeof data.data !== 'object') {
                    console.error('Invalid data structure: missing data property');
                    return false;
                }

                const d = data.data;

                // í•„ìˆ˜ ë°°ì—´ í•„ë“œ ê²€ì¦
                const requiredArrays = ['subjects1st', 'subjects2nd'];
                for (const field of requiredArrays) {
                    if (!Array.isArray(d[field])) {
                        console.error(`Invalid data structure: ${field} is not an array`);
                        return false;
                    }
                }

                // ì„ íƒì  ë°°ì—´ í•„ë“œ ê²€ì¦ (ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ë¡œ ì´ˆê¸°í™”)
                const optionalArrays = ['timeBlocks', 'mockScores', 'goals', 'studyHistory'];
                for (const field of optionalArrays) {
                    if (d[field] !== undefined && !Array.isArray(d[field])) {
                        console.error(`Invalid data structure: ${field} is not an array`);
                        return false;
                    }
                }

                // ê³¼ëª© ë°ì´í„° ê²€ì¦
                if (d.subjects1st.length === 0) {
                    console.error('Invalid data: subjects1st is empty');
                    return false;
                }

                // ê¸°ë³¸ êµ¬ì¡°ê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸
                const sample = d.subjects1st[0];
                if (!sample.name || typeof sample.total !== 'number' || typeof sample.completed !== 'number') {
                    console.error('Invalid subject structure');
                    return false;
                }

                console.log('Data validation passed');
                return true;

            } catch (error) {
                console.error('Validation error:', error);
                return false;
            }
        }

        /**
         * ê°€ì ¸ì˜¬ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
         */
        function showImportPreview(importedData) {
            const previewContainer = document.getElementById('importPreviewContainer');
            const data = importedData.data;

            // ë¯¸ë¦¬ë³´ê¸° HTML ìƒì„±
            let previewHTML = '<h4 style="margin-bottom: 15px; color: var(--primary-dark);">ê°€ì ¸ì˜¬ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°</h4>';

            // íŒŒì¼ ì •ë³´
            if (importedData.version) {
                previewHTML += `
                    <div class="import-preview-item">
                        <span class="import-preview-label">íŒŒì¼ ë²„ì „</span>
                        <span class="import-preview-value">${importedData.version}</span>
                    </div>
                `;
            }

            if (importedData.exportDate) {
                const exportDate = new Date(importedData.exportDate);
                previewHTML += `
                    <div class="import-preview-item">
                        <span class="import-preview-label">ë‚´ë³´ë‚¸ ë‚ ì§œ</span>
                        <span class="import-preview-value">${exportDate.toLocaleDateString('ko-KR')}</span>
                    </div>
                `;
            }

            // ë°ì´í„° í†µê³„
            previewHTML += `
                <div class="import-preview-item">
                    <span class="import-preview-label">1ì°¨ ê³¼ëª© ìˆ˜</span>
                    <span class="import-preview-value">${data.subjects1st?.length || 0}ê°œ</span>
                </div>
                <div class="import-preview-item">
                    <span class="import-preview-label">2ì°¨ ê³¼ëª© ìˆ˜</span>
                    <span class="import-preview-value">${data.subjects2nd?.length || 0}ê°œ</span>
                </div>
                <div class="import-preview-item">
                    <span class="import-preview-label">í•™ìŠµ ë¸”ë¡ ìˆ˜</span>
                    <span class="import-preview-value">${data.timeBlocks?.length || 0}ê°œ</span>
                </div>
                <div class="import-preview-item">
                    <span class="import-preview-label">ëª¨ì˜ê³ ì‚¬ ê¸°ë¡</span>
                    <span class="import-preview-value">${data.mockScores?.length || 0}ê°œ</span>
                </div>
                <div class="import-preview-item">
                    <span class="import-preview-label">í•™ìŠµ ëª©í‘œ</span>
                    <span class="import-preview-value">${data.goals?.length || 0}ê°œ</span>
                </div>
                <div class="import-preview-item">
                    <span class="import-preview-label">í•™ìŠµ ìŠ¤íŠ¸ë¦­</span>
                    <span class="import-preview-value">${data.streak?.current || 0}ì¼ ì—°ì†</span>
                </div>
            `;

            previewContainer.innerHTML = previewHTML;

            // í™•ì¸ ë²„íŠ¼ì— ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì„¤ì •
            const confirmBtn = document.getElementById('confirmImportBtn');
            confirmBtn.onclick = function() {
                confirmImport();
            };

            // ëª¨ë‹¬ í‘œì‹œ
            document.getElementById('importConfirmModal').classList.add('show');
        }

        /**
         * ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ìµœì¢… í™•ì¸ ë° ì‹¤í–‰
         */
        function confirmImport() {
            if (!pendingImportData) {
                showToast('ê°€ì ¸ì˜¬ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤', 'error');
                closeModal('importConfirmModal');
                return;
            }

            try {
                // í˜„ì¬ ë°ì´í„°ë¥¼ ì„ì‹œë¡œ ë°±ì—… (í˜¹ì‹œ ëª¨ë¥¼ ìƒí™© ëŒ€ë¹„ - ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì—)
                try {
                    sessionStorage.setItem('studyDataBackup', JSON.stringify(studyData));
                } catch (backupError) {
                    console.warn('Failed to create session backup:', backupError);
                }

                // ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const imported = pendingImportData;

                // ê¸°ë³¸ê°’ê³¼ ë³‘í•© (ëˆ„ë½ëœ í•„ë“œ ì²˜ë¦¬)
                studyData = {
                    examType: imported.examType || '1ì°¨',
                    examDates: imported.examDates || { '1ì°¨': null, '2ì°¨': null },
                    timer: {
                        seconds: 0,
                        isRunning: false,
                        interval: null
                    },
                    pomodoro: {
                        seconds: 1500,
                        isRunning: false,
                        interval: null,
                        mode: 'work',
                        completedSessions: 0
                    },
                    subjects1st: imported.subjects1st || [],
                    subjects2nd: imported.subjects2nd || [],
                    subjects: [],
                    timeBlocks: imported.timeBlocks || [],
                    mockScores: imported.mockScores || [],
                    weeklyHours: imported.weeklyHours || {},
                    notes: imported.notes || {},
                    streak: imported.streak || {
                        current: 0,
                        longest: 0,
                        lastStudyDate: null,
                        totalDays: 0
                    },
                    goals: imported.goals || [],
                    subjectTimeSpent: imported.subjectTimeSpent || {},
                    studyHistory: imported.studyHistory || []
                };

                // ê³¼ëª© ì„¤ì • ì—…ë°ì´íŠ¸
                updateSubjectsByExamType();

                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                saveData();

                // ëª¨ë‹¬ ë‹«ê¸°
                closeModal('importConfirmModal');

                // ì„±ê³µ í† ìŠ¤íŠ¸
                showToast('ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤! í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤.', 'success');

                // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ (ëª¨ë“  UI ì—…ë°ì´íŠ¸)
                setTimeout(() => {
                    location.reload();
                }, 1500);

                // ì„ì‹œ ë°ì´í„° ì •ë¦¬
                pendingImportData = null;

                console.log('Data imported successfully');

            } catch (error) {
                console.error('Import error:', error);
                showToast('ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');

                // ë°±ì—… ë³µêµ¬ ì‹œë„
                try {
                    const backup = sessionStorage.getItem('studyDataBackup');
                    if (backup) {
                        studyData = JSON.parse(backup);
                        saveData();
                        showToast('ì´ì „ ë°ì´í„°ë¡œ ë³µêµ¬ë˜ì—ˆìŠµë‹ˆë‹¤', 'info');
                    }
                } catch (restoreError) {
                    console.error('Failed to restore backup:', restoreError);
                }
            } finally {
                // íŒŒì¼ ì…ë ¥ ì´ˆê¸°í™”
                const fileInput = document.getElementById('importFileInput');
                if (fileInput) {
                    fileInput.value = '';
                }
            }
        }

        // íƒ€ì´ë¨¸ ì‹œì‘ ì‹œ ìŠ¤íŠ¸ë¦­ ì—…ë°ì´íŠ¸
        const originalStartTimer = startTimer;
        startTimer = function() {
            originalStartTimer();
            updateStreak();
            renderAnalytics();
        };

        // íƒ€ì„ë¸”ë¡ ì™„ë£Œ ì‹œ ë¶„ì„ ì—…ë°ì´íŠ¸
        // (ì£¼ì„ ì²˜ë¦¬ - 7422ì—ì„œ ì¬ì •ì˜ë¨)
        // const originalToggleTimeBlock = toggleTimeBlock;
        // toggleTimeBlock = function(id) {
        //     originalToggleTimeBlock(id);
        //     updateStreak();
        //     renderAnalytics();
        // };

        // ===== PROPER INITIALIZATION SEQUENCE =====
        // This ensures correct order: DOMReady â†’ setupChart â†’ wrapFunctions â†’ init â†’ chartUpdate
        document.addEventListener('DOMContentLoaded', function() {
            // Step 0: Load saved theme on page load
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            const themeIcon = document.getElementById('theme-icon');
            if (themeIcon) {
                themeIcon.textContent = savedTheme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
            }

            // Step 1: Setup Chart.js defaults
            if (typeof Chart !== 'undefined') {
                Chart.defaults.font.family = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                Chart.defaults.animation.duration = 600;
                Chart.defaults.animation.easing = 'easeInOutQuart';
            }

            // Step 2: Wrap saveData to update charts on data changes
            const originalSaveData = saveData;
            saveData = function() {
                originalSaveData();
                if (typeof Chart !== 'undefined') {
                    initAllCharts();
                }
            };

            // Step 3: Wrap toggleDarkMode to update charts on theme change
            if (typeof toggleDarkMode === 'function') {
                const originalToggleDarkMode = toggleDarkMode;
                toggleDarkMode = function() {
                    originalToggleDarkMode();
                    if (typeof Chart !== 'undefined') {
                        setTimeout(() => {
                            initAllCharts();
                        }, 100);
                    }
                };
            }

            // Step 4: Initialize the application (loads data + renders UI)
            init();

            // Step 4.5: Initialize tab navigation (show overview tab by default)
            setTimeout(() => {
                switchTab('overview');
                console.log('âœ… íƒ­ ë„¤ë¹„ê²Œì´ì…˜ ì´ˆê¸°í™” ì™„ë£Œ');
            }, 100);

            // Step 5: Initialize charts with loaded data
            if (typeof Chart !== 'undefined') {
                initAllCharts();
            } else {
                console.error('Chart.js not loaded');
            }

        });

        // ===== v3.0.0 DASHBOARD TAB & STICKY PROGRESS FUNCTIONALITY =====

        // íƒ­ ì „í™˜ í•¨ìˆ˜ - í•´ë‹¹ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
        function switchTab(tabName) {
            // Tab functionality removed - tabs deleted from dashboard
            console.log(`â„¹ï¸ switchTab í•¨ìˆ˜ëŠ” ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤ (íƒ­ì´ ì‚­ì œë¨)`);
        }

        // ì„¹ì…˜ìœ¼ë¡œ ì í”„í•˜ëŠ” í•¨ìˆ˜ (ìŠ¤í¬ë¡¤ë§Œ ìˆ˜í–‰)
        function jumpToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                console.log(`âœ… ì„¹ì…˜ìœ¼ë¡œ ì í”„: ${sectionId}`);
                // ìš”ì†Œë¡œ ìŠ¤í¬ë¡¤ ë° ê°•ì¡° íš¨ê³¼
                setTimeout(() => {
                    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    // ê°•ì¡° íš¨ê³¼
                    element.style.backgroundColor = 'var(--accent-light)';
                    element.style.opacity = '0.5';
                    setTimeout(() => {
                        element.style.backgroundColor = '';
                        element.style.opacity = '1';
                        element.style.transition = 'all 0.3s ease';
                    }, 500);
                }, 100);
            } else {
                console.error(`âŒ ì°¾ì„ ìˆ˜ ì—†ëŠ” ì„¹ì…˜ ID: ${sectionId}`);
            }
        }

        // Sticky Progress Bar ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateStickyProgress() {
            // ì „ì²´ ì§„ë„ ê³„ì‚°
            let completedSubjects = 0;
            let totalSubjects = 0;
            const examType = document.querySelector('.study-mode-selector .active')?.textContent || '1ì°¨';

            studyData.subjects.forEach(subject => {
                if (examType.includes('1ì°¨') && !subject.name.includes('2ì°¨')) {
                    totalSubjects++;
                    if (subject.progress >= 100) completedSubjects++;
                } else if (examType.includes('2ì°¨') && subject.name.includes('2ì°¨')) {
                    totalSubjects++;
                    if (subject.progress >= 100) completedSubjects++;
                }
            });

            const overallProgress = totalSubjects > 0 ? Math.round((completedSubjects / totalSubjects) * 100) : 0;
            document.getElementById('stickyProgress').textContent = overallProgress + '%';

            // ì—°ì† í•™ìŠµì¼
            const streak = studyData.streak?.current || 0;
            document.getElementById('stickyStreak').textContent = streak + 'ì¼';

            // ì˜¤ëŠ˜ ì™„ë£Œí•œ ë¸”ë¡
            const today = new Date().toISOString().split('T')[0];
            const todayBlocks = studyData.timeBlocks.filter(block => block.date === today);
            const completedBlocks = todayBlocks.filter(block => block.completed).length;
            document.getElementById('stickyCompleted').textContent = `${completedBlocks}/${todayBlocks.length}`;

            // ì˜¤ëŠ˜ í•™ìŠµ ì‹œê°„
            const totalHours = todayBlocks.reduce((sum, block) => sum + block.hours, 0);
            const completedHours = todayBlocks.filter(block => block.completed).reduce((sum, block) => sum + block.hours, 0);
            document.getElementById('stickyHours').textContent = `${completedHours.toFixed(1)}h`;
        }

        // Sticky Progress Bar ìë™ ì—…ë°ì´íŠ¸ (ë°ì´í„° ë³€ê²½ ì‹œ)
        let updateProgressInterval;
        function startProgressUpdate() {
            updateStickyProgress(); // ì´ˆê¸° ì—…ë°ì´íŠ¸
            updateProgressInterval = setInterval(updateStickyProgress, 30000); // 30ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
        }

        // ===== DARK MODE FUNCTIONALITY (í•¨ìˆ˜ ì¡°ê¸° ì •ì˜ - DOMContentLoaded ì „) =====
        function toggleDarkMode() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);

            // Update icon
            const icon = document.getElementById('theme-icon');
            if (icon) {
                icon.textContent = newTheme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
            }

            showToast(`${newTheme === 'dark' ? 'ë‹¤í¬' : 'ë¼ì´íŠ¸'} ëª¨ë“œë¡œ ì „í™˜ë˜ì—ˆìŠµë‹ˆë‹¤`, 'info');
        }

        // ===== v3.0.0 AUTO-SAVE FOR NOTES =====
        let notesAutoSaveTimeout;
        let notesAutoSaveActive = false;

        function enableNotesAutoSave() {
            const notesInput = document.getElementById('study-notes');
            if (!notesInput) return;

            notesAutoSaveActive = true;

            notesInput.addEventListener('input', () => {
                // ê¸°ì¡´ íƒ€ì´ë¨¸ ì·¨ì†Œ
                if (notesAutoSaveTimeout) clearTimeout(notesAutoSaveTimeout);

                // ì…ë ¥ ì¤‘ í‘œì‹œ
                notesInput.style.borderColor = 'var(--accent-light)';

                // 2ì´ˆ í›„ ìë™ ì €ì¥
                notesAutoSaveTimeout = setTimeout(() => {
                    saveNotesAuto();
                }, 2000);
            });
        }

        function saveNotesAuto() {
            const notesInput = document.getElementById('study-notes');
            if (!notesInput) return;

            const today = new Date().toISOString().split('T')[0];
            const content = notesInput.value;

            if (!studyData.notes) studyData.notes = {};
            if (!studyData.notes[today]) studyData.notes[today] = {};

            studyData.notes[today].content = content;
            studyData.notes[today].lastModified = new Date().toISOString();

            saveData();

            // ìë™ ì €ì¥ ì‹œê°ì  í”¼ë“œë°± (ì‚´ì§ ë³€ê²½)
            notesInput.style.borderColor = 'var(--success-color)';
            notesInput.style.boxShadow = '0 0 0 3px rgba(52, 199, 89, 0.1)';

            setTimeout(() => {
                notesInput.style.borderColor = '';
                notesInput.style.boxShadow = '';
            }, 1500);

            console.log('ğŸ’¾ ìë™ ì €ì¥ë¨:', today);
        }

        // ============================================
        // DATA VISUALIZATION WITH CHART.JS - v2.13.0
        // ============================================

        // Chart instances (global)
        let subjectTimeChart = null;
        let mockScoreChart = null;
        let currentScoreRange = 'all';

        // Apple-inspired color palette
        const appleColors = {
            light: {
                blue: '#0071e3',
                green: '#34c759',
                orange: '#ff9500',
                red: '#ff3b30',
                purple: '#af52de',
                pink: '#ff2d55',
                yellow: '#ffcc00',
                teal: '#5ac8fa',
                indigo: '#5856d6',
                gray: '#8e8e93'
            },
            dark: {
                blue: '#2997ff',
                green: '#30d158',
                orange: '#ff9f0a',
                red: '#ff453a',
                purple: '#bf5af2',
                pink: '#ff375f',
                yellow: '#ffd60a',
                teal: '#64d2ff',
                indigo: '#5e5ce6',
                gray: '#98989d'
            }
        };

        // Get current theme colors
        function getThemeColors() {
            const isDark = document.body.classList.contains('dark-mode');
            return isDark ? appleColors.dark : appleColors.light;
        }

        // Get text colors based on theme
        function getTextColors() {
            const isDark = document.body.classList.contains('dark-mode');
            return {
                primary: isDark ? '#f5f5f7' : '#1d1d1f',
                secondary: isDark ? '#a1a1a6' : '#6e6e73',
                tertiary: isDark ? '#6e6e73' : '#a1a1a6'
            };
        }

        // Chart.js default configuration
        function getChartDefaults() {
            const textColors = getTextColors();
            const isDark = document.body.classList.contains('dark-mode');

            return {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom',
                        labels: {
                            color: textColors.primary,
                            font: {
                                family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                size: 13,
                                weight: '500'
                            },
                            padding: 16,
                            usePointStyle: true,
                            pointStyle: 'circle'
                        }
                    },
                    tooltip: {
                        backgroundColor: isDark ? 'rgba(22, 22, 23, 0.95)' : 'rgba(255, 255, 255, 0.95)',
                        titleColor: textColors.primary,
                        bodyColor: textColors.secondary,
                        borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)',
                        borderWidth: 1,
                        padding: 12,
                        cornerRadius: 8,
                        titleFont: {
                            family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                            size: 14,
                            weight: '600'
                        },
                        bodyFont: {
                            family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                            size: 13
                        },
                        displayColors: true,
                        boxWidth: 12,
                        boxHeight: 12,
                        boxPadding: 6
                    }
                },
                animation: {
                    duration: 600,
                    easing: 'easeInOutQuart'
                }
            };
        }

        // Initialize Subject Time Distribution Chart (Doughnut)
        function initSubjectTimeChart() {
            const ctx = document.getElementById('subjectTimeChart');
            if (!ctx) return;

            // Calculate subject study times from actual data
            const subjectTimes = {};
            const subjects = studyData.subjects || [];

            // Add time from subjects progress
            subjects.forEach(subject => {
                const progress = subject.completed / subject.total;
                const estimatedHours = Math.round(progress * 100); // Rough estimation
                subjectTimes[subject.name] = (subjectTimes[subject.name] || 0) + estimatedHours;
            });

            // Add time from time blocks
            (studyData.timeBlocks || []).forEach(block => {
                const subject = block.subject || 'ê¸°íƒ€';
                const duration = parseInt(block.duration) || 0;
                subjectTimes[subject] = (subjectTimes[subject] || 0) + duration;
            });

            // Prepare chart data
            const labels = Object.keys(subjectTimes);
            const data = Object.values(subjectTimes);
            const colors = getThemeColors();

            // Color array for subjects
            const colorArray = [
                colors.blue, colors.green, colors.orange, colors.purple,
                colors.pink, colors.teal, colors.indigo, colors.red, colors.yellow
            ];

            const chartData = {
                labels: labels.length > 0 ? labels : ['ë°ì´í„° ì—†ìŒ'],
                datasets: [{
                    label: 'í•™ìŠµ ì‹œê°„ (ì‹œê°„)',
                    data: data.length > 0 ? data : [1],
                    backgroundColor: labels.length > 0 ? colorArray.slice(0, labels.length) : ['#e0e0e0'],
                    borderWidth: 0,
                    hoverOffset: 8
                }]
            };

            const config = {
                type: 'doughnut',
                data: chartData,
                options: {
                    ...getChartDefaults(),
                    cutout: '70%',
                    plugins: {
                        ...getChartDefaults().plugins,
                        legend: {
                            ...getChartDefaults().plugins.legend,
                            position: 'right'
                        },
                        tooltip: {
                            ...getChartDefaults().plugins.tooltip,
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;
                                    return `${label}: ${value}ì‹œê°„ (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            };

            // Destroy existing chart
            if (subjectTimeChart) {
                subjectTimeChart.destroy();
            }

            // Create new chart
            subjectTimeChart = new Chart(ctx, config);
        }

        // Initialize Mock Exam Score Trend Chart (Line)
        function initMockScoreChart(range = 'all') {
            const ctx = document.getElementById('mockScoreChart');
            if (!ctx) return;

            // Get mock scores from data
            let scores = studyData.mockScores || [];

            // Filter by date range
            const now = new Date();
            if (range === 'week') {
                const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                scores = scores.filter(score => new Date(score.date) >= weekAgo);
            } else if (range === 'month') {
                const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                scores = scores.filter(score => new Date(score.date) >= monthAgo);
            }

            // Sort by date
            scores.sort((a, b) => new Date(a.date) - new Date(b.date));

            // Prepare chart data
            const labels = scores.map(score => {
                const date = new Date(score.date);
                return `${date.getMonth() + 1}/${date.getDate()}`;
            });

            const scoreData = scores.map(score => parseFloat(score.score) || 0);

            // Calculate average
            const average = scoreData.length > 0
                ? scoreData.reduce((a, b) => a + b, 0) / scoreData.length
                : 0;

            const colors = getThemeColors();
            const textColors = getTextColors();

            const chartData = {
                labels: labels.length > 0 ? labels : ['ë°ì´í„° ì—†ìŒ'],
                datasets: [
                    {
                        label: 'ì ìˆ˜',
                        data: scoreData.length > 0 ? scoreData : [0],
                        borderColor: colors.blue,
                        backgroundColor: colors.blue + '20',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        pointRadius: 6,
                        pointHoverRadius: 8,
                        pointBackgroundColor: colors.blue,
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2
                    },
                    {
                        label: 'í‰ê· ',
                        data: scoreData.length > 0 ? Array(scoreData.length).fill(average) : [0],
                        borderColor: colors.orange,
                        borderWidth: 2,
                        borderDash: [5, 5],
                        fill: false,
                        pointRadius: 0,
                        pointHoverRadius: 0
                    }
                ]
            };

            const config = {
                type: 'line',
                data: chartData,
                options: {
                    ...getChartDefaults(),
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: textColors.tertiary + '20',
                                drawBorder: false
                            },
                            ticks: {
                                color: textColors.secondary,
                                font: {
                                    family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                    size: 12
                                },
                                callback: function(value) {
                                    return value + 'ì ';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false,
                                drawBorder: false
                            },
                            ticks: {
                                color: textColors.secondary,
                                font: {
                                    family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                    size: 12
                                }
                            }
                        }
                    },
                    plugins: {
                        ...getChartDefaults().plugins,
                        tooltip: {
                            ...getChartDefaults().plugins.tooltip,
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = context.parsed.y || 0;
                                    return `${label}: ${value.toFixed(1)}ì `;
                                }
                            }
                        }
                    }
                }
            };

            // Destroy existing chart
            if (mockScoreChart) {
                mockScoreChart.destroy();
            }

            // Create new chart
            mockScoreChart = new Chart(ctx, config);
        }

        // Render Subject Progress Bars
        function renderSubjectProgressBars() {
            const container = document.getElementById('subjectProgressBars');
            if (!container) return;

            const subjects = studyData.subjects || [];

            if (subjects.length === 0) {
                container.innerHTML = `
                    <div class="chart-empty-state">
                        <div class="chart-empty-icon">ğŸ“š</div>
                        <div class="chart-empty-text">ê³¼ëª© ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</div>
                        <div class="chart-empty-subtext">ê³¼ëª©ì„ ì¶”ê°€í•˜ë©´ ì§„ë„ìœ¨ì´ í‘œì‹œë©ë‹ˆë‹¤</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = subjects.map(subject => {
                const progress = Math.round((subject.completed / subject.total) * 100);
                const progressClass = progress < 40 ? 'low' : progress < 70 ? 'medium' : 'high';

                return `
                    <div class="progress-bar-item">
                        <div class="progress-bar-header">
                            <span class="progress-bar-label">${subject.name}</span>
                            <span class="progress-bar-value">${progress}%</span>
                        </div>
                        <div class="progress-bar-track">
                            <div class="progress-bar-fill ${progressClass}" style="width: ${progress}%"></div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Update Sync Status Dashboard
        function updateSyncStatus() {
            // Update sync status
            const syncIcon = document.getElementById('sync-icon');
            const syncStatusText = document.getElementById('sync-status-text');
            const lastSyncTime = document.getElementById('last-sync-time');

            if (syncIcon && syncStatusText && lastSyncTime) {
                syncIcon.textContent = 'âœ“';
                syncIcon.className = 'sync-status-icon success';
                syncStatusText.textContent = 'ì •ìƒ';
                lastSyncTime.textContent = 'ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ë°©ê¸ˆ ì „';
            }

            // Update sync success rate
            const syncSuccessRate = document.getElementById('sync-success-rate');
            const totalSyncs = document.getElementById('total-syncs');
            if (syncSuccessRate && totalSyncs) {
                const syncCount = parseInt(localStorage.getItem('syncCount') || '0') + 1;
                localStorage.setItem('syncCount', syncCount.toString());
                syncSuccessRate.textContent = '100%';
                totalSyncs.textContent = syncCount.toString();
            }

            // Update data size
            const dataSize = document.getElementById('data-size');
            if (dataSize) {
                const storageSize = JSON.stringify(studyData).length;
                const sizeKB = (storageSize / 1024).toFixed(2);
                dataSize.innerHTML = `ì €ì¥ëœ ë°ì´í„°: <span>${sizeKB}KB</span>`;
            }
        }

        // Set Score Date Range
        function setScoreDateRange(range) {
            currentScoreRange = range;

            // Update button states
            ['all', 'month', 'week'].forEach(r => {
                const btn = document.getElementById(`score-range-${r}`);
                if (btn) {
                    if (r === range) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                }
            });

            // Re-render chart
            initMockScoreChart(range);
        }

        // Export Chart as Image
        function exportChart(chartId) {
            const canvas = document.getElementById(chartId);
            if (!canvas) {
                showToast('ì°¨íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }

            try {
                const url = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.download = `${chartId}_${new Date().getTime()}.png`;
                link.href = url;
                link.click();
                showToast('ì°¨íŠ¸ ì´ë¯¸ì§€ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
            } catch (error) {
                console.error('Export error:', error);
                showToast('ì°¨íŠ¸ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤', 'error');
            }
        }

        // Initialize all charts
        function initAllCharts() {
            try {
                initSubjectTimeChart();
                initMockScoreChart(currentScoreRange);
                renderSubjectProgressBars();
                updateSyncStatus();
            } catch (error) {
                console.error('Chart initialization error:', error);
            }
        }


    </script>

    <!-- ================================================================ -->

</body>
</html>