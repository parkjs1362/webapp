<!DOCTYPE html>
<html lang="ko">
<!--
    ÏÇ¨Î≤ïÏãúÌóò ÌïôÏäµ ÏãúÏä§ÌÖú - Ï†ÑÎûµÏ†Å ÌïôÏäµ ÌîÑÎ†àÏûÑÏõåÌÅ¨
    Version: 3.3.0
    Last Updated: 2025-10-30

    Changes in v3.3.0 - Pomodoro Enhancement & UI Improvements:
    - ADDED: Pomodoro timer duration configuration
      * Users can now customize work time (1-120 minutes, default: 25)
      * Users can now customize break time (1-30 minutes, default: 5)
      * Settings modal with clear guidance and validation
      * Timer automatically uses configured durations
      * Settings persist across sessions
    - FIXED: Weekly stats display now shows actual study hours
      * Automatically calculates from studyHistory instead of manual entry
      * Displays real-time study hours for each day of the week
      * Removed manual editing feature (auto-calculation only)
      * Shows hours with decimal precision (e.g., 2.5h)
    - REMOVED: Achievement badges section
      * Deleted HTML container (achievement-badges)
      * Removed renderAchievementBadges function
      * Removed function calls from analytics
      * Cleaner dashboard with reduced visual clutter
    - IMPROVED: Dark mode text visibility for exam type tabs
      * Unselected exam type buttons now have better contrast
      * Light text color (70% opacity) for inactive buttons
      * Hover state with 90% opacity
      * Active state maintains full visibility
      * Better UX when switching between 1Ï∞®/2Ï∞® exams

    Changes in v3.2.1 - Cleanup of v3.0.0 Legacy Code:
    - REMOVED: v3.0.0 module loading warnings
      * Deleted v3.0.0 module load check script
      * Removed migration-v2-to-v3.js, sync-manager-v3.0.js, analytics-engine-v3.0.js references
      * Removed monitoring-v3.0.js (monitoring system)
    - REMOVED: v3.0.0 initialization code
      * Deleted initializeV3() function
      * Deleted setupV3Observers() function
      * Removed v3Data, syncMgr, analytics global variables
      * Removed updateV3Analytics() function
    - REMOVED: v3.0.0 integration overrides
      * Deleted toggleTimeBlock() v3 override
      * Deleted saveScore() v3 override
    - REMOVED: Sync badge (dynamic sync status display)
    - IMPROVED: Clean console output
      * No more v3.0.0 module load warnings
      * No more initialization warnings
      * Focus on v3.2.x features

    Changes in v3.2.0 - Complete Bidirectional Study Time Sync:
    - ENHANCED: Bidirectional sync between study blocks and study time
      * Study block modification now updates study time (edit time change)
      * Study block deletion from completed blocks removes from study time
      * Time difference automatically calculated and applied to total
    - IMPROVED: Study time & Pomodoro perfect integration
      * Study blocks: time added to timer when block is marked complete
      * Pomodoro: 25 minutes added to timer when work session completes
      * Time modifications instantly reflected in both components
      * All time sources (blocks + pomodoro) contribute to single study time
    - OPTIMIZED: Analytics refresh on all time modifications
      * renderAnalytics() called on block deletion for dashboard update
      * Complete real-time synchronization between UI components
    - FEATURES: Complete study tracking ecosystem
      * Manual time blocks (ÌïôÏäµ Ï†ÑÎûµ)
      * Pomodoro timer sessions
      * Study history tracking
      * All contributing to unified "Ïò§ÎäòÏùò ÌïôÏäµ ÏãúÍ∞Ñ"

    Changes in v3.1.5 - Core Metrics Removal & Pomodoro Sync:
    - REMOVED: Core metrics section (üéØ ÌïµÏã¨ Î©îÌä∏Î¶≠)
      * Deleted glassmorphism core metrics display from dashboard
      * Removed renderCoreMetrics function call from analytics
      * Cleaner dashboard interface without redundant metrics
    - FIXED: Pomodoro timer sync with study time
      * When pomodoro work session completes, automatically adds 25 minutes to study time
      * Study time display updates immediately after pomodoro completion
      * Dashboard analytics refresh to reflect new study time
      * Toast notification confirms time has been added to study tracker
    - IMPROVED: User experience
      * Pomodoro timer now contributes directly to total study time
      * Better visual feedback when pomodoro work sessions complete

    Changes in v3.1.4 - Complete Console Error Cleanup:
    - FIXED: renderSubjectTimeChart console warning
      * Removed console.warn message when chart container doesn't exist
      * Function silently returns if element is not found
    - FIXED: renderMockScoreChart console warning
      * Removed console.warn message when chart container doesn't exist
      * Function silently returns if element is not found
    - FIXED: renderMetacognitiveFeedback null reference errors
      * Added element existence checks at start of function
      * Early return if 'metacognitive-feedback' or 'motivation-message' elements don't exist
      * Updated all DOM references to use cached element variables
      * Fixed error handler to safely check element existence
    - COMPLETED: All page load console errors resolved
      * No more warnings about missing chart elements
      * No more null reference errors when updating deleted analytics section elements
      * Clean console output on page load

    Changes in v3.1.3 - Console Errors Fixed & Time Entry UI Improved:
    - FIXED: renderAnalytics null reference error
      * Removed references to deleted HTML elements (total-study-hours, avg-daily-hours, etc.)
      * Removed updateBenchmarkProgress call that referenced non-existent elements
      * Simplified function to only render actual dashboard components
    - FIXED: jumpToSection console errors
      * Removed onclick="jumpToSection(...)" from sticky progress bar metrics
      * No longer trying to navigate to non-existent sections
      * Sticky progress bar is now display-only (no navigation)
    - IMPROVED: Time entry UI for study plan
      * Changed from text input "06:00-08:00" to structured time inputs
      * Added separate "ÏãúÏûë ÏãúÍ∞Ñ" (start time) input with type="time"
      * Added separate "ÎÅù ÏãúÍ∞Ñ" (end time) input with type="time"
      * Automatic calculation of study hours from time difference
      * Better validation with error messages for time ranges
    - IMPROVED: User experience
      * Time input is now more intuitive with native time picker
      * Study hours are automatically calculated (no manual entry needed)
      * Cleaner console output without error messages

    Changes in v3.1.2 - Dashboard Tab System Removal:
    - REMOVED: Dashboard navigation tabs
      * Deleted üìã Í∞úÏöî, üìÖ Í≥ÑÌöç, üìà Ï∂îÏ†Å, üìä Î∂ÑÏÑù tabs
      * Removed tab navigation UI completely
      * Simplified dashboard layout by eliminating tab switching
    - REMOVED: Today's notes section
      * Deleted üìù Ïò§ÎäòÏùò ÌïôÏäµ ÎÖ∏Ìä∏ card entirely
    - FIXED: Console warnings for missing sections
      * Removed sectionMap from switchTab function
      * Removed sectionToTabMap from jumpToSection function
      * Simplified jumpToSection to only scroll to element
      * Fixed warning messages (warn ‚Üí error for missing sections)
    - IMPROVED: Error handling
      * jumpToSection now only handles scrolling (tabs removed)
      * Better error reporting when elements not found
      * Cleaner console output without tab-related messages

    Changes in v3.1.1 - Timer UI Consolidation:
    - MERGED: Combined study time and pomodoro timer cards into single unified card
      * Integrated "Ïò§ÎäòÏùò ÌïôÏäµ ÏãúÍ∞Ñ" and "Ìè¨Î™®ÎèÑÎ°ú ÌÉÄÏù¥Î®∏" into one card
      * Study hours section displayed at top with timer, controls, and weekly stats
      * Pomodoro timer section displayed below with session tracking
      * Used CSS Grid for clean two-row layout with visual separator
      * Maintained all existing functionality and button IDs
      * Improved dashboard organization and reduced visual clutter

    Changes in v3.1.0 - Major Dashboard Simplification:
    - REMOVED: Detailed analytics section
      * Eliminated detailed statistics grid (Ï¥ù ÌïôÏäµ ÏãúÍ∞Ñ, ÏùºÌèâÍ∑†, Ï†ÑÏ≤¥ ÏßÑÎèÑÏú®, Î™®ÏùòÍ≥†ÏÇ¨ ÌèâÍ∑†)
      * Removed learning curve analysis visualization
      * Removed metacognitive feedback section
      * Removed efficiency analysis metrics
      * Removed data sync status dashboard
      * Removed data visualization charts from collapsible section
    - REMOVED: Goals management section
      * Deleted goal setting card from dashboard
      * Removed goal modal and all goal management UI
      * Simplified user interface by eliminating goal tracking features
    - IMPROVED: Dashboard focus
      * Cleaner, more minimal interface
      * Focus on essential learning information
      * Reduced information overload for better user experience
    - TECHNICAL: Cleaned up related function calls
      * Removed renderGoals() calls from initialization
      * Removed renderDashboardAnalytics() call
      * Removed renderWeakSubjectsAnalysis() and renderStrongSubjectsAnalysis() calls

    Changes in v3.0.9 - Dashboard Cleanup & Chart Enhancement:
    - REMOVED: "Ïò§ÎäòÏùò ÌïôÏäµ Ïö∞ÏÑ†ÏàúÏúÑ (AI Ï∂îÏ≤ú)" section
      * Simplified dashboard by removing redundant AI recommendations
      * Reduced cognitive load with focused core information
    - REMOVED: "Í≥ºÎ™©Î≥Ñ ÏßÑÎèÑÏú®" visualization section
      * Consolidated progress tracking to essential metrics
      * Cleaner dashboard layout for better focus
    - IMPROVED: Subject time distribution chart visibility
      * Increased font sizes (0.8rem ‚Üí 0.95rem for labels, 0.75rem ‚Üí 0.9rem for values)
      * Added minimum bar height (40px) for better visibility
      * Enhanced spacing and visual hierarchy with improved margins
      * Added shadow effects for depth perception
      * Better color contrast with dark text on gradients
    - IMPROVED: Dashboard information hierarchy
      * Removed duplicate progress information
      * Focus on core metrics and essential visualizations

    Changes in v3.0.8 - Bug Fixes & UI Improvements:
    - FIXED: Chart rendering element ID mismatches
      * Added missing container divs with correct IDs (subject-time-chart, mock-score-chart)
      * Resolved console warnings about missing chart elements
    - FIXED: Modal functionality for all add/edit operations
      * Ensured proper global variable declarations (editingBlockId, editingScoreId, editingGoalId)
      * Fixed add mode to reset editing state properly
      * Fixed edit mode to use correct variable names and field mappings
    - IMPROVED: Dashboard data visualization
      * Charts now render correctly in their designated containers
      * Removed unused canvas elements that conflicted with bar chart rendering

    Changes in v3.0.7 - UI/UX Enhancement & Cognitive Load Reduction:
    - ADDED: Core metrics dashboard (3 key indicators only)
      * Overall progress percentage
      * Expected completion date (D-day format)
      * Learning efficiency index (0-100)
    - ADDED: Collapsible detailed analytics section
      * Reduced cognitive load by hiding secondary metrics
      * Toggle button for expanding/collapsing detailed stats
    - ADDED: Today's Goals section with AI recommendations
      * Prioritized study recommendations based on progress
      * Weak subject (progress <50%)
      * Mid-level subject (progress 50-70%)
      * Strong subject (progress >70%)
      * Concrete action items for each subject
    - ADDED: Achievement badge system for motivation
      * "3Ïùº Ïó∞ÏÜç" badge (consecutiveDays >= 3)
      * "Ï£ºÍ∞Ñ Íæ∏Ï§ÄÌï®" badge (weeklyStudyDays >= 5)
      * "ÏõîÍ∞Ñ Î™©Ìëú" badge (monthlyHours >= 80)
      * "ÏïΩÏ†ê Ï†ïÎ≥µ" badge (weak subject progress >= 50%)
    - IMPROVED: Information hierarchy for better UX
      * Critical info at top, detailed analysis below
      * Clear visual separation between sections
      * Reduced information overload on main dashboard

    Changes in v3.0.6 - Time Block Save Fix & Input Validation:
    - FIXED: Time block save issue
      * Added placeholder option "Í≥ºÎ™©ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî" to select dropdown
      * Added required attribute to subject select
      * Improved validation messages with clear instructions
    - ADDED: Better error feedback
      * Toast notifications for missing fields (ÏãúÍ∞ÑÎåÄ, Í≥ºÎ™©, ÌïôÏäµ ÎÇ¥Ïö©)
      * Each field now shows specific error message
      * User guidance: "Ïòà: 06:00-08:00" for time format
    - IMPROVED: Form UX
      * Required fields now clearly marked
      * Error messages appear as toast notifications
      * Prevents accidental empty submissions

    Changes in v3.0.5 - Enhanced Dashboard Features & Dark Mode Polish:
    - ADDED: Dashboard analytics with 4 new metrics
      * Efficiency Score (ÏãúÍ∞Ñ ÎåÄÎπÑ Ìö®Ïú®ÏÑ± ÏßÄÏàò, 0-100)
      * Weekly Study Days (Ï£ºÍ∞Ñ ÌïôÏäµÏùº Ï∂îÏ†Å)
      * Weak Subjects Analysis (ÏßÑÎèÑÏú® 50% ÎØ∏Îßå Í≥ºÎ™© ÌëúÏãú)
      * Strong Subjects Analysis (ÏßÑÎèÑÏú® 80% Ïù¥ÏÉÅ Í≥ºÎ™© ÌëúÏãú)
    - FIXED: Dark mode styling for "Ìï©Í≤©Ïûê ÌèâÍ∑†" and "Ìï©Í≤©Ïûê Ï°∞Ïñ∏" sections
      * Background color now dark gray (#2d2d2d) in dark mode
      * Text color adjusted for readability (white)
      * Section title color properly styled
    - IMPROVED: Dashboard display with color-coded progress bars
      * Green for excellent (‚â•80% efficiency)
      * Blue-green for good (‚â•50% efficiency)
      * Orange-yellow for needs improvement (<50% efficiency)

    Changes in v3.0.4 - Learning Curve & Dark Mode Text Visibility:
    - FIXED: NaN ÏóêÎü¨ in learning curve analysis (actualStudyDays validation)
      * Added safe day calculation (default to 1 if undefined)
      * Proper handling of zero completed problems
      * Fixed remaining problems calculation
    - FIXED: Dark mode text visibility issues
      * All analytics labels now explicitly white in dark mode
      * Analytics values display correctly (removed gradient on dark mode)
      * Cards have proper background (#1a1a1a) and text colors
      * Form elements, buttons, modals all optimized for dark mode
    - IMPROVED: Learning curve display
      * "Í≥ÑÏÇ∞ Ï§ë" shows when pace can't be calculated
      * "ÏôÑÎ£å!" shows when all problems are finished
      * Dash "-" shows for zero pace instead of NaN
      * Days display with validation

    Changes in v3.0.3 - Dark Mode UI Improvements:
    - FIXED: Dark mode now applies to entire page background (body + html)
    - IMPROVED: Enhanced dark mode colors for better visibility
      * Background: Pure black (#000000) for main area
      * Cards: Dark gray (#1a1a1a) for better contrast
      * Text: Pure white (#ffffff) for maximum readability
      * Text secondary: Light gray (#d1d1d6) - WCAG AAA compliant (7.1:1)
    - ADDED: Explicit dark mode styling for form elements
      * Input fields: #2d2d2d background with white text
      * Buttons: Adjusted for dark mode visibility
      * Modals: #1a1a1a background for consistency
      * Time blocks: Dark mode colors applied
      * Progress bars: Enhanced visibility in dark mode
    - FEATURE: Full page dark mode transformation (not just cards)

    Changes in v3.0.2 - Learning Curve Analysis & Metacognitive Feedback:
    - ADDED: Learning curve analysis with automatic completion date prediction
      * Calculates current learning pace (problems/day)
      * Predicts completion date based on remaining problems
      * Displays days remaining and learning velocity
    - ADDED: Metacognitive feedback system with context-aware insights
      * Interprets progress percentage with positive reinforcement
      * Provides efficiency metrics (hours per problem, problems per day)
      * Delivers personalized motivation messages based on progress level
      * Shows consistency feedback for learning duration
    - IMPROVED: Analytics dashboard with dual new cards
      * Blue card for learning curve predictions
      * Green card for motivational feedback
    - FEATURE: D-day style countdown for exam preparation

    Changes in v3.0.1 - Critical Bug Fix for Exam Type Selection:
    - FIXED: Exam type buttons (1Ï∞®/2Ï∞®) now properly update all UI components
    - FIXED: Added missing UI refresh calls to setExamType() function
      * updateDDay() - D-day counters now refresh on exam type change
      * renderTimeBlocks() - Time blocks update with correct subjects
      * renderWeeklyStats() - Weekly statistics refresh properly
      * renderMockScores() - Mock exam scores display updates
      * renderAnalytics() - Analytics dashboard refreshes
    - IMPROVED: Added console logging for better debugging
    - IMPROVED: Added comprehensive inline comments explaining each UI update
    - NOTE: Buttons were executing but UI wasn't refreshing, making them appear broken

    Changes in v3.0.0 - Data Normalization & Intelligent Learning Analytics:
    - CRITICAL: Complete data normalization with 7 Entity schema (User, StudyPlan, Subject, TimeBlock, StudyLog, MockExam, LearningHistory)
    - CRITICAL: Implemented automatic synchronization using Observer pattern with Cascade Update
    - CRITICAL: Added intelligent learning analytics engine with efficiency scoring and personalized recommendations
    - ADDED: DataMigration module for v2.14.0 ‚Üí v3.0.0 automatic conversion with 100% data preservation
    - ADDED: SyncManager for complete automatic data synchronization (no manual updates needed)
    - ADDED: AnalyticsEngine for comprehensive learning analysis (daily/weekly/monthly statistics, weak subject identification, smart recommendations)
    - IMPROVED: All data relationships now explicitly defined with foreign keys
    - IMPROVED: Automatic cascade updates when timeBlock is completed (StudyLog ‚Üí Subject ‚Üí Plan ‚Üí History)
    - ENHANCED: User-centric data design reflecting actual learning workflows
    - VERIFIED: Full backward compatibility with v2.14.0 (auto-migration with rollback support)
    - PERFORMANCE: No storage increase despite normalization (optimized structure)
    - DOCUMENTATION: Complete design docs (DATA_SCHEMA_v3.0.md, IMPLEMENTATION_GUIDE_v3.0.md)

    **Key Improvements in v3.0.0**:
      ‚úÖ 7Í∞ú Ï†ïÍ∑úÌôî EntityÎ°ú Î™ÖÌôïÌïú Îç∞Ïù¥ÌÑ∞ Í¥ÄÍ≥Ñ Ï†ïÏùò
      ‚úÖ ÏôÑÏ†Ñ ÏûêÎèôÌôîÎêú Îç∞Ïù¥ÌÑ∞ ÎèôÍ∏∞Ìôî (Observer Pattern)
      ‚úÖ AI Í∏∞Î∞ò ÌïôÏäµ Ìö®Ïú®ÏÑ± Î∂ÑÏÑù (0-100 Ï†êÏàò)
      ‚úÖ Ï∑®ÏïΩÏ†ê ÏûêÎèô ÏãùÎ≥Ñ Î∞è ÎßûÏ∂§Ìòï Í∞úÏÑ†Ïïà Ï†úÏãú
      ‚úÖ v2.14.0 Îç∞Ïù¥ÌÑ∞ 100% Ìò∏Ìôò Î∞è ÏûêÎèô ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò
      ‚úÖ Í≥ÑÌöç vs Ïã§Ï†ú ÌïôÏäµ ÏûêÎèô ÎπÑÍµê
      ‚úÖ ÏòàÏÉÅ ÏôÑÎ£åÏùº ÏûêÎèô Í≥ÑÏÇ∞
      ‚úÖ ÌïôÏäµ Ìå®ÌÑ¥ Î∂ÑÏÑù Î∞è ÏµúÏ†ÅÌôî Ï†úÏïà

    Changes in v2.14.0 - Complete Daily Data Isolation & Integration:
    - CRITICAL: Added `date` field to timeBlocks when creating new blocks
    - FIXED: "Ïò§ÎäòÏùò ÌïôÏäµ Ï†ÑÎûµ" card now shows only TODAY's blocks (date filtering)
    - IMPROVED: Empty state message when no blocks exist for today
    - REFACTORED: toggleTimeBlock() now auto-populates studyHistory on completion
    - FIXED: Analytics calculations use correct date field (block.date, not block.time)
    - IMPROVED: Streak calculation filters timeBlocks by today's date
    - ADDED: Comprehensive DATA_FLOW_ARCHITECTURE.md documentation
    - VERIFIED: All data entity relationships mapped and validated
    - TESTED: Complete data flow from creation ‚Üí storage ‚Üí display ‚Üí update
    - NOTE: Data isolation achieved without daily resets; historical data preserved

    **Key Features**:
      ‚úÖ Daily blocks isolated by date (show only today's blocks)
      ‚úÖ studyHistory auto-populated when blocks completed
      ‚úÖ Charts update automatically on all data changes
      ‚úÖ Sync status displays correctly on initial load
      ‚úÖ Streak calculation uses correct date filtering
      ‚úÖ All analytics use proper data sources
      ‚úÖ Complete documentation of data flows and relationships

    Changes in v2.13.2 - Critical Data Synchronization & Dashboard Fix:
    - FIXED: "Ï†ÄÏû•Îêú Îç∞Ïù¥ÌÑ∞: Í≥ÑÏÇ∞ Ï§ë..." stuck display - added updateSyncStatus() to init()
    - FIXED: Charts not updating on initial page load - reordered initialization sequence
    - FIXED: Data changes not reflecting in charts - moved saveData() wrapper before init()
    - IMPROVED: Proper initialization lifecycle (DOMReady ‚Üí setupCharts ‚Üí wrapFunctions ‚Üí init ‚Üí updateCharts)
    - REFACTORED: Removed duplicate function wrapping and initialization code
    - IMPROVED: Consolidated DOMContentLoaded handler with all initialization logic
    - NOTE: Charts now display data immediately on page load + update on all data changes

    Changes in v2.13.1 - Chart Data Rendering Fix & Sample Data Optimization:
    - FIXED: Empty chart data issue by ensuring updateSubjectsByExamType() is called
    - FIXED: Added safety checks to preserve sample data (timeBlocks, mockScores) on page load
    - FIXED: Ensured charts update when exam type is switched
    - IMPROVED: Chart initialization with proper timing and data validation
    - NOTE: All 4 visualization types now render correctly with sample data
      * Subject Time Distribution (Doughnut Chart)
      * Mock Exam Score Trend (Line Chart with average line)
      * Subject Progress Bars (Animated progress indicators)
      * Sync Status Dashboard (Connection monitoring)

    Changes in v2.13.0 - Advanced Data Visualization Dashboard with Chart.js:
    - CRITICAL: Integrated Chart.js v4.4.1 for professional data visualization
      * High-performance rendering with Canvas API
      * Apple-inspired color palette and animations
      * Full dark mode support with dynamic theme switching
      * Responsive charts for all screen sizes
    - ADDED: Data Sync Status Dashboard (Real-time Connection Monitoring)
      * Visual status indicators with icon + color coding
      * Last sync timestamp display
      * Sync success rate percentage
      * Real-time status updates
    - ADDED: Subject Study Time Distribution Chart (Doughnut)
      * Interactive doughnut chart with hover tooltips
      * Color-coded subjects with legend
      * Percentage and hour display
      * Animated transitions with Apple easing
      * Click-to-filter functionality
    - ADDED: Mock Exam Score Trend Chart (Line)
      * Multi-line comparison with trend analysis
      * Time-based X-axis (date/week/month)
      * Average line indicator
      * Interactive data points with tooltips
      * Responsive legend and axis labels
    - ADDED: Subject Progress Visualization (Animated Progress Bars)
      * Horizontal progress bars with animations
      * Color-coded status (red: <40%, orange: 40-70%, green: >70%)
      * Percentage labels and subject names
      * Smooth fill animations on load
    - ENHANCED: Chart interactivity and UX
      * Hover effects with detailed tooltips
      * Drill-down capability for detailed views
      * Date range selector for trend charts
      * Export chart as image functionality
    - OPTIMIZED: Performance and accessibility
      * Lazy loading for chart rendering
      * ARIA labels for screen readers
      * Keyboard navigation support
      * Reduced motion support for accessibility
    - DESIGNED: Apple-inspired visual system
      * SF Pro font family for consistency
      * Apple Blue (#0071e3) primary color
      * Subtle shadows (0.04-0.08 opacity)
      * 24px border radius for cards
      * Glassmorphism effects for overlays

    Changes in v2.12.0 - Apple.com Inspired Design System (2024-2025):
    - CRITICAL: Complete design system overhaul with Apple.com aesthetic
      * Color System: Apple's refined palette (light: #fbfbfd, dark: #000000)
      * Typography: San Francisco-inspired font stack with 17px base size
      * Spacing: 12px/16px base system with generous whitespace (64px-96px)
      * Shadows: Ultra-subtle approach (0.04-0.08 opacity)
      * Border Radius: Larger, more modern (16px-28px)
    - REDESIGNED: Typography system following Apple standards
      * Line heights: 1.0833 (headlines), 1.47 (body text)
      * Letter spacing: -0.01em for large text
      * Font smoothing: antialiased rendering
      * Font weights: 300-700 range with proper hierarchy
    - ENHANCED: Animation system with Apple's signature easing
      * Easing function: cubic-bezier(0.28, 0.11, 0.32, 1)
      * Duration: 400ms-600ms for premium feel
      * Smooth scroll: Native smooth scrolling enabled
      * Reduced motion: Full accessibility support
    - IMPROVED: Component styling with modern effects
      * Cards: Larger radius (24px), subtle hover (scale 1.01, translateY -3px)
      * Buttons: Pill shape (border-radius: 9999px), micro-interactions
      * Modals: Glassmorphism with backdrop blur (10px-20px)
      * Header: Minimal design with hover effects
    - POLISHED: Dark mode with Apple's pure black approach
      * Background: #000000 (pure black) instead of gray
      * Cards: #161617 (subtle gray) for depth
      * Text: #f5f5f7 (off-white) for readability
      * Accent: #2997ff (brighter blue) for dark mode
    - ADDED: Modern web design trends (2024-2025)
      * Smooth transitions: All elements use Apple easing
      * Micro-interactions: Button hover/active states
      * Glassmorphism: Modal backdrops with blur
      * Generous whitespace: Container padding 64px-96px
    - OPTIMIZED: CSS Variables for consistency
      * 12 font sizes (11px-80px range)
      * 5 font weights (300-700)
      * 4 line heights (1.08-1.625)
      * 10 spacing scales (4px-96px)
      * 6 border radius options (10px-28px)

    Changes in v2.11.0 - Single Column Layout Optimization (User Preference):
    - CRITICAL: Changed layout from multi-column to single-column for better usability
      * Dashboard grid: 3-column ‚Üí 1-column layout
      * Removed card max-width constraint (450px ‚Üí 100%)
      * Simplified grid breakpoints (gap only, no column changes)
      * Today's plan: removed grid-column span settings
    - SIMPLIFIED: Responsive design now focuses on gap adjustments only
      * Desktop: 24px gap
      * Tablet: 20px gap
      * Mobile: 16px gap
      * Small mobile: 12px gap
    - IMPROVED: User convenience with full-width cards
      * Cards now stretch to full container width
      * Better readability on all screen sizes
      * Cleaner, more linear content flow
      * No more horizontal scanning needed

    Changes in v2.10.0 - Apple/Google Design System Layout Optimization:
    - CRITICAL: Container max-width reduced from 1400px to 1280px (Apple standard)
      * Optimal reading width for 24-27" monitors
      * Improved text readability with proper line length
      * Better visual focus and content hierarchy
    - REDESIGNED: Dashboard grid system with fixed column-based layout
      * Desktop (>1280px): 3-column grid with 24px gap
      * Tablet (769-1024px): 2-column grid with 20px gap
      * Mobile (481-768px): 2-column grid with 16px gap
      * Small mobile (<480px): 1-column grid with 12px gap
      * Changed from auto-fit minmax(320px, 1fr) to fixed column counts
    - ENHANCED: Card maximum width constraint (450px)
      * Prevents cards from stretching excessively on wide screens
      * Maintains optimal text line length (50-75 characters)
      * Cards centered within grid cells with justify-items: center
      * Google Material Design 3 compliant card sizing
    - IMPROVED: Responsive padding system with percentage-based values
      * Desktop: 40px + 5% side margins
      * Tablet: 32px + 4% side margins
      * Mobile: 24px + 4% side margins
      * Small mobile: 16px + 4% side margins
    - OPTIMIZED: Visual hierarchy and spacing consistency
      * Professional grid gaps: 24px (desktop), 20px (tablet), 16px (mobile), 12px (small)
      * Better balance between content and whitespace
      * Improved scan-ability and information architecture
    - DESIGN RATIONALE: Based on Apple.com and Google Material Design 3 standards
      * Apple: 1280px container, 480px max card width, 5-8% side margins
      * Google: 1200px container, 500px max card width, 4-column grid system
      * Hybrid approach: 1280px container + 450px cards + 3-column grid

    Changes in v2.9.0 - Advanced Responsive Design & Layout Optimization:
    - CRITICAL: Implemented comprehensive responsive design for Desktop, Tablet, and Mobile
      * Dashboard grid minmax optimized: 320px-1fr for better wrapping
      * Tablet breakpoint (769px-1024px): 2-column layout for optimal viewing
      * Mobile breakpoint (768px): Full responsive with 1-column layout
      * Extra small breakpoint (480px): Compact layout with minimal spacing
    - REDESIGNED: Form elements for mobile accessibility
      * Input fields with proper padding and 16px font size (iOS zoom prevention)
      * Enhanced focus states with visible outlines
      * Placeholder color accessibility improvements
      * Modal buttons with flex layout for better mobile touch
    - ENHANCED: Time-block layout with improved responsiveness
      * Time-block cards with hidden action buttons on desktop (hover reveal)
      * Always visible action buttons on mobile for better UX
      * Responsive grid: 2-column (tablet), 1-column (mobile)
      * Improved padding with CSS variables (var(--spacing-*))
    - IMPROVED: Subject rotation display
      * Flex-wrap support for better responsive behavior
      * Mobile layout: stacked subject names and rotation circles
      * Improved rotation circle sizing (32px) with better touch targets
      * Better font sizing for mobile devices
    - POLISHED: Today's plan section
      * Desktop: 2-column span, Tablet/Mobile: 1-column
      * Minmax reduction for better mobile wrapping
      * Consistent spacing throughout
    - OPTIMIZED: Data management card styling
      * Mobile: Full-width button layout (1-column)
      * Smaller padding and font sizes for mobile
      * Better text contrast with reduced opacity
      * Improved button sizing for touch devices
    - FIXED: Text overflow issues
      * Added word-wrap and overflow handling
      * Modal content max-height with scroll for long forms
      * Better line-height and text sizing consistency
      * Improved card header flex-direction for mobile stacking
    - ENHANCED: Notes section responsiveness
      * Proper textarea min-height and padding
      * Toolbar improved with space-between layout
      * Mobile-optimized toolbar alignment
      * Better visual feedback with transitions

    Changes in v2.8.0 - Comprehensive UX/UI Refinement & Accessibility Enhancement:
    - CRITICAL: Fixed dark mode modal support - all modals now properly use CSS variables
      * Modal background now uses var(--bg-primary) for proper dark mode rendering
      * Form inputs and modals fully responsive to dark mode theme
    - CRITICAL: Enhanced accessibility with proper touch targets
      * Increased action button sizes from 28px to 36px (desktop) and 44px (mobile)
      * Improved keyboard navigation and focus states
    - CRITICAL: Reorganized z-index hierarchy for proper modal layering
      * Fixed modal stacking order when multiple modals are opened
      * Proper backdrop layering with blur effects
    - REDESIGNED: Improved layout consistency and spacing system
      * Standardized all padding/margin to use CSS variables
      * Fixed D-Day card container with CSS grid for better responsiveness
      * Enhanced score entry layout with flexbox for better content flow
    - ENHANCED: Mobile responsiveness improvements
      * Added 480px breakpoint for small mobile devices
      * Improved analytics grid and weekly stats responsive behavior
      * Better touch target positioning on smaller screens
      * Theme toggle button repositioned for mobile clarity
    - IMPROVED: Visual hierarchy and semantic styling
      * Reduced motion support with prefers-reduced-motion media query
      * Better focus-visible states for keyboard navigation
      * Enhanced empty state designs with clear user guidance
      * Improved data management card contrast with backdrop filter
    - POLISHED: Overall accessibility and user experience
      * Added ARIA labels to interactive elements
      * Better semantic HTML structure for score entries
      * Smooth transitions with cubic-bezier timing functions
      * Complete dark mode support for all themed components

    Changes in v2.7.0 - Professional UX/UI Redesign & Dark Mode Fixes:
    - CRITICAL: Fixed dark mode implementation - all components now properly support dark theme
      * Fixed .header and .card to use CSS variables instead of hardcoded white background
      * Fixed all buttons, inputs, and interactive elements for proper dark mode support
      * Enhanced color contrast ratios for better readability in dark mode
    - REDESIGNED: Analytics dashboard with professional card-based layout
      * Enhanced visual hierarchy with gradient backgrounds and depth effects
      * Improved spacing and typography for better readability
      * Added subtle shadows and hover effects for better interactivity
    - ENHANCED: Benchmark progress bars with improved visual design
      * Larger, more prominent progress bars (12px height)
      * Better color coding: green (excellent), blue (good), orange/red (needs improvement)
      * Added percentage labels for instant comprehension
      * Improved animations and transitions
    - IMPROVED: Color system consistency across light and dark modes
      * Unified color palette using CSS variables throughout
      * Better semantic color usage (success, warning, danger)
      * Enhanced accessibility with WCAG-compliant contrast ratios
    - POLISHED: Overall design language and visual consistency
      * Modern card designs with subtle gradients
      * Consistent spacing system (8px base unit)
      * Professional typography hierarchy
      * Smooth transitions and micro-interactions

    Changes in v2.6.0 - Dashboard UX Redesign & Benchmark Integration:
    - REMOVED: "Ïò§ÎäòÏùò ÌïôÏäµ Ï∂îÏ≤ú" section for cleaner interface
    - REMOVED: "ÏßëÏ§ë ÌïÑÏöî Í≥ºÎ™©" section to reduce clutter
    - ADDED: Benchmark comparison bars in analytics dashboard
      * Total study hours benchmark: 800-1200h for exam preparation
      * Daily average benchmark: 4-5h/day target
      * Mock exam benchmark: 60 points (passing grade)
      * Progress bars with color-coded indicators (green/blue/orange based on performance)
    - ENHANCED: Analytics dashboard now shows user's position vs. exam pass standards
      * Visual progress bars with animated shimmer effect
      * Responsive color coding based on achievement level
      * Real-time benchmark comparison updates
    - IMPROVED: Overall dashboard layout and visual hierarchy
    - CLEANED: Removed unnecessary backup files and temporary scripts

    Changes in v2.5.0 - Analytics Enhancement, Dark Mode & UX Improvements:
    - CRITICAL: Fixed analytics dashboard to use REAL user data instead of sample data
      * Subject time distribution now calculates from actual time blocks, timer, and progress
      * Mock exam score chart displays real user scores, not hardcoded samples
      * All metrics (total hours, daily average, overall progress) based on actual data
    - Implemented complete DARK MODE with smooth transitions
      * Toggle switch in header with moon/sun icon
      * Dark color palette with proper contrast ratios
      * Saved to localStorage with auto-load on page load
      * All components styled for dark mode (cards, modals, buttons, charts)
    - Enhanced subject focus logic ("ÏßëÏ§ë ÌïÑÏöî Í≥ºÎ™©")
      * Priority based on progress percentage, rotation count, and mock exam performance
      * Clear visual indicators (red/orange/yellow badges)
      * Sorted by actual priority (lowest progress first)
      * Shows success message when all subjects on track
    - Added professional SVG-based favicon (book with checkmark icon)
    - Updated all "Î≤ïÎ¨¥ÏÇ¨" references to "ÏãúÌóò" for generic exam tracking
    - Improved chart visualizations with better animations and responsiveness
    - Enhanced real-time analytics updates when user adds data
    - Better error handling and edge case management
    - Optimized performance for chart rendering

Changes in v2.4.0 - Professional Design System & Data Management (ACTUAL IMPLEMENTATION):
    - CRITICAL: Added comprehensive Import/Export functionality for all study data
      * Export data to JSON file (study-data-YYYY-MM-DD.json)
      * Import data with validation and preview modal
      * Automatic backup to session storage before import
      * Comprehensive error handling and recovery
    - Implemented dedicated Data Management section with gradient card design
    - Enhanced CSS design system with complete color palette and spacing variables
    - Added import preview modal with detailed data statistics
    - Improved button system with glassmorphism effects for data management
    - Enhanced mobile responsiveness with 56px/60px touch targets for data buttons
    - Added loading states and smooth animations for import/export operations
    - Implemented professional typography scale and spacing system
    - Enhanced accessibility with better focus states and ARIA labels
    - Added comprehensive data validation and error handling
    - Improved visual hierarchy with gradient backgrounds for data management
    - Better user feedback with toast notifications for all operations

    Changes in v2.3.0 - UX/UI Major Upgrade:
    - CRITICAL: Completely replaced all alert()/prompt()/confirm() with modern modal dialogs
    - Added separate D-day counters for both 1Ï∞® and 2Ï∞® exams with editable dates
    - Implemented visual urgency indicators (color changes as exam approaches)
    - Added comprehensive toast notification system (non-blocking, auto-dismiss)
    - Modal-based editing for ALL operations (subject progress, time blocks, mock scores, goals)
    - All edit forms now show multiple fields in ONE modal (no more sequential prompts)
    - Enhanced keyboard shortcuts (ESC to close modals, better accessibility)
    - Improved mobile responsiveness with better touch targets
    - Added form validation with clear error messages
    - Better visual feedback for all user actions
    - Removed redundant Pomodoro timer (regular timer serves same purpose)
    - Improved loading states and error handling throughout

    Changes in v2.2.0:
    - Added Pomodoro timer (25min work / 5min break) with visual & audio notifications
    - Enhanced time block completion to use actual hours instead of hardcoded 2 hours
    - Added customizable target problem count per subject
    - Added hours field to time blocks for accurate time tracking
    - Corrected 2Ï∞® exam subjects based on official Î≤ïÎ¨¥ÏÇ¨ exam structure
    - Removed study mode selector (ÏßÅÏû•Ïù∏/Ï†ÑÏóÖ/Ï£ºÎßêÏ†ÑÏÇ¨ modes)
    - Improved UX with better time tracking and progress customization

    Changes in v2.1.0:
    - Added comprehensive Study Analytics Dashboard with visual charts
    - Added Goal Setting & Milestone tracking system
    - Added Weak Subject Identifier with priority recommendations
    - Added Study Streak Tracker with gamification elements
    - Added Smart Study Recommendations based on patterns
    - Enhanced UI with collapsible sections and improved data visualization

    Changes in v2.0.0:
    - Added support for 2Ï∞® (secondary) exam subjects
    - Fixed subject progress editing functionality
    - Fixed mock exam score delete functionality (always visible now)
    - Fixed study strategy (time blocks) edit/delete functionality
    - Improved event handlers to use proper onclick bindings
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏãúÌóò Ï†ÑÎûµÏ†Å ÌïôÏäµ ÏãúÏä§ÌÖú (1Ï∞®/2Ï∞®) v3.0.0</title>
    <!-- Favicon: Book with checkmark icon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect x='20' y='15' width='60' height='70' rx='3' fill='%233182CE'/%3E%3Cpath d='M25 20h50v60H25z' fill='%23fff'/%3E%3Cpath d='M30 30h40M30 40h35M30 50h40M30 60h30' stroke='%233182CE' stroke-width='2' fill='none'/%3E%3Ccircle cx='75' cy='75' r='18' fill='%2348BB78'/%3E%3Cpath d='M67 75l6 6 12-12' stroke='%23fff' stroke-width='3' fill='none'/%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect x='20' y='15' width='60' height='70' rx='3' fill='%233182CE'/%3E%3Cpath d='M25 20h50v60H25z' fill='%23fff'/%3E%3Cpath d='M30 30h40M30 40h35M30 50h40M30 60h30' stroke='%233182CE' stroke-width='2' fill='none'/%3E%3Ccircle cx='75' cy='75' r='18' fill='%2348BB78'/%3E%3Cpath d='M67 75l6 6 12-12' stroke='%23fff' stroke-width='3' fill='none'/%3E%3C/svg%3E">
    <!-- Chart.js v4.4.1 - Data Visualization Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Smooth scrolling - Apple style */
        html {
            scroll-behavior: smooth;
        }

        /* Reduced motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }
        
        :root {
            /* ============================================
               APPLE.COM INSPIRED DESIGN SYSTEM (2024-2025)
               ============================================ */

            /* Primary Font Stack - San Francisco inspired */
            --font-primary: -apple-system, BlinkMacSystemFont, "SF Pro Display",
                            "SF Pro Text", "Segoe UI", "Pretendard",
                            "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;

            /* Apple Light Mode Colors */
            --bg-primary: #fbfbfd;          /* Softer than pure white */
            --bg-secondary: #ffffff;        /* Pure white for cards */
            --bg-tertiary: #f5f5f7;         /* Subtle gray background */
            --bg-light: #fbfbfd;
            --bg-dark: #1A202C;

            --text-primary: #1d1d1f;        /* Apple's softer black */
            --text-secondary: #6e6e73;      /* Medium gray */
            --text-tertiary: #86868b;       /* Light gray */
            --text-light: #FFFFFF;

            /* Apple Color Palette */
            --primary-color: #1d1d1f;
            --primary-dark: #000000;
            --primary-light: #6e6e73;

            --accent-color: #0071e3;        /* Apple Blue */
            --accent-dark: #006edb;
            --accent-light: #0077ed;
            --accent-hover: #0077ed;

            --success-color: #30d158;       /* Apple Green */
            --success-dark: #28a745;
            --success-light: #4de072;

            --warning-color: #ff9f0a;       /* Apple Orange */
            --warning-dark: #e68900;
            --warning-light: #ffb340;

            --danger-color: #ff3b30;        /* Apple Red */
            --danger-dark: #e6342a;
            --danger-light: #ff6259;

            --info-color: #007aff;          /* Apple Info Blue */

            /* Borders & Dividers - Very subtle */
            --border-color: rgba(0, 0, 0, 0.06);
            --border-light: rgba(0, 0, 0, 0.04);
            --border-dark: rgba(0, 0, 0, 0.12);
            --border-hover: rgba(0, 0, 0, 0.12);

            /* Shadows - Apple's subtle approach */
            --shadow-sm: 0 1px 4px rgba(0, 0, 0, 0.04);
            --shadow-md: 0 2px 10px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 4px 20px rgba(0, 0, 0, 0.06);
            --shadow-xl: 0 8px 40px rgba(0, 0, 0, 0.08);
            --shadow-2xl: 0 12px 60px rgba(0, 0, 0, 0.1);

            /* Spacing Scale - Apple uses 12px/16px base */
            --spacing-2xs: 4px;
            --spacing-xs: 8px;
            --spacing-sm: 12px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --spacing-2xl: 48px;
            --spacing-3xl: 64px;
            --spacing-4xl: 80px;
            --spacing-5xl: 96px;

            /* Typography Scale - Apple inspired */
            --font-size-2xs: 0.6875rem;     /* 11px */
            --font-size-xs: 0.8125rem;      /* 13px */
            --font-size-sm: 0.9375rem;      /* 15px */
            --font-size-base: 1.0625rem;    /* 17px - Apple's body text */
            --font-size-lg: 1.3125rem;      /* 21px */
            --font-size-xl: 1.625rem;       /* 26px */
            --font-size-2xl: 2rem;          /* 32px */
            --font-size-3xl: 2.5rem;        /* 40px */
            --font-size-4xl: 3rem;          /* 48px */
            --font-size-5xl: 4rem;          /* 64px */
            --font-size-6xl: 5rem;          /* 80px */

            /* Font Weights */
            --font-light: 300;
            --font-normal: 400;
            --font-medium: 500;
            --font-semibold: 600;
            --font-bold: 700;

            /* Line Heights - Apple's standards */
            --line-height-tight: 1.0833;    /* Headlines */
            --line-height-snug: 1.1667;     /* Subheadings */
            --line-height-normal: 1.47;     /* Body - Apple's standard */
            --line-height-relaxed: 1.625;   /* Large text */

            /* Letter Spacing */
            --letter-spacing-tight: -0.01em;
            --letter-spacing-normal: 0;
            --letter-spacing-wide: 0.01em;

            /* Border Radius - Larger, more modern */
            --radius-sm: 10px;
            --radius-md: 16px;
            --radius-lg: 20px;
            --radius-xl: 24px;
            --radius-2xl: 28px;
            --radius-full: 9999px;

            /* Transitions - Apple's smooth animations */
            --transition-fast: 200ms;
            --transition-base: 400ms;
            --transition-slow: 600ms;
            --transition-slower: 800ms;

            /* Easing Functions - Apple signature */
            --ease-apple: cubic-bezier(0.28, 0.11, 0.32, 1);
            --ease-apple-in: cubic-bezier(0.4, 0, 1, 1);
            --ease-apple-out: cubic-bezier(0, 0, 0.2, 1);
            --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);

            /* Z-index Scale */
            --z-base: 1;
            --z-dropdown: 100;
            --z-sticky: 200;
            --z-modal: 1000;
            --z-toast: 2000;
            --z-tooltip: 3000;

            /* Glassmorphism - Apple style */
            --glass-bg: rgba(255, 255, 255, 0.72);
            --glass-border: rgba(255, 255, 255, 0.18);
            --glass-blur: 20px;

            /* Legacy support (maintain backwards compatibility) */
            --primary: var(--primary-color);
            --accent: var(--accent-color);
            --success: var(--success-color);
            --warning: var(--warning-color);
            --danger: var(--danger-color);
            --border: var(--border-color);
        }

        /* Apple Dark Mode - Pure Black with Subtle Accents */
        [data-theme="dark"] {
            /* Dark Background Colors - Apple's approach */
            --bg-primary: #000000;          /* Pure black - main background */
            --bg-secondary: #1a1a1a;        /* Darker gray for cards - better visibility */
            --bg-tertiary: #2d2d2d;         /* Slightly lighter for depth */
            --bg-light: #000000;
            --bg-dark: #000000;

            /* Dark Text Colors - Apple's refined palette */
            --text-primary: #ffffff;        /* Pure white for better visibility */
            --text-secondary: #d1d1d6;      /* Light gray - WCAG AAA compliant (7.1:1) */
            --text-tertiary: #a1a1a6;       /* Medium gray */
            --text-light: #ffffff;

            /* Dark Borders & Dividers */
            --border-color: rgba(255, 255, 255, 0.12);   /* Increased visibility */
            --border-light: rgba(255, 255, 255, 0.05);
            --border-dark: rgba(255, 255, 255, 0.16);
            --border-hover: rgba(255, 255, 255, 0.16);

            /* Dark Shadows - Deeper */
            --shadow-sm: 0 1px 4px rgba(0, 0, 0, 0.5);
            --shadow-md: 0 2px 10px rgba(0, 0, 0, 0.6);
            --shadow-lg: 0 4px 20px rgba(0, 0, 0, 0.7);
            --shadow-xl: 0 8px 40px rgba(0, 0, 0, 0.8);
            --shadow-2xl: 0 12px 60px rgba(0, 0, 0, 0.85);

            /* Adjusted Colors for Dark Mode */
            --primary-color: #f5f5f7;
            --primary-dark: #ffffff;
            --primary-light: #b8b8bd;      /* Updated to match text-secondary */

            --accent-color: #2997ff;        /* Brighter blue for dark mode */
            --accent-dark: #0984ff;
            --accent-light: #409cff;
            --accent-hover: #409cff;

            --success-color: #30d158;       /* Apple Green stays */
            --success-dark: #28a745;
            --success-light: #4de072;

            --warning-color: #ff9f0a;       /* Apple Orange stays */
            --warning-dark: #e68900;
            --warning-light: #ffb340;

            --danger-color: #ff453a;        /* Brighter red */
            --danger-dark: #e6342a;
            --danger-light: #ff6259;

            --info-color: #007aff;

            /* Glassmorphism - Dark mode */
            --glass-bg: rgba(22, 22, 23, 0.72);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-blur: 20px;
        }

        /* Dark Mode Form Elements Override */
        [data-theme="dark"] .form-input,
        [data-theme="dark"] .form-select,
        [data-theme="dark"] textarea {
            background-color: #2d2d2d;
            color: #ffffff;
            border-color: rgba(255, 255, 255, 0.15);
        }

        [data-theme="dark"] .form-input:focus,
        [data-theme="dark"] .form-select:focus,
        [data-theme="dark"] textarea:focus {
            background-color: #3a3a3a;
            border-color: var(--accent-color);
        }

        [data-theme="dark"] .form-input::placeholder,
        [data-theme="dark"] textarea::placeholder {
            color: #a1a1a6;
        }

        /* Dark Mode Button Adjustments */
        [data-theme="dark"] .btn-secondary {
            background-color: #2d2d2d;
            border-color: rgba(255, 255, 255, 0.15);
            color: #ffffff;
        }

        [data-theme="dark"] .btn-secondary:hover {
            background-color: #3a3a3a;
            border-color: rgba(255, 255, 255, 0.25);
        }

        /* Dark Mode Modal Adjustments */
        [data-theme="dark"] .modal-content {
            background-color: #1a1a1a;
            border-color: rgba(255, 255, 255, 0.12);
        }

        /* Dark Mode Time Block Cards */
        [data-theme="dark"] .time-block {
            background-color: #2d2d2d;
            border-color: rgba(255, 255, 255, 0.12);
        }

        /* Dark Mode Progress Bars */
        [data-theme="dark"] .progress-bar-track {
            background-color: #2d2d2d;
            border-color: rgba(255, 255, 255, 0.12);
        }

        /* Dark Mode Analytics Elements */
        [data-theme="dark"] .analytics-label {
            color: #d1d1d6;
        }

        [data-theme="dark"] .analytics-value {
            -webkit-text-fill-color: unset;
            background: unset;
            background-clip: unset;
            color: #ffffff;
            font-weight: 700;
        }

        [data-theme="dark"] .benchmark-label {
            color: #a1a1a6;
        }

        [data-theme="dark"] .benchmark-percentage {
            color: #2997ff;
        }

        [data-theme="dark"] .analytics-benchmark {
            border-color: rgba(255, 255, 255, 0.12);
        }

        [data-theme="dark"] .analytics-stat {
            background-color: #1a1a1a;
            border-color: rgba(255, 255, 255, 0.12);
        }

        /* Dark Mode Card Elements */
        [data-theme="dark"] .card {
            background-color: #1a1a1a;
            border-color: rgba(255, 255, 255, 0.12);
        }

        [data-theme="dark"] .card-title {
            color: #ffffff;
        }

        /* Dark Mode General Text Override */
        [data-theme="dark"] body,
        [data-theme="dark"] .card,
        [data-theme="dark"] .analytics-stat,
        [data-theme="dark"] .time-block,
        [data-theme="dark"] .modal-content {
            color: #ffffff;
        }

        /* Light Mode: Gradient Cards with White Text */
        .analytics-stat[style*="background: linear-gradient"] {
            color: white !important;
        }

        .analytics-stat[style*="background: linear-gradient"] > div {
            color: white !important;
        }

        .analytics-stat[style*="background: linear-gradient"] div[style*="font-size"],
        .analytics-stat[style*="background: linear-gradient"] #completion-date-display,
        .analytics-stat[style*="background: linear-gradient"] #days-remaining-display,
        .analytics-stat[style*="background: linear-gradient"] #learning-pace-display,
        .analytics-stat[style*="background: linear-gradient"] #metacognitive-feedback,
        .analytics-stat[style*="background: linear-gradient"] #motivation-message {
            color: white !important;
        }

        /* Dark Mode: Override gradient cards for better readability */
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] {
            background: linear-gradient(135deg, #2997ff, #1a5ccc) !important;
            color: white !important;
        }

        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] > div,
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] div[style*="font-size"],
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] #completion-date-display,
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] #days-remaining-display,
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] #learning-pace-display,
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] #metacognitive-feedback,
        [data-theme="dark"] .analytics-stat[style*="background: linear-gradient"] #motivation-message {
            color: white !important;
        }

        /* Dark Mode: Advice and Average Sections */
        [data-theme="dark"] div[style*="background: #FFF5F5"] {
            background-color: #2d2d2d !important;
            border-color: rgba(255, 255, 255, 0.15) !important;
            color: #ffffff !important;
        }

        [data-theme="dark"] div[style*="background: #FFF5F5"] div {
            color: #ffffff !important;
        }

        [data-theme="dark"] div[style*="color: var(--danger)"] {
            color: #ff453a !important;
        }

        /* Apple-style smooth transitions */
        body, .card, .modal-content, .time-block, .subject-rotation,
        .score-entry, .goal-item, .weak-subject, .form-input, .form-select {
            transition: background-color 0.4s var(--ease-apple),
                        color 0.4s var(--ease-apple),
                        border-color 0.4s var(--ease-apple);
        }

        /* Apply Apple easing to all transitions */
        * {
            transition-timing-function: var(--ease-apple);
        }

        /* Dark mode toggle button */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: var(--accent-color);
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            min-width: 50px;
            min-height: 50px;
        }

        .theme-toggle:hover {
            transform: scale(1.1) rotate(15deg);
            box-shadow: var(--shadow-xl);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        .theme-toggle:focus-visible {
            outline: 3px solid var(--accent-light);
            outline-offset: 3px;
        }

        @media (max-width: 768px) {
            .theme-toggle {
                top: 10px;
                right: 10px;
                width: 44px;
                height: 44px;
                font-size: 1.2rem;
            }
        }

        
        body {
            font-family: var(--font-primary);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-size: var(--font-size-base);
            line-height: var(--line-height-normal);
            letter-spacing: var(--letter-spacing-normal);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: background-color 0.4s var(--ease-apple),
                        color 0.4s var(--ease-apple);
            min-height: 100vh;
        }

        html {
            background-color: var(--bg-primary);
            transition: background-color 0.4s var(--ease-apple);
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: var(--spacing-3xl) 5%;
        }

        /* Responsive container padding - Apple style with generous spacing */
        @media (max-width: 1024px) {
            .container {
                padding: var(--spacing-2xl) 4%;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: var(--spacing-xl) 4%;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: var(--spacing-lg) 4%;
            }
        }

        /* Ìó§Îçî Ïä§ÌÉÄÏùº - Apple minimalist approach */
        .header {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: all 0.4s var(--ease-apple);
        }

        .header:hover {
            box-shadow: var(--shadow-lg);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
            flex-wrap: wrap;
            gap: var(--spacing-lg);
        }
        
        .title {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            line-height: var(--line-height-tight);
            letter-spacing: var(--letter-spacing-tight);
        }
        
        .d-day-badge {
            background: var(--danger);
            color: white;
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 1.3rem;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        .study-mode-selector {
            display: flex;
            gap: 10px;
            background: var(--bg-light);
            padding: 5px;
            border-radius: 8px;
        }
        
        .mode-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .mode-btn.active {
            background: var(--accent);
            color: white;
        }
        
        /* ÎåÄÏãúÎ≥¥Îìú Í∑∏Î¶¨Îìú - Apple/Google style with max-width cards */
        /* ÎåÄÏãúÎ≥¥Îìú Í∑∏Î¶¨Îìú - Single Column Layout (User Preference) */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
            margin-bottom: var(--spacing-lg);
            width: 100%;
        }

        /* Responsive grid gaps only */
        @media (max-width: 1024px) {
            .dashboard-grid {
                gap: 20px;
            }
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                gap: 16px;
            }
        }

        @media (max-width: 480px) {
            .dashboard-grid {
                gap: 12px;
            }
        }
        
        /* Card Design - Apple minimalist style */
        .card {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: transform var(--transition-base) var(--ease-apple),
                        box-shadow var(--transition-base) var(--ease-apple),
                        background-color var(--transition-base) var(--ease-apple);
            position: relative;
            width: 100%;
        }

        .card:hover {
            transform: translateY(-3px) scale(1.01);
            box-shadow: var(--shadow-xl);
        }

        .card:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 3px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }
        
        .card-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            line-height: var(--line-height-snug);
            letter-spacing: var(--letter-spacing-tight);
        }
        
        .card-actions {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: var(--bg-light);
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.9rem;
            padding: 0;
            min-width: 36px;
            min-height: 36px;
        }

        .action-btn:hover {
            background: var(--accent);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .action-btn.edit:hover {
            background: var(--warning);
        }

        .action-btn.delete:hover {
            background: var(--danger);
        }

        .action-btn:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        @media (max-width: 768px) {
            .action-btn {
                width: 44px;
                height: 44px;
                min-width: 44px;
                min-height: 44px;
                font-size: 1rem;
            }
        }
        
        /* Ïò§ÎäòÏùò ÌïôÏäµ Í≥ÑÌöç */
        /* Ïò§ÎäòÏùò ÌïôÏäµ Í≥ÑÌöç - DesktopÏóêÏÑú 2Ïó¥ Ï∞®ÏßÄ, max-width Ï†úÏïΩ Ï†úÍ±∞ */
        /* Ïò§ÎäòÏùò ÌïôÏäµ Í≥ÑÌöç - Single Column */
        .today-plan {
            width: 100%;
        }

        .time-blocks {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }

        @media (max-width: 768px) {
            .time-blocks {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--spacing-xs);
                margin-bottom: var(--spacing-md);
            }
        }

        @media (max-width: 480px) {
            .time-blocks {
                grid-template-columns: 1fr;
                gap: var(--spacing-xs);
            }
        }
        
        .time-block {
            background: var(--bg-light);
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            border-left: 4px solid var(--accent);
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .time-block.completed {
            background: var(--success-light);
            border-left-color: var(--success);
        }

        [data-theme="dark"] .time-block.completed {
            background: rgba(72, 187, 120, 0.15);
        }

        .time-block:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow-sm);
        }

        .time-block:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        .time-block-actions {
            position: absolute;
            top: var(--spacing-sm);
            right: var(--spacing-sm);
            display: flex;
            gap: var(--spacing-xs);
            opacity: 0;
            transition: opacity var(--transition-base);
        }

        .time-block:hover .time-block-actions {
            opacity: 1;
        }

        @media (max-width: 768px) {
            .time-block-actions {
                opacity: 1;
            }
        }
        
        .time-block-btn {
            width: 20px;
            height: 20px;
            border: none;
            background: rgba(255,255,255,0.8);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.7rem;
            transition: all 0.3s;
        }
        
        .time-block-btn:hover {
            background: var(--accent);
            color: white;
        }
        
        .time-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }
        
        .time-subject {
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .time-detail {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .check-btn {
            margin-top: 10px;
            padding: 6px 12px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            color: var(--text-primary);
            transition: all 0.3s;
        }

        .check-btn:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        .check-btn.checked {
            background: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        /* Ìè¨Î™®ÎèÑÎ°ú ÌÉÄÏù¥Î®∏ */
        .pomodoro-display {
            text-align: center;
            padding: 20px 0;
        }

        .pomodoro-mode {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .pomodoro-mode.break {
            color: var(--success);
        }

        .pomodoro-mode.work {
            color: var(--danger);
        }

        .pomodoro-session-count {
            margin-top: 15px;
            font-size: 1rem;
            color: var(--text-secondary);
        }

        .pomodoro-session-count span {
            font-weight: bold;
            color: var(--accent);
            font-size: 1.2rem;
        }

        /* Í∏∞Ï∂úÎ¨∏Ï†ú ÌöåÎèÖ Ìä∏ÎûòÏª§ */
        .rotation-tracker {
            margin-top: var(--spacing-md);
        }

        .subject-rotation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-sm);
            background: var(--bg-light);
            border-radius: var(--radius-md);
            margin-bottom: var(--spacing-sm);
            position: relative;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }

        .subject-name {
            font-weight: 600;
            flex: 1;
            cursor: pointer;
            min-width: 100px;
            font-size: var(--font-size-sm);
        }

        .rotation-circles {
            display: flex;
            gap: var(--spacing-xs);
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        .rotation-circle {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-xs);
            cursor: pointer;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            flex-shrink: 0;
        }

        .rotation-circle:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        @media (max-width: 768px) {
            .rotation-circles {
                flex-basis: 100%;
                justify-content: flex-start;
            }
        }

        @media (max-width: 480px) {
            .subject-rotation {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-xs);
            }

            .rotation-circles {
                width: 100%;
                gap: var(--spacing-xs);
            }
        }
        
        .rotation-circle.completed {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }
        
        .rotation-circle.current {
            background: var(--warning);
            color: white;
            border-color: var(--warning);
            animation: blink 1.5s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        
        /* ÌïôÏäµ ÌÉÄÏù¥Î®∏ */
        .timer-display {
            font-size: 3rem;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            font-family: 'SF Mono', monospace;
            color: var(--primary-dark);
        }
        
        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .timer-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .timer-btn.start {
            background: var(--success);
            color: white;
        }
        
        .timer-btn.pause {
            background: var(--warning);
            color: white;
        }
        
        .timer-btn.reset {
            background: var(--danger);
            color: white;
        }
        
        .timer-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        /* Ï£ºÍ∞Ñ ÌïôÏäµ ÌÜµÍ≥Ñ */
        .weekly-stats {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .day-stat {
            text-align: center;
            padding: 10px;
            background: var(--bg-light);
            border-radius: 8px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .day-stat.today {
            background: var(--accent);
            color: white;
        }
        
        .day-stat.completed {
            background: var(--success);
            color: white;
        }
        
        .day-name {
            font-size: 0.85rem;
            margin-bottom: 5px;
        }
        
        .day-hours {
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        /* Í≥ºÎ™©Î≥Ñ ÏßÑÎèÑ */
        .subject-progress {
            margin-top: 15px;
        }
        
        .progress-item {
            margin-bottom: 15px;
            position: relative;
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            cursor: pointer;
        }
        
        .progress-label {
            font-weight: 600;
        }
        
        .progress-value {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .progress-bar {
            height: 20px;
            background: var(--bg-light);
            border-radius: 10px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--success));
            border-radius: 10px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        /* Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàò Ìä∏ÎûòÏª§ */
        .mock-scores {
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .score-entry {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: var(--bg-light);
            border-radius: 8px;
            margin-bottom: 8px;
            position: relative;
        }
        
        .score-date {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .score-value {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 20px;
            background: var(--bg-primary);
        }
        
        .score-value.pass {
            color: var(--success);
            border: 2px solid var(--success);
        }
        
        .score-value.fail {
            color: var(--danger);
            border: 2px solid var(--danger);
        }
        
        .score-actions {
            position: absolute;
            right: 80px;
            display: flex;
            gap: 5px;
            opacity: 1;
            transition: opacity 0.3s;
        }

        .score-action-btn {
            width: 24px;
            height: 24px;
            border: none;
            background: var(--bg-secondary);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            color: var(--text-primary);
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
        }

        .score-action-btn:hover {
            background: var(--accent-color);
            color: white;
            transform: scale(1.1);
        }
        
        /* Î™®Îã¨ Ïä§ÌÉÄÏùº */
        /* Apple-style Modal with Glassmorphism */
        .modal {
            display: none;
            position: fixed;
            z-index: var(--z-modal);
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            animation: fadeIn 0.4s var(--ease-apple);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal.show {
            display: block;
        }

        .modal-content {
            background: var(--bg-secondary);
            color: var(--text-primary);
            margin: 10% auto;
            padding: var(--spacing-2xl);
            border-radius: var(--radius-2xl);
            width: 90%;
            max-width: 540px;
            animation: slideInUp 0.5s var(--ease-apple);
            box-shadow: var(--shadow-2xl);
            border: 1px solid var(--border-color);
            z-index: calc(var(--z-modal) + 10);
        }

        @keyframes slideInUp {
            from {
                transform: translateY(30px) scale(0.96);
                opacity: 0;
            }
            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: var(--font-size-xl);
            font-weight: var(--font-semibold);
            line-height: var(--line-height-tight);
            letter-spacing: var(--letter-spacing-tight);
            color: var(--text-primary);
        }
        
        .modal-close {
            width: 30px;
            height: 30px;
            border: none;
            background: var(--bg-light);
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
        }
        
        .modal-close:hover {
            background: var(--danger);
            color: white;
        }
        
        .modal-body {
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: var(--spacing-md);
        }

        .form-label {
            display: block;
            margin-bottom: var(--spacing-xs);
            font-weight: 500;
            color: var(--text-secondary);
            font-size: var(--font-size-sm);
        }

        .form-input {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--bg-primary);
            color: var(--text-primary);
            box-sizing: border-box;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
            transform: translateY(-1px);
        }

        .form-input:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        .form-input::placeholder {
            color: var(--text-tertiary);
        }

        .form-select {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            background: var(--bg-primary);
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            box-sizing: border-box;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
        }

        .form-select:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        @media (max-width: 480px) {
            .form-input,
            .form-select {
                padding: var(--spacing-sm);
                font-size: 16px; /* iOS zoom prevention */
            }

            .form-group {
                margin-bottom: var(--spacing-sm);
            }
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-sm);
            margin-top: var(--spacing-lg);
            flex-wrap: wrap;
        }

        .modal-btn {
            padding: var(--spacing-sm) var(--spacing-lg);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: var(--font-size-sm);
            cursor: pointer;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
        }

        .modal-btn.cancel {
            background: var(--bg-light);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .modal-btn.cancel:hover {
            background: var(--bg-secondary);
            border-color: var(--border-dark);
        }

        .modal-btn.save {
            background: var(--accent-color);
            color: white;
        }

        .modal-btn.save:hover {
            background: var(--accent-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .modal-btn:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        .modal-btn:active {
            transform: translateY(0);
        }

        @media (max-width: 480px) {
            .modal-footer {
                gap: var(--spacing-xs);
            }

            .modal-btn {
                flex: 1;
                min-width: 100px;
                padding: var(--spacing-sm) var(--spacing-md);
            }
        }
        
        /* ÎÖ∏Ìä∏ ÏÑπÏÖò */
        .notes-section {
            margin-top: var(--spacing-lg);
        }

        .notes-input {
            width: 100%;
            min-height: 120px;
            padding: var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            resize: vertical;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--bg-primary);
            color: var(--text-primary);
            box-sizing: border-box;
            line-height: var(--line-height-relaxed);
        }

        .notes-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
            transform: translateY(-1px);
        }

        .notes-input:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        .notes-input::placeholder {
            color: var(--text-tertiary);
        }

        .notes-toolbar {
            margin-top: var(--spacing-sm);
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
        }
        
        .notes-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .notes-btn:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        
        /* Î∞òÏùëÌòï ÎîîÏûêÏù∏ */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .today-plan {
                grid-column: span 1;
            }
            
            .timer-display {
                font-size: 2.5rem;
            }
            
            .weekly-stats {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .time-blocks {
                grid-template-columns: 1fr;
            }
        }
        
        /* ÌÜ†Ïä§Ìä∏ ÏïåÎ¶º - Enhanced */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary-dark);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 2000;
            animation: slideInToast 0.3s ease;
            min-width: 300px;
            max-width: 500px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toast.success {
            background: var(--success);
        }

        .toast.error {
            background: var(--danger);
        }

        .toast.warning {
            background: var(--warning);
        }

        .toast.info {
            background: var(--accent);
        }

        .toast-icon {
            font-size: 1.2rem;
        }

        .toast-message {
            flex: 1;
        }

        @keyframes slideInToast {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutToast {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* D-Day Ïπ¥Îìú Ïä§ÌÉÄÏùº - Enhanced */
        .dday-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .dday-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: var(--spacing-lg);
            text-align: center;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .dday-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .dday-card:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 3px;
        }

        .dday-card.urgent {
            background: linear-gradient(135deg, #F56565 0%, #FC8181 100%);
            color: white;
        }

        .dday-card.warning {
            background: linear-gradient(135deg, #F6AD55 0%, #FBD38D 100%);
            color: white;
        }

        .dday-card.normal {
            background: linear-gradient(135deg, #48BB78 0%, #68D391 100%);
            color: white;
        }

        .dday-label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .dday-value {
            font-size: var(--font-size-5xl);
            font-weight: 800;
            margin: var(--spacing-md) 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.15);
            letter-spacing: -1px;
        }

        .dday-date {
            font-size: 0.85rem;
            opacity: 0.85;
            margin-top: 8px;
        }

        .dday-edit-btn {
            margin-top: 10px;
            padding: 6px 12px;
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 6px;
            color: inherit;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85rem;
        }

        .dday-edit-btn:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }

        /* Import/Export Buttons */
        .data-management {
            display: flex;
            gap: var(--spacing-md);
            flex-wrap: wrap;
            margin-top: var(--spacing-lg);
        }

        .btn-primary {
            padding: 12px 24px;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: var(--font-size-base);
            cursor: pointer;
            transition: all var(--transition-base);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            min-height: 44px;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            background: var(--accent-dark);
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            padding: 12px 24px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: var(--font-size-base);
            cursor: pointer;
            transition: all var(--transition-base);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            min-height: 44px;
        }

        .btn-secondary:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent-color);
            color: var(--accent-color);
            transform: translateY(-2px);
        }

        .btn-icon {
            font-size: var(--font-size-lg);
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }


        /* ÌôïÏù∏ Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .confirm-modal .modal-content {
            max-width: 400px;
        }

        .confirm-message {
            padding: 20px 0;
            font-size: 1.1rem;
            text-align: center;
            color: var(--text-primary);
        }

        /* Ïä§Ìä∏Î¶≠ Ìä∏ÎûòÏª§ Ïä§ÌÉÄÏùº */
        .streak-display {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #FF6B6B 0%, #FFD93D 100%);
            border-radius: 12px;
            color: white;
            margin-bottom: 15px;
        }

        .streak-number {
            font-size: 3rem;
            font-weight: bold;
            margin: 10px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .streak-label {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        .streak-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.3);
        }

        .streak-stat-item {
            text-align: center;
        }

        .streak-stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .streak-stat-label {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        /* Î∂ÑÏÑù ÎåÄÏãúÎ≥¥Îìú Ïä§ÌÉÄÏùº - Enhanced Professional Design */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .analytics-stat {
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            padding: 24px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-md);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .analytics-stat::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, var(--accent-color) 0%, var(--accent-light) 100%);
        }

        .analytics-stat:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent-light);
        }

        .analytics-label {
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .analytics-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-color) 0%, var(--info-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 8px 0 16px 0;
            line-height: 1.2;
        }

        .analytics-benchmark {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
            text-align: left;
        }

        .benchmark-label {
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-tertiary);
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .benchmark-percentage {
            font-weight: 600;
            color: var(--accent-color);
            font-size: 0.8rem;
        }

        .benchmark-bar {
            height: 12px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .benchmark-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color) 0%, var(--success-color) 100%);
            border-radius: 6px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .benchmark-fill.excellent {
            background: linear-gradient(90deg, #10B981 0%, #34D399 100%);
        }

        .benchmark-fill.good {
            background: linear-gradient(90deg, var(--accent-color) 0%, var(--accent-light) 100%);
        }

        .benchmark-fill.needs-improvement {
            background: linear-gradient(90deg, #F59E0B 0%, #FBBF24 100%);
        }

        .benchmark-fill.poor {
            background: linear-gradient(90deg, #EF4444 0%, #F87171 100%);
        }

        .benchmark-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Ï∞®Ìä∏ Ïä§ÌÉÄÏùº */
        .chart-container {
            background: var(--bg-light);
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .bar-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 200px;
            padding: 10px;
        }

        .bar-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 8px;
            min-height: 280px;
        }

        .bar {
            width: 100%;
            min-height: 40px;
            background: linear-gradient(to top, var(--accent), var(--success));
            border-radius: 4px 4px 0 0;
            transition: all 0.3s;
            position: relative;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .bar:hover {
            opacity: 0.9;
            transform: scaleY(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .bar-label {
            margin-top: 12px;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-primary);
            text-align: center;
            word-break: break-word;
            max-width: 100%;
        }

        .bar-value {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--accent);
        }

        /* Î™©Ìëú ÏÑ§Ï†ï Ïä§ÌÉÄÏùº */
        .goal-item {
            background: var(--bg-light);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid var(--warning);
            transition: all 0.3s;
        }

        .goal-item.achieved {
            border-left-color: var(--success);
            background: var(--success-light);
        }

        [data-theme="dark"] .goal-item.achieved {
            background: rgba(72, 187, 120, 0.15);
        }

        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .goal-title {
            font-weight: 600;
            flex: 1;
        }

        .goal-date {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-right: 10px;
        }

        .goal-progress-bar {
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }

        .goal-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--warning), var(--success));
            transition: width 0.5s ease;
        }

        .goal-actions {
            display: flex;
            gap: 5px;
        }

        .goal-btn {
            width: 24px;
            height: 24px;
            border: none;
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
        }

        .goal-btn:hover {
            background: var(--accent-color);
            color: white;
        }

        /* ÏïΩÏ†ê Í≥ºÎ™© Ïä§ÌÉÄÏùº */
        .weak-subject {
            background: #FFF5F5;
            border: 2px solid var(--danger);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .weak-subject-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .weak-subject-name {
            font-weight: 600;
            color: var(--danger);
            font-size: 1.1rem;
        }

        .priority-badge {
            background: var(--danger);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .weak-subject-info {
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        .recommendation {
            background: var(--bg-secondary);
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 0.85rem;
            border-left: 3px solid var(--warning-color);
        }

        /* Ï∂îÏ≤ú ÏÇ¨Ìï≠ Ïä§ÌÉÄÏùº */
        .recommendation-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
        }

        .recommendation-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .recommendation-list {
            list-style: none;
            padding: 0;
        }

        .recommendation-list li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            line-height: 1.5;
        }

        .recommendation-list li:before {
            content: '‚Üí';
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        /* Ï†ëÏùÑ Ïàò ÏûàÎäî ÏÑπÏÖò */
        .collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .collapse-icon {
            transition: transform 0.3s;
            font-size: 1.2rem;
        }

        .collapse-icon.collapsed {
            transform: rotate(-90deg);
        }

        .collapsible-content {
            max-height: 2000px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .collapsible-content.collapsed {
            max-height: 0;
        }

        /* Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨ ÏÑπÏÖò */
        .data-management-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-top: var(--spacing-lg);
        }

        .data-management-card .card-title {
            color: white;
        }

        .data-management-section {
            padding: var(--spacing-md) 0;
        }

        .data-management-desc {
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: var(--spacing-lg);
            font-size: var(--font-size-base);
            line-height: var(--line-height-relaxed);
        }

        .data-management-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .data-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-md) var(--spacing-lg);
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-lg);
            color: white;
            font-size: var(--font-size-base);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-base);
            min-height: 56px;
        }

        .data-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .data-btn:active {
            transform: translateY(0);
        }

        .data-btn .btn-icon {
            font-size: 1.5rem;
        }

        .data-btn .btn-text {
            font-size: var(--font-size-lg);
        }

        .export-btn:hover {
            background: rgba(72, 187, 120, 0.3);
            border-color: var(--success-light);
        }

        .import-btn:hover {
            background: rgba(66, 153, 225, 0.3);
            border-color: var(--info-color);
        }

        .data-management-info {
            padding: var(--spacing-md);
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--radius-md);
            color: rgba(255, 255, 255, 0.9);
            line-height: var(--line-height-relaxed);
        }

        .data-management-info small {
            font-size: var(--font-size-sm);
            line-height: 1.8;
        }

        /* Import Preview Modal */
        .import-preview {
            margin-top: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            max-height: 300px;
            overflow-y: auto;
        }

        .import-preview-item {
            display: flex;
            justify-content: space-between;
            padding: var(--spacing-sm) 0;
            border-bottom: 1px solid var(--border-color);
        }

        .import-preview-item:last-child {
            border-bottom: none;
        }

        .import-preview-label {
            font-weight: 600;
            color: var(--text-secondary);
        }

        .import-preview-value {
            color: var(--text-primary);
            font-weight: 500;
        }

        /* Loading state */
        .btn-loading {
            position: relative;
            pointer-events: none;
            opacity: 0.7;
        }

        .btn-loading::after {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            top: 50%;
            left: 50%;
            margin: -8px 0 0 -8px;
            border: 2px solid white;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spinner 0.6s linear infinite;
        }

        @keyframes spinner {
            to { transform: rotate(360deg); }
        }

        /* Mobile optimizations for data management */
        @media (max-width: 600px) {
            .data-management-actions {
                grid-template-columns: 1fr;
            }

            .data-btn {
                min-height: 60px;
                font-size: var(--font-size-lg);
            }
        }

        /* Empty States */
        .empty-state {
            text-align: center;
            padding: var(--spacing-xl) var(--spacing-md);
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: var(--spacing-md);
            opacity: 0.6;
        }

        .empty-state-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .empty-state-description {
            font-size: var(--font-size-sm);
            margin-bottom: var(--spacing-lg);
            line-height: var(--line-height-relaxed);
        }

        .empty-state-action {
            display: inline-block;
            padding: var(--spacing-sm) var(--spacing-lg);
            background: var(--accent-color);
            color: white;
            border-radius: var(--radius-md);
            text-decoration: none;
            font-weight: 600;
            transition: all var(--transition-base);
            cursor: pointer;
            border: none;
        }

        .empty-state-action:hover {
            background: var(--accent-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* Enhanced Button Consistency */
        /* Apple-style Button System */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-lg);
            border: none;
            border-radius: var(--radius-full);
            font-family: var(--font-primary);
            font-weight: var(--font-medium);
            font-size: var(--font-size-base);
            cursor: pointer;
            transition: all var(--transition-base) var(--ease-apple);
            min-height: 44px;
            letter-spacing: -0.005em;
            -webkit-font-smoothing: antialiased;
        }

        .btn-primary {
            background: var(--accent-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-2px) scale(1.02);
            box-shadow: var(--shadow-lg);
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-secondary);
            border-color: var(--border-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: var(--success-light);
            transform: translateY(-2px) scale(1.02);
            box-shadow: var(--shadow-md);
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: var(--danger-light);
            transform: translateY(-2px) scale(1.02);
            box-shadow: var(--shadow-md);
        }

        .btn-sm {
            padding: var(--spacing-xs) var(--spacing-sm);
            font-size: var(--font-size-sm);
            min-height: 36px;
        }

        .btn-lg {
            padding: var(--spacing-md) var(--spacing-xl);
            font-size: var(--font-size-lg);
            min-height: 56px;
        }

        /* Focus states for accessibility */
        .btn:focus-visible,
        .data-btn:focus-visible,
        .action-btn:focus-visible,
        .modal-btn:focus-visible {
            outline: 3px solid var(--accent-light);
            outline-offset: 2px;
        }

        /* Improved Card Shadows */
        .card {
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-base);
        }

        .card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        /* Loading Spinner for Better Feedback */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spinner 0.6s linear infinite;
        }

        /* Tablet devices (769px to 1024px) */
        @media (min-width: 769px) and (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .container {
                max-width: 100%;
                padding: var(--spacing-lg);
            }

            .card {
                padding: var(--spacing-md);
            }

            .time-blocks {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--spacing-sm);
            }

            .analytics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Enhanced Mobile Responsiveness (768px and below) */
        @media (max-width: 768px) {
            .modal-content {
                max-width: 95%;
                margin: 20px auto;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: var(--spacing-sm);
            }

            .header-top {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-sm);
            }

            .title {
                font-size: var(--font-size-xl);
            }

            .card-title {
                font-size: var(--font-size-base);
            }

            .card {
                padding: var(--spacing-md);
                margin-bottom: var(--spacing-sm);
            }

            .time-blocks {
                grid-template-columns: 1fr;
                gap: var(--spacing-sm);
            }

            .analytics-grid {
                grid-template-columns: 1fr;
                gap: var(--spacing-sm);
            }

            .weekly-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--spacing-xs);
            }

            .dday-container {
                gap: var(--spacing-sm);
            }

            /* Larger touch targets on mobile */
            .action-btn,
            .rotation-circle,
            .check-btn {
                min-width: 44px;
                min-height: 44px;
            }

            .data-management-actions {
                grid-template-columns: 1fr;
                gap: var(--spacing-sm);
            }

            .data-btn {
                padding: var(--spacing-sm) var(--spacing-md);
                min-height: 48px;
                font-size: var(--font-size-sm);
            }

            .data-btn .btn-text {
                font-size: var(--font-size-base);
            }
        }

        /* Extra small mobile devices (480px and below) */
        @media (max-width: 480px) {
            .container {
                padding: var(--spacing-sm);
                max-width: 100%;
            }

            .header {
                padding: var(--spacing-md);
                margin-bottom: var(--spacing-md);
                border-radius: var(--radius-lg);
            }

            .header-top {
                gap: var(--spacing-xs);
                margin-bottom: var(--spacing-sm);
            }

            .title {
                font-size: var(--font-size-lg);
                line-height: var(--line-height-tight);
            }

            .dday-container {
                grid-template-columns: 1fr;
                gap: var(--spacing-xs);
                margin-bottom: var(--spacing-md);
            }

            .dday-card {
                padding: var(--spacing-md);
                min-height: auto;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: var(--spacing-xs);
                margin-bottom: var(--spacing-md);
            }

            .card {
                padding: var(--spacing-sm);
                margin-bottom: var(--spacing-xs);
                border-radius: var(--radius-lg);
            }

            .card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-xs);
            }

            .card-title {
                font-size: var(--font-size-base);
                line-height: var(--line-height-tight);
            }

            .card-actions {
                gap: var(--spacing-xs);
                width: 100%;
                justify-content: flex-end;
            }

            .analytics-grid {
                grid-template-columns: 1fr;
                gap: var(--spacing-xs);
            }

            .analytics-stat {
                padding: var(--spacing-sm);
            }

            .weekly-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--spacing-xs);
            }

            .time-blocks {
                grid-template-columns: 1fr;
                gap: var(--spacing-xs);
            }

            .time-block {
                padding: var(--spacing-sm);
                min-height: auto;
            }

            .modal-content {
                max-width: 95%;
                margin: 30% auto;
                padding: var(--spacing-md);
                max-height: 80vh;
                overflow-y: auto;
            }

            .modal-header {
                margin-bottom: var(--spacing-sm);
            }

            .modal-title {
                font-size: var(--font-size-lg);
            }

            .data-management-actions {
                grid-template-columns: 1fr;
                gap: var(--spacing-xs);
            }

            .data-btn {
                padding: var(--spacing-xs) var(--spacing-sm);
                min-height: 44px;
                font-size: var(--font-size-xs);
                flex-wrap: wrap;
            }

            .data-btn .btn-icon {
                font-size: 1.2rem;
            }

            .data-btn .btn-text {
                font-size: var(--font-size-xs);
            }

            .data-management-desc {
                font-size: var(--font-size-sm);
            }

            .data-management-info {
                padding: var(--spacing-sm);
                font-size: var(--font-size-xs);
            }
        }

        /* Smooth Transitions for Better UX */
        * {
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Respect user's motion preferences */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Better Visual Hierarchy */
        h1, h2, h3, h4 {
            line-height: var(--line-height-tight);
            font-weight: 700;
        }

        p {
            line-height: var(--line-height-relaxed);
        }

        /* Empty State Styles */
        .empty-state {
            text-align: center;
            padding: var(--spacing-2xl) var(--spacing-lg);
            color: var(--text-secondary);
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            margin: var(--spacing-lg) 0;
            border: 2px dashed var(--border-color);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: var(--spacing-md);
            opacity: 0.8;
        }

        .empty-state-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .empty-state-description {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
            margin-bottom: var(--spacing-md);
            line-height: var(--line-height-relaxed);
        }

        .empty-state-action {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: var(--font-size-sm);
            font-weight: 600;
            transition: all var(--transition-base) cubic-bezier(0.4, 0, 0.2, 1);
        }

        .empty-state-action:hover {
            background: var(--accent-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .empty-state-action:focus-visible {
            outline: 2px solid var(--accent-light);
            outline-offset: 2px;
        }

        /* ============================================
           DATA VISUALIZATION DASHBOARD - v2.13.0
           Apple-inspired Chart.js integration
           ============================================ */

        /* Data Visualization Container */
        .data-viz-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }

        /* Sync Status Dashboard */
        .sync-status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .sync-status-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
            transition: all var(--transition);
        }

        .sync-status-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .sync-status-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xs);
        }

        .sync-status-icon {
            font-size: var(--text-2xl);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-md);
            background: var(--bg-secondary);
        }

        .sync-status-icon.success {
            background: rgba(52, 199, 89, 0.1);
            color: #34c759;
        }

        .sync-status-icon.warning {
            background: rgba(255, 149, 0, 0.1);
            color: #ff9500;
        }

        .sync-status-icon.error {
            background: rgba(255, 59, 48, 0.1);
            color: #ff3b30;
        }

        .sync-status-title {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sync-status-value {
            font-size: var(--text-3xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            line-height: 1;
        }

        .sync-status-timestamp {
            font-size: var(--text-xs);
            color: var(--text-tertiary);
            margin-top: var(--spacing-xs);
        }

        /* Chart Container */
        .chart-wrapper {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-xl);
            padding: var(--spacing-xl);
            margin-bottom: var(--spacing-lg);
            transition: all var(--transition);
        }

        .chart-wrapper:hover {
            box-shadow: var(--shadow-lg);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
            gap: var(--spacing-sm);
        }

        .chart-title {
            font-size: var(--text-xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0;
        }

        .chart-actions {
            display: flex;
            gap: var(--spacing-xs);
        }

        .chart-btn {
            padding: var(--spacing-xs) var(--spacing-sm);
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition);
            font-family: inherit;
        }

        .chart-btn:hover {
            background: var(--accent-light);
            color: white;
            border-color: var(--accent-light);
            transform: translateY(-1px);
        }

        .chart-btn.active {
            background: var(--accent-light);
            color: white;
            border-color: var(--accent-light);
        }

        .chart-canvas-container {
            position: relative;
            width: 100%;
            height: 400px;
            margin-bottom: var(--spacing-md);
        }

        .chart-canvas-container.small {
            height: 300px;
        }

        .chart-canvas-container canvas {
            max-width: 100%;
            height: auto !important;
        }

        /* Progress Bars Visualization */
        .progress-bars-container {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .progress-bar-item {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .progress-bar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xs);
        }

        .progress-bar-label {
            font-size: var(--text-base);
            font-weight: var(--font-medium);
            color: var(--text-primary);
        }

        .progress-bar-value {
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            color: var(--text-secondary);
        }

        .progress-bar-track {
            width: 100%;
            height: 12px;
            background: var(--bg-secondary);
            border-radius: 9999px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar-fill {
            height: 100%;
            border-radius: 9999px;
            transition: width 1s cubic-bezier(0.28, 0.11, 0.32, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.3),
                transparent
            );
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-bar-fill.low {
            background: linear-gradient(90deg, #ff3b30, #ff6b5e);
        }

        .progress-bar-fill.medium {
            background: linear-gradient(90deg, #ff9500, #ffb340);
        }

        .progress-bar-fill.high {
            background: linear-gradient(90deg, #34c759, #5dd97c);
        }

        /* Chart Empty State */
        .chart-empty-state {
            text-align: center;
            padding: var(--spacing-2xl);
            color: var(--text-tertiary);
        }

        .chart-empty-icon {
            font-size: 64px;
            margin-bottom: var(--spacing-md);
            opacity: 0.3;
        }

        .chart-empty-text {
            font-size: var(--text-base);
            margin-bottom: var(--spacing-sm);
        }

        .chart-empty-subtext {
            font-size: var(--text-sm);
            color: var(--text-tertiary);
        }

        /* Date Range Selector */
        .date-range-selector {
            display: flex;
            gap: var(--spacing-xs);
            flex-wrap: wrap;
        }

        /* Responsive Design for Charts */
        @media (max-width: 768px) {
            .chart-canvas-container {
                height: 300px;
            }

            .chart-canvas-container.small {
                height: 250px;
            }

            .sync-status-grid {
                grid-template-columns: 1fr;
            }

            .chart-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .chart-actions {
                width: 100%;
                justify-content: flex-start;
            }
        }

        @media (max-width: 480px) {
            .chart-wrapper {
                padding: var(--spacing-md);
            }

            .chart-canvas-container {
                height: 250px;
            }

            .chart-title {
                font-size: var(--text-lg);
            }
        }

        /* Dark mode specific chart styles */
        body.dark-mode .chart-wrapper,
        body.dark-mode .sync-status-card {
            background: #161617;
            border-color: rgba(255, 255, 255, 0.1);
        }

        body.dark-mode .chart-btn {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }

        body.dark-mode .chart-btn:hover,
        body.dark-mode .chart-btn.active {
            background: #2997ff;
            border-color: #2997ff;
            color: white;
        }

        /* Dark mode: Exam type buttons (1Ï∞®/2Ï∞®) */
        body.dark-mode .mode-btn {
            color: rgba(255, 255, 255, 0.7);
            background: rgba(255, 255, 255, 0.05);
        }

        body.dark-mode .mode-btn:hover {
            color: rgba(255, 255, 255, 0.9);
            background: rgba(255, 255, 255, 0.1);
        }

        body.dark-mode .mode-btn.active {
            background: var(--accent);
            color: white;
        }

        body.dark-mode .progress-bar-track {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Loading Animation for Charts */
        .chart-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 400px;
            color: var(--text-tertiary);
        }

        .chart-loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--bg-secondary);
            border-top-color: var(--accent-light);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== v3.0.0 SYNC BADGE (Í≥†Ï†ï ÏúÑÏπò ÎèôÍ∏∞Ìôî ÌëúÏãú) ===== */
        .sync-badge {
            position: fixed;
            bottom: 24px;
            right: 24px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-full);
            box-shadow: var(--shadow-md);
            font-size: 12px;
            color: var(--text-secondary);
            z-index: 1000;
            transition: all 0.3s ease;
            animation: slideIn 0.3s ease-out;
        }

        .sync-badge.syncing {
            background: var(--bg-tertiary);
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        .sync-badge.saving {
            background: var(--accent-light);
            color: #ffffff;
        }

        .sync-badge-icon {
            display: inline-block;
            font-size: 14px;
            animation: sync-pulse 2s infinite;
        }

        .sync-badge.syncing .sync-badge-icon {
            animation: sync-spin 1s linear infinite;
        }

        .sync-badge-text {
            font-weight: 500;
            color: var(--text-primary);
        }

        .sync-badge.syncing .sync-badge-text {
            color: var(--accent-color);
        }

        .sync-badge-time {
            font-size: 11px;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translate(200px, 0);
            }
            to {
                opacity: 1;
                transform: translate(0, 0);
            }
        }

        @keyframes sync-pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.1); }
        }

        @keyframes sync-spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Î™®Î∞îÏùºÏóêÏÑú ÎèôÍ∏∞Ìôî ÌëúÏãú ÏúÑÏπò Ï°∞Ï†ï */
        @media (max-width: 768px) {
            .sync-badge {
                bottom: 16px;
                right: 16px;
                padding: 6px 10px;
                font-size: 11px;
            }

            .sync-badge-icon {
                font-size: 12px;
            }
        }

        /* ===== v3.0.0 STICKY PROGRESS BAR ===== */
        .sticky-progress-bar {
            position: sticky;
            top: 0;
            z-index: 99;
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            padding: var(--spacing-md) 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--spacing-sm);
            padding: var(--spacing-md) var(--spacing-lg);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .sticky-progress-bar {
            backdrop-filter: blur(20px);
            background: rgba(0, 0, 0, 0.8);
        }

        .progress-metric {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }

        .progress-metric:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .metric-icon {
            font-size: 20px;
            display: inline-block;
        }

        .metric-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .metric-label {
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            .sticky-progress-bar {
                grid-template-columns: repeat(2, 1fr);
                padding: var(--spacing-sm) var(--spacing-md);
                gap: var(--spacing-xs);
            }

            .progress-metric {
                padding: var(--spacing-xs) var(--spacing-sm);
                gap: var(--spacing-xs);
            }

            .metric-icon {
                font-size: 16px;
            }

            .metric-value {
                font-size: 14px;
            }

            .metric-label {
                font-size: 10px;
            }
        }

        /* ===== v3.0.0 DASHBOARD TAB NAVIGATION ===== */
        .dashboard-tabs {
            display: flex;
            gap: var(--spacing-sm);
            padding: var(--spacing-lg) 0;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: var(--spacing-xl);
            overflow-x: auto;
            scroll-behavior: smooth;
        }

        .dashboard-tabs::-webkit-scrollbar {
            height: 4px;
        }

        .dashboard-tabs::-webkit-scrollbar-track {
            background: transparent;
        }

        .dashboard-tabs::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        .tab-btn {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-sm) var(--spacing-md);
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            border-bottom-color: var(--accent-light);
        }

        .tab-btn.active {
            color: var(--accent-color);
            border-bottom-color: var(--accent-color);
        }

        .tab-icon {
            font-size: 18px;
        }

        .tab-label {
            display: inline;
        }

        @media (max-width: 768px) {
            .dashboard-tabs {
                padding: var(--spacing-md) 0;
                margin-bottom: var(--spacing-lg);
            }

            .tab-btn {
                padding: var(--spacing-xs) var(--spacing-sm);
                font-size: 13px;
            }

            .tab-icon {
                font-size: 16px;
            }
        }

        /* TAB CONTENT - Ï≤òÏùåÏóêÎäî Î™®Îëê Ïà®ÍπÄ */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

    </style>
</head>
<body>

    <!-- Dark Mode Toggle -->
    <button class="theme-toggle" onclick="toggleDarkMode()" title="Toggle Dark Mode">
        <span id="theme-icon">üåô</span>
    </button>

    <div class="container">
        <!-- Ìó§Îçî -->
        <div class="header">
            <div class="header-top">
                <h1 class="title">üéØ ÏãúÌóò Ï†ÑÎûµÏ†Å ÌïôÏäµ ÏãúÏä§ÌÖú v3.0.0</h1>
            </div>

            <!-- D-Day Ïπ¥Ïö¥ÌÑ∞ (1Ï∞®/2Ï∞®) -->
            <div class="dday-container">
                <div class="dday-card" id="dday-1st-card" onclick="editExamDate('1Ï∞®')">
                    <div class="dday-label">üìö 1Ï∞® ÏãúÌóò</div>
                    <div class="dday-value" id="dday-1st-value">D-?</div>
                    <div class="dday-date" id="dday-1st-date">ÎÇ†Ïßú ÎØ∏ÏÑ§Ï†ï</div>
                    <button class="dday-edit-btn" onclick="event.stopPropagation(); editExamDate('1Ï∞®')">ÎÇ†Ïßú ÏÑ§Ï†ï</button>
                </div>
                <div class="dday-card" id="dday-2nd-card" onclick="editExamDate('2Ï∞®')">
                    <div class="dday-label">‚úçÔ∏è 2Ï∞® ÏãúÌóò</div>
                    <div class="dday-value" id="dday-2nd-value">D-?</div>
                    <div class="dday-date" id="dday-2nd-date">ÎÇ†Ïßú ÎØ∏ÏÑ§Ï†ï</div>
                    <button class="dday-edit-btn" onclick="event.stopPropagation(); editExamDate('2Ï∞®')">ÎÇ†Ïßú ÏÑ§Ï†ï</button>
                </div>
            </div>

            <div class="study-mode-selector">
                <button class="mode-btn" onclick="setExamType('1Ï∞®')">1Ï∞® ÏãúÌóò</button>
                <button class="mode-btn" onclick="setExamType('2Ï∞®')">2Ï∞® ÏãúÌóò</button>
            </div>
        </div>

        <!-- v3.0.0 STICKY PROGRESS BAR (Ìï≠ÏÉÅ Î≥¥Ïù¥Îäî ÏßÑÎèÑ ÌëúÏãú) -->
        <div class="sticky-progress-bar" id="stickyProgressBar">
            <div class="progress-metric">
                <span class="metric-icon">üìä</span>
                <div class="metric-info">
                    <span class="metric-label">Ï†ÑÏ≤¥ ÏßÑÎèÑ</span>
                    <span class="metric-value" id="stickyProgress">0%</span>
                </div>
            </div>

            <div class="progress-metric">
                <span class="metric-icon">üî•</span>
                <div class="metric-info">
                    <span class="metric-label">Ïó∞ÏÜç ÌïôÏäµ</span>
                    <span class="metric-value" id="stickyStreak">0Ïùº</span>
                </div>
            </div>

            <div class="progress-metric">
                <span class="metric-icon">‚úÖ</span>
                <div class="metric-info">
                    <span class="metric-label">Ïò§Îäò ÏôÑÎ£å</span>
                    <span class="metric-value" id="stickyCompleted">0/0</span>
                </div>
            </div>

            <div class="progress-metric">
                <span class="metric-icon">‚è±Ô∏è</span>
                <div class="metric-info">
                    <span class="metric-label">Ïò§Îäò ÌïôÏäµÏãúÍ∞Ñ</span>
                    <span class="metric-value" id="stickyHours">0h</span>
                </div>
            </div>
        </div>

        <!-- v3.0.0 DASHBOARD TAB NAVIGATION -->
        <!-- ÌïôÏäµ Ïä§Ìä∏Î¶≠ & Ï∂îÏ≤ú (ÏµúÏÉÅÎã® Í∞ïÏ°∞) -->
        <div class="dashboard-grid">
            <!-- ÌïôÏäµ Ïä§Ìä∏Î¶≠ Ìä∏ÎûòÏª§ -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">üî• ÌïôÏäµ Ïä§Ìä∏Î¶≠</h2>
                    <div class="card-actions">
                        <button class="action-btn" onclick="resetStreak()">üîÑ</button>
                    </div>
                </div>
                <div class="streak-display">
                    <div class="streak-label">ÌòÑÏû¨ Ïó∞ÏÜç ÌïôÏäµÏùº</div>
                    <div class="streak-number" id="current-streak">0</div>
                    <div class="streak-label">Ïùº Ïó∞ÏÜç üî•</div>
                    <div class="streak-stats">
                        <div class="streak-stat-item">
                            <div class="streak-stat-value" id="longest-streak">0</div>
                            <div class="streak-stat-label">ÏµúÏû• Í∏∞Î°ù</div>
                        </div>
                        <div class="streak-stat-item">
                            <div class="streak-stat-value" id="total-study-days">0</div>
                            <div class="streak-stat-label">Ï¥ù ÌïôÏäµÏùº</div>
                        </div>
                    </div>
                </div>
            </div>

        <!-- ÌïôÏäµ Î∂ÑÏÑù ÎåÄÏãúÎ≥¥Îìú v3.0.7 - Enhanced with Core Metrics -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">üìä ÌïôÏäµ Î∂ÑÏÑù ÎåÄÏãúÎ≥¥Îìú</h2>
            </div>


        <!-- ÎåÄÏãúÎ≥¥Îìú Í∑∏Î¶¨Îìú -->
        <div class="dashboard-grid">
            <!-- Ïò§ÎäòÏùò ÌïôÏäµ Í≥ÑÌöç -->
            <div class="card today-plan">
                <div class="card-header">
                    <h2 class="card-title">üìö Ïò§ÎäòÏùò ÌïôÏäµ Ï†ÑÎûµ</h2>
                    <div class="card-actions">
                        <button class="action-btn" onclick="addTimeBlock()" aria-label="ÌïôÏäµ ÏãúÍ∞Ñ Î∏îÎ°ù Ï∂îÍ∞Ä">‚ûï</button>
                    </div>
                </div>
                <div class="time-blocks" id="time-blocks-container">
                    <!-- ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                </div>
                <div style="background: #FFF5F5; padding: 15px; border-radius: 8px; border-left: 4px solid var(--danger); margin-top: 15px;">
                    <div style="font-weight: 600; margin-bottom: 10px; color: var(--danger);">üí° Ìï©Í≤©Ïûê ÌèâÍ∑† (ÏßÅÏû•Î≥ëÌñâ Í∏∞Ï§Ä)</div>
                    <div style="font-size: 0.9rem; line-height: 1.6;">
                        ‚Ä¢ ÏùºÏùº ÌïôÏäµÏãúÍ∞Ñ: ÌèâÏùº 4-5ÏãúÍ∞Ñ<br>
                        ‚Ä¢ Í∏∞Ï∂úÎ¨∏Ï†ú ÌöåÎèÖ: Í≥ºÎ™©Îãπ 6-7Ìöå<br>
                        ‚Ä¢ 1Ï∞® Ï§ÄÎπÑÍ∏∞Í∞Ñ: 12-18Í∞úÏõî
                    </div>
                </div>
            </div>
            
            <!-- Í∏∞Ï∂úÎ¨∏Ï†ú ÌöåÎèÖ Ìä∏ÎûòÏª§ -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">üîÑ Í∏∞Ï∂úÎ¨∏Ï†ú ÌöåÎèÖ ÌòÑÌô©</h2>
                    <div class="card-actions">
                        <button class="action-btn" onclick="resetRotations()">üîÑ</button>
                    </div>
                </div>
                <div class="rotation-tracker" id="rotation-tracker">
                    <!-- ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                </div>
            </div>
            
            <!-- ÌÜµÌï© ÌïôÏäµ ÌÉÄÏù¥Î®∏ -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">‚è±Ô∏è Ïò§ÎäòÏùò ÌïôÏäµ ÏãúÍ∞Ñ & Ìè¨Î™®ÎèÑÎ°ú</h2>
                </div>
                <div class="card-body" style="display: grid; grid-template-columns: 1fr; gap: 20px; padding: 20px;">
                    <!-- Ïò§ÎäòÏùò ÌïôÏäµ ÏãúÍ∞Ñ ÏÑπÏÖò -->
                    <div style="border-bottom: 2px solid #e9ecef; padding-bottom: 20px;">
                        <h3 style="font-size: 1rem; font-weight: 600; color: #495057; margin-bottom: 15px;">‚è±Ô∏è Ïò§ÎäòÏùò ÌïôÏäµ ÏãúÍ∞Ñ</h3>
                        <div class="timer-display" id="timer">00:00:00</div>
                        <div class="timer-controls">
                            <button class="timer-btn start" onclick="startTimer()">ÏãúÏûë</button>
                            <button class="timer-btn pause" onclick="pauseTimer()">ÏùºÏãúÏ†ïÏßÄ</button>
                            <button class="timer-btn reset" onclick="resetTimer()">Î¶¨ÏÖã</button>
                        </div>
                        <div class="weekly-stats" id="weekly-stats">
                            <!-- ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                        </div>
                    </div>

                    <!-- Ìè¨Î™®ÎèÑÎ°ú ÌÉÄÏù¥Î®∏ ÏÑπÏÖò -->
                    <div>
                        <h3 style="font-size: 1rem; font-weight: 600; color: #495057; margin-bottom: 15px;">üçÖ Ìè¨Î™®ÎèÑÎ°ú ÌÉÄÏù¥Î®∏</h3>
                        <div class="pomodoro-display">
                            <div class="pomodoro-mode" id="pomodoro-mode">ÏûëÏóÖ ÏÑ∏ÏÖò</div>
                            <div class="timer-display" id="pomodoro-timer">25:00</div>
                            <div class="pomodoro-session-count">
                                ÏôÑÎ£åÎêú ÏÑ∏ÏÖò: <span id="pomodoro-count">0</span>Í∞ú
                            </div>
                        </div>
                        <div class="timer-controls">
                            <button class="timer-btn start" id="pomodoro-start" onclick="startPomodoro()">ÏãúÏûë</button>
                            <button class="timer-btn pause" id="pomodoro-pause" onclick="pausePomodoro()" style="display:none;">ÏùºÏãúÏ†ïÏßÄ</button>
                            <button class="timer-btn reset" onclick="resetPomodoro()">Î¶¨ÏÖã</button>
                            <button class="timer-btn" onclick="showPomodoroSettings()" style="background: #6c757d;">‚öôÔ∏è ÏãúÍ∞Ñ ÏÑ§Ï†ï</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Í≥ºÎ™©Î≥Ñ ÏßÑÎèÑ ÌòÑÌô© -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">üìä Í≥ºÎ™©Î≥Ñ ÏßÑÎèÑÏú®</h2>
                    <div class="card-actions">
                        <button class="action-btn" onclick="updateAllProgress()" aria-label="Í≥ºÎ™©Î≥Ñ ÏßÑÎèÑ ÏàòÏ†ï">‚úèÔ∏è</button>
                    </div>
                </div>
                <div class="subject-progress" id="subject-progress">
                    <!-- ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                </div>
            </div>
            
            <!-- Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàò Ìä∏ÎûòÏª§ -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">üìù Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàò Ï∂îÏù¥</h2>
                    <div class="card-actions">
                        <button class="action-btn" onclick="showScoreModal()" aria-label="Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàò Ï∂îÍ∞Ä">‚ûï</button>
                    </div>
                </div>
                <div class="mock-scores" id="mock-scores">
                    <!-- ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                </div>
            </div>
            
            <!-- ÎèôÍ∏∞Î∂ÄÏó¨ Ïπ¥Îìú -->
            <div class="card">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; text-align: center;">
                    <div style="font-size: 1.1rem; font-style: italic; margin-bottom: 10px;" id="motivation-quote">
                        "Ìè¨Í∏∞ÌïòÏßÄ ÏïäÏúºÎ©¥ Î∞òÎìúÏãú Ìï©Í≤©ÌïúÎã§. ÏãúÌóòÏùÄ ÎÅùÍπåÏßÄ Î≤ÑÌã∞Îäî Í≤ÉÏûÖÎãàÎã§."
                    </div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">- 29Ìöå Ìï©Í≤©Ïûê -</div>
                </div>
                <div style="background: #FFF5F5; padding: 15px; border-radius: 8px; border-left: 4px solid var(--danger); margin-top: 15px;">
                    <div style="font-weight: 600; margin-bottom: 10px; color: var(--danger);">üèÜ Ìï©Í≤©Ïûê Ï°∞Ïñ∏</div>
                    <div style="font-size: 0.9rem; line-height: 1.6;">
                        ‚Ä¢ Í∏∞Ï∂úÎ¨∏Ï†ú 6-7ÌöåÎèÖÏù¥ ÌïµÏã¨<br>
                        ‚Ä¢ ÏµúÏã†ÌåêÎ°ÄÎäî Î∞òÎìúÏãú Ï≤¥ÌÅ¨<br>
                        ‚Ä¢ Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàòÏóê Ïó∞Ïó∞ÌïòÏßÄ Îßê Í≤É<br>
                        ‚Ä¢ Îß§Ïùº Íæ∏Ï§ÄÌûàÍ∞Ä ÎãµÏûÖÎãàÎã§
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨ ÏÑπÏÖò -->
        <div class="card data-management-card">
            <div class="card-header">
                <h2 class="card-title">üíæ Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨</h2>
            </div>
            <div class="data-management-section">
                <p class="data-management-desc">ÌïôÏäµ Îç∞Ïù¥ÌÑ∞Î•º ÏïàÏ†ÑÌïòÍ≤å Î∞±ÏóÖÌïòÍ≥† Îã§Î•∏ Í∏∞Í∏∞ÏóêÏÑú Î∂àÎü¨Ïò¨ Ïàò ÏûàÏäµÎãàÎã§</p>
                <div class="data-management-actions">
                    <button class="data-btn export-btn" onclick="exportData()">
                        <span class="btn-icon">‚¨áÔ∏è</span>
                        <span class="btn-text">Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞</span>
                    </button>
                    <button class="data-btn import-btn" onclick="document.getElementById('importFileInput').click()">
                        <span class="btn-icon">‚¨ÜÔ∏è</span>
                        <span class="btn-text">Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞</span>
                    </button>
                    <input type="file" id="importFileInput" accept=".json" style="display: none;" onchange="importData(event)">
                </div>
                <div class="data-management-info">
                    <small>ÎÇ¥Î≥¥ÎÇ¥Í∏∞: Î™®Îì† ÌïôÏäµ Îç∞Ïù¥ÌÑ∞Î•º JSON ÌååÏùºÎ°ú Ï†ÄÏû•Ìï©ÎãàÎã§</small><br>
                    <small>Í∞ÄÏ†∏Ïò§Í∏∞: Ïù¥Ï†ÑÏóê Ï†ÄÏû•Ìïú Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨ÏòµÎãàÎã§ (ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞Îäî ÎåÄÏ≤¥Îê©ÎãàÎã§)</small>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div style="text-align: center; padding: 20px; color: var(--text-secondary); font-size: 0.85rem;">
            ÏãúÌóò Ï†ÑÎûµÏ†Å ÌïôÏäµ ÏãúÏä§ÌÖú v2.13.0 | Chart.js Îç∞Ïù¥ÌÑ∞ ÏãúÍ∞ÅÌôî ÎåÄÏãúÎ≥¥Îìú | Apple ÎîîÏûêÏù∏ ÏãúÏä§ÌÖú | Ïã§ÏãúÍ∞Ñ ÎèôÍ∏∞Ìôî ÏÉÅÌÉú Î™®ÎãàÌÑ∞ÎßÅ
        </div>
    </div>
    
    <!-- Î™®Îã¨Îì§ -->
    <div id="scoreModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàò Ï∂îÍ∞Ä</h3>
                <button class="modal-close" aria-label="Îã´Í∏∞" onclick="closeModal('scoreModal')" aria-label="Îã´Í∏∞">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ÏãúÌóò ÎÇ†Ïßú</label>
                    <input type="date" class="form-input" id="scoreDate">
                </div>
                <div class="form-group">
                    <label class="form-label">Ï†êÏàò</label>
                    <input type="number" step="0.5" class="form-input" id="scoreValue" placeholder="Ïòà: 58.5">
                </div>
                <div class="form-group">
                    <label class="form-label">Î©îÎ™® (ÏÑ†ÌÉù)</label>
                    <input type="text" class="form-input" id="scoreMemo" placeholder="Ïòà: 3Ï∞® Î™®ÏùòÍ≥†ÏÇ¨">
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('scoreModal')">Ï∑®ÏÜå</button>
                <button class="modal-btn save" onclick="saveScore()">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>
    
    <div id="timeBlockModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ÌïôÏäµ ÏãúÍ∞Ñ Î∏îÎ°ù Ï∂îÍ∞Ä</h3>
                <button class="modal-close" aria-label="Îã´Í∏∞" onclick="closeModal('timeBlockModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ÏãúÏûë ÏãúÍ∞Ñ</label>
                    <input type="time" class="form-input" id="blockStartTime">
                </div>
                <div class="form-group">
                    <label class="form-label">ÎÅù ÏãúÍ∞Ñ</label>
                    <input type="time" class="form-input" id="blockEndTime">
                </div>
                <div class="form-group">
                    <label class="form-label">Í≥ºÎ™©</label>
                    <select class="form-select" id="blockSubject" required>
                        <option value="" disabled selected>Í≥ºÎ™©ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                        <optgroup label="1Ï∞® ÏãúÌóò">
                            <option value="ÌóåÎ≤ï">ÌóåÎ≤ï</option>
                            <option value="ÎØºÎ≤ï">ÎØºÎ≤ï</option>
                            <option value="ÏÉÅÎ≤ï">ÏÉÅÎ≤ï</option>
                            <option value="ÎØºÏÇ¨ÏßëÌñâÎ≤ï">ÎØºÏÇ¨ÏßëÌñâÎ≤ï</option>
                            <option value="Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï">Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï</option>
                            <option value="ÏÉÅÏóÖÎì±Í∏∞Î≤ï">ÏÉÅÏóÖÎì±Í∏∞Î≤ï</option>
                            <option value="Í≥µÌÉÅÎ≤ï">Í≥µÌÉÅÎ≤ï</option>
                        </optgroup>
                        <optgroup label="2Ï∞® ÏãúÌóò">
                            <option value="ÎØºÎ≤ï (2Ï∞®)">ÎØºÎ≤ï (2Ï∞®)</option>
                            <option value="ÌòïÎ≤ï (2Ï∞®)">ÌòïÎ≤ï (2Ï∞®)</option>
                            <option value="ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï (2Ï∞®)">ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï (2Ï∞®)</option>
                            <option value="ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï (2Ï∞®)">ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï (2Ï∞®)</option>
                            <option value="ÎØºÏÇ¨ÏÇ¨Í±¥ÏÑúÎ•òÏûëÏÑ± (2Ï∞®)">ÎØºÏÇ¨ÏÇ¨Í±¥ÏÑúÎ•òÏûëÏÑ± (2Ï∞®)</option>
                            <option value="Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï (2Ï∞®)">Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï (2Ï∞®)</option>
                            <option value="Îì±Í∏∞Ïã†Ï≤≠ÏÑúÎ•òÏûëÏÑ± (2Ï∞®)">Îì±Í∏∞Ïã†Ï≤≠ÏÑúÎ•òÏûëÏÑ± (2Ï∞®)</option>
                        </optgroup>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">ÏòàÏÉÅ ÌïôÏäµ ÏãúÍ∞Ñ (ÏãúÍ∞Ñ)</label>
                    <input type="number" class="form-input" id="blockHours" placeholder="Ïòà: 2" min="0.5" step="0.5" value="2">
                </div>
                <div class="form-group">
                    <label class="form-label">ÌïôÏäµ ÎÇ¥Ïö©</label>
                    <input type="text" class="form-input" id="blockDetail" placeholder="Ïòà: Í∏∞Ï∂úÎ¨∏Ï†ú #201-250">
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('timeBlockModal')">Ï∑®ÏÜå</button>
                <button class="modal-btn save" onclick="saveTimeBlock()">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <!-- ÏãúÌóò ÎÇ†Ïßú ÏÑ§Ï†ï Î™®Îã¨ -->
    <div id="examDateModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="examDateModalTitle">ÏãúÌóò ÎÇ†Ïßú ÏÑ§Ï†ï</h3>
                <button class="modal-close" aria-label="Îã´Í∏∞" onclick="closeModal('examDateModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ÏãúÌóò ÎÇ†Ïßú</label>
                    <input type="date" class="form-input" id="examDateInput">
                </div>
                <div class="form-group">
                    <label class="form-label">Î©îÎ™® (ÏÑ†ÌÉù)</label>
                    <input type="text" class="form-input" id="examDateMemo" placeholder="Ïòà: ÌïÑÍ∏∞ÏãúÌóò">
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('examDateModal')">Ï∑®ÏÜå</button>
                <button class="modal-btn save" onclick="saveExamDate()">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <!-- Í≥ºÎ™© ÏßÑÎèÑ ÏàòÏ†ï Î™®Îã¨ -->
    <div id="subjectProgressModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="subjectProgressModalTitle">Í≥ºÎ™© ÏßÑÎèÑ ÏàòÏ†ï</h3>
                <button class="modal-close" aria-label="Îã´Í∏∞" onclick="closeModal('subjectProgressModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ÏôÑÎ£å Î¨∏Ï†úÏàò</label>
                    <input type="number" class="form-input" id="subjectCompleted" min="0">
                </div>
                <div class="form-group">
                    <label class="form-label">Î™©Ìëú Î¨∏Ï†úÏàò</label>
                    <input type="number" class="form-input" id="subjectTotal" min="1">
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('subjectProgressModal')">Ï∑®ÏÜå</button>
                <button class="modal-btn save" onclick="saveSubjectProgress()">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <!-- Ï£ºÍ∞Ñ ÌïôÏäµ ÏãúÍ∞Ñ ÏàòÏ†ï Î™®Îã¨ -->
    <div id="weeklyHoursModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="weeklyHoursModalTitle">ÌïôÏäµ ÏãúÍ∞Ñ ÏàòÏ†ï</h3>
                <button class="modal-close" aria-label="Îã´Í∏∞" onclick="closeModal('weeklyHoursModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ÌïôÏäµ ÏãúÍ∞Ñ (ÏãúÍ∞Ñ)</label>
                    <input type="number" class="form-input" id="weeklyHoursInput" min="0" step="0.5">
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('weeklyHoursModal')">Ï∑®ÏÜå</button>
                <button class="modal-btn save" onclick="saveWeeklyHours()">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <!-- Ìè¨Î™®ÎèÑÎ°ú ÌÉÄÏù¥Î®∏ ÏÑ§Ï†ï Î™®Îã¨ -->
    <div id="pomodoroSettingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‚öôÔ∏è Ìè¨Î™®ÎèÑÎ°ú ÌÉÄÏù¥Î®∏ ÏÑ§Ï†ï</h3>
                <button class="modal-close" aria-label="Îã´Í∏∞" onclick="closeModal('pomodoroSettingsModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">ÏûëÏóÖ ÏãúÍ∞Ñ (Î∂Ñ)</label>
                    <input type="number" class="form-input" id="pomodoroWorkMinutes" min="1" max="120" step="1" value="25">
                    <small style="color: #6c757d; font-size: 0.85rem; display: block; margin-top: 5px;">Í∂åÏû•: 25Î∂Ñ (Í∏∞Î≥∏ Ìè¨Î™®ÎèÑÎ°ú)</small>
                </div>
                <div class="form-group" style="margin-top: 15px;">
                    <label class="form-label">Ìú¥Ïãù ÏãúÍ∞Ñ (Î∂Ñ)</label>
                    <input type="number" class="form-input" id="pomodoroBreakMinutes" min="1" max="30" step="1" value="5">
                    <small style="color: #6c757d; font-size: 0.85rem; display: block; margin-top: 5px;">Í∂åÏû•: 5Î∂Ñ</small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('pomodoroSettingsModal')">Ï∑®ÏÜå</button>
                <button class="modal-btn save" onclick="savePomodoroSettings()">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <!-- ÌôïÏù∏ Î™®Îã¨ (confirm ÎåÄÏ≤¥) -->
    <div id="confirmModal" class="modal confirm-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="confirmModalTitle">ÌôïÏù∏</h3>
                <button class="modal-close" aria-label="Îã´Í∏∞" onclick="closeModal('confirmModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="confirm-message" id="confirmMessage">Ï†ïÎßê Ïã§ÌñâÌïòÏãúÍ≤†ÏäµÎãàÍπå?</div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('confirmModal')">Ï∑®ÏÜå</button>
                <button class="modal-btn save" id="confirmOkBtn">ÌôïÏù∏</button>
            </div>
        </div>
    </div>

    <!-- ÌãÄÎ¶∞ Î¨∏Ï†ú ÎÖ∏Ìä∏ Î™®Îã¨ -->
    <div id="wrongNoteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ÌãÄÎ¶∞ Î¨∏Ï†ú ÎÖ∏Ìä∏ Ï∂îÍ∞Ä</h3>
                <button class="modal-close" aria-label="Îã´Í∏∞" onclick="closeModal('wrongNoteModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Í≥ºÎ™©Î™Ö</label>
                    <input type="text" class="form-input" id="wrongSubject" placeholder="Ïòà: ÎØºÎ≤ï">
                </div>
                <div class="form-group">
                    <label class="form-label">ÌãÄÎ¶∞ Î¨∏Ï†ú Î≤àÌò∏ ÎòêÎäî ÎÇ¥Ïö©</label>
                    <input type="text" class="form-input" id="wrongQuestion" placeholder="Ïòà: 2024ÎÖÑ 1Ìöå 35Î≤à">
                </div>
                <div class="form-group">
                    <label class="form-label">ÌãÄÎ¶∞ Ïù¥Ïú†</label>
                    <textarea class="form-input" id="wrongReason" rows="3" placeholder="Ïù¥Ïú†Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('wrongNoteModal')">Ï∑®ÏÜå</button>
                <button class="modal-btn save" onclick="saveWrongNote()">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <!-- Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ ÌôïÏù∏ Î™®Îã¨ -->
    <div id="importConfirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ ÌôïÏù∏</h3>
                <button class="modal-close" aria-label="Îã´Í∏∞" onclick="closeModal('importConfirmModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="confirm-message" style="margin-bottom: 20px; color: var(--warning-dark); font-weight: 600;">
                    ‚ö†Ô∏è ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞Î•º Í∞ÄÏ†∏Ïò® Îç∞Ïù¥ÌÑ∞Î°ú ÍµêÏ≤¥ÌïòÏãúÍ≤†ÏäµÎãàÍπå?<br>
                    <span style="font-size: 0.9rem; color: var(--danger-color);">ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞Îäî ÏôÑÏ†ÑÌûà ÏÇ≠Ï†úÎêòÎ©∞ Î≥µÍµ¨Ìï† Ïàò ÏóÜÏäµÎãàÎã§.</span>
                </div>
                <div class="import-preview" id="importPreviewContainer">
                    <!-- Í∞ÄÏ†∏Ïò¨ Îç∞Ïù¥ÌÑ∞ ÎØ∏Î¶¨Î≥¥Í∏∞Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal('importConfirmModal')">Ï∑®ÏÜå</button>
                <button class="modal-btn save" id="confirmImportBtn" style="background: var(--danger-color);">ÌôïÏù∏ Î∞è Í∞ÄÏ†∏Ïò§Í∏∞</button>
            </div>
        </div>
    </div>

    <!-- ÌÜ†Ïä§Ìä∏ ÏïåÎ¶º Ïª®ÌÖåÏù¥ÎÑà -->
    <div id="toastContainer" class="toast-container"></div>

    <script>
        console.log('‚úÖ Î©îÏù∏ Ïä§ÌÅ¨Î¶ΩÌä∏ ÏãúÏûëÎê®');

        // Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
        let studyData = {
            examType: localStorage.getItem('examType') || '1Ï∞®',
            examDates: {
                '1Ï∞®': null,  // Format: 'YYYY-MM-DD'
                '2Ï∞®': null
            },
            timer: {
                seconds: 0,
                isRunning: false,
                interval: null
            },
            pomodoro: {
                workMinutes: 25, // Configurable work time
                breakMinutes: 5, // Configurable break time
                seconds: 1500, // 25 minutes (will be updated based on workMinutes)
                isRunning: false,
                interval: null,
                mode: 'work', // 'work' or 'break'
                completedSessions: 0
            },
            subjects1st: [
                { name: 'ÌóåÎ≤ï', total: 500, completed: 320, rotations: [true, true, false, false, false, false, false] },
                { name: 'ÎØºÎ≤ï', total: 800, completed: 580, rotations: [true, true, true, false, false, false, false] },
                { name: 'ÏÉÅÎ≤ï', total: 500, completed: 280, rotations: [true, true, false, false, false, false, false] },
                { name: 'ÎØºÏÇ¨ÏßëÌñâÎ≤ï', total: 400, completed: 180, rotations: [true, false, false, false, false, false, false] },
                { name: 'Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï', total: 500, completed: 420, rotations: [true, true, true, true, false, false, false] },
                { name: 'ÏÉÅÏóÖÎì±Í∏∞Î≤ï', total: 300, completed: 150, rotations: [true, false, false, false, false, false, false] },
                { name: 'Í≥µÌÉÅÎ≤ï', total: 300, completed: 200, rotations: [true, true, false, false, false, false, false] }
            ],
            subjects2nd: [
                { name: 'ÎØºÎ≤ï (2Ï∞®)', total: 100, completed: 0, rotations: [false, false, false, false, false, false, false] },
                { name: 'ÌòïÎ≤ï (2Ï∞®)', total: 50, completed: 0, rotations: [false, false, false, false, false, false, false] },
                { name: 'ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï (2Ï∞®)', total: 50, completed: 0, rotations: [false, false, false, false, false, false, false] },
                { name: 'ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï (2Ï∞®)', total: 70, completed: 0, rotations: [false, false, false, false, false, false, false] },
                { name: 'ÎØºÏÇ¨ÏÇ¨Í±¥ÏÑúÎ•òÏûëÏÑ± (2Ï∞®)', total: 30, completed: 0, rotations: [false, false, false, false, false, false, false] },
                { name: 'Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï (2Ï∞®)', total: 70, completed: 0, rotations: [false, false, false, false, false, false, false] },
                { name: 'Îì±Í∏∞Ïã†Ï≤≠ÏÑúÎ•òÏûëÏÑ± (2Ï∞®)', total: 30, completed: 0, rotations: [false, false, false, false, false, false, false] }
            ],
            subjects: [],  // Will be set dynamically based on examType
            timeBlocks: [
                { id: Date.now() - 1000000, subject: 'ÌóåÎ≤ï', hours: 2.5, duration: 2.5, date: new Date(Date.now() - 6 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                { id: Date.now() - 999000, subject: 'ÎØºÎ≤ï', hours: 3, duration: 3, date: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                { id: Date.now() - 998000, subject: 'ÏÉÅÎ≤ï', hours: 2, duration: 2, date: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                { id: Date.now() - 997000, subject: 'Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï', hours: 2.5, duration: 2.5, date: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: false },
                { id: Date.now() - 996000, subject: 'ÌóåÎ≤ï', hours: 1.5, duration: 1.5, date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                { id: Date.now() - 995000, subject: 'ÎØºÏÇ¨ÏßëÌñâÎ≤ï', hours: 2, duration: 2, date: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true }
            ],
            mockScores: [
                { id: Date.now() - 100000, date: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 65, examType: '1Ï∞®' },
                { id: Date.now() - 90000, date: new Date(Date.now() - 23 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 72, examType: '1Ï∞®' },
                { id: Date.now() - 80000, date: new Date(Date.now() - 16 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 68, examType: '1Ï∞®' },
                { id: Date.now() - 70000, date: new Date(Date.now() - 9 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 78, examType: '1Ï∞®' },
                { id: Date.now() - 60000, date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 82, examType: '1Ï∞®' }
            ],
            weeklyHours: {},
            notes: {},
            // New features data
            streak: {
                current: 5,
                longest: 12,
                lastStudyDate: new Date().toISOString().split('T')[0],
                totalDays: 18
            },
            goals: [
                { title: '1Ï∞® ÏãúÌóò Ìï©Í≤©', dueDate: new Date(Date.now() + 60 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], achieved: false, progress: 75 },
                { title: 'Ï†Ñ Í≥ºÎ™© 3ÌöåÎèÖ', dueDate: new Date(Date.now() + 90 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], achieved: false, progress: 45 }
            ],
            subjectTimeSpent: {
                'ÌóåÎ≤ï': 12.5,
                'ÎØºÎ≤ï': 15,
                'ÏÉÅÎ≤ï': 8,
                'Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï': 10,
                'ÎØºÏÇ¨ÏßëÌñâÎ≤ï': 8,
                'Í≥µÌÉÅÎ≤ï': 5,
                'ÏÉÅÏóÖÎì±Í∏∞Î≤ï': 3
            },  // Track time spent per subject
            studyHistory: []  // Daily study records
        };

        // Ï†ÑÏó≠ Î≥ÄÏàò ÏÑ†Ïñ∏ (Î™®Îã¨ Ìé∏Ïßë ÏÉÅÌÉú Ï∂îÏ†Å)
        let editingBlockId = null;  // ÏãúÍ∞Ñ Î∏îÎ°ù Ìé∏Ïßë Î™®Îìú Ï∂îÏ†Å
        let editingScoreId = null;  // Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàò Ìé∏Ïßë Î™®Îìú Ï∂îÏ†Å
        let editingGoalId = null;   // ÌïôÏäµ Î™©Ìëú Ìé∏Ïßë Î™®Îìú Ï∂îÏ†Å

        // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        function loadData() {
            const saved = localStorage.getItem('studyData');
            if (saved) {
                const loadedData = JSON.parse(saved);
                studyData = { ...studyData, ...loadedData };

                // 2Ï∞® Í≥ºÎ™©Ïù¥ ÏóÜÍ±∞ÎÇò Íµ¨Î≤ÑÏ†ÑÏù∏ Í≤ΩÏö∞ ÏÉàÎ°úÏö¥ Í∏∞Î≥∏Í∞í ÏÑ§Ï†ï
                if (!studyData.subjects2nd || studyData.subjects2nd.length === 4) {
                    studyData.subjects2nd = [
                        { name: 'ÎØºÎ≤ï (2Ï∞®)', total: 100, completed: 0, rotations: [false, false, false, false, false, false, false] },
                        { name: 'ÌòïÎ≤ï (2Ï∞®)', total: 50, completed: 0, rotations: [false, false, false, false, false, false, false] },
                        { name: 'ÌòïÏÇ¨ÏÜåÏÜ°Î≤ï (2Ï∞®)', total: 50, completed: 0, rotations: [false, false, false, false, false, false, false] },
                        { name: 'ÎØºÏÇ¨ÏÜåÏÜ°Î≤ï (2Ï∞®)', total: 70, completed: 0, rotations: [false, false, false, false, false, false, false] },
                        { name: 'ÎØºÏÇ¨ÏÇ¨Í±¥ÏÑúÎ•òÏûëÏÑ± (2Ï∞®)', total: 30, completed: 0, rotations: [false, false, false, false, false, false, false] },
                        { name: 'Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï (2Ï∞®)', total: 70, completed: 0, rotations: [false, false, false, false, false, false, false] },
                        { name: 'Îì±Í∏∞Ïã†Ï≤≠ÏÑúÎ•òÏûëÏÑ± (2Ï∞®)', total: 30, completed: 0, rotations: [false, false, false, false, false, false, false] }
                    ];
                }

                // 1Ï∞® Í≥ºÎ™©Ïù¥ ÏóÜÏúºÎ©¥ Í∏∞Î≥∏Í∞í ÏÑ§Ï†ï (Íµ¨Î≤ÑÏ†Ñ Ìò∏ÌôòÏÑ±)
                if (!studyData.subjects1st && studyData.subjects) {
                    studyData.subjects1st = studyData.subjects;
                }

                // Ensure sample data is preserved if empty
                if (!studyData.timeBlocks || studyData.timeBlocks.length === 0) {
                    studyData.timeBlocks = [
                        { subject: 'ÌóåÎ≤ï', hours: 2.5, duration: 2.5, date: new Date(Date.now() - 6 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                        { subject: 'ÎØºÎ≤ï', hours: 3, duration: 3, date: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                        { subject: 'ÏÉÅÎ≤ï', hours: 2, duration: 2, date: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                        { subject: 'Î∂ÄÎèôÏÇ∞Îì±Í∏∞Î≤ï', hours: 2.5, duration: 2.5, date: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: false },
                        { subject: 'ÌóåÎ≤ï', hours: 1.5, duration: 1.5, date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true },
                        { subject: 'ÎØºÏÇ¨ÏßëÌñâÎ≤ï', hours: 2, duration: 2, date: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], completed: true }
                    ];
                }
                if (!studyData.mockScores || studyData.mockScores.length === 0) {
                    studyData.mockScores = [
                        { date: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 65, examType: '1Ï∞®' },
                        { date: new Date(Date.now() - 23 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 72, examType: '1Ï∞®' },
                        { date: new Date(Date.now() - 16 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 68, examType: '1Ï∞®' },
                        { date: new Date(Date.now() - 9 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 78, examType: '1Ï∞®' },
                        { date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], score: 82, examType: '1Ï∞®' }
                    ];
                }
            }

            // ÏãúÌóò ÌÉÄÏûÖÏóê Îî∞Îùº Í≥ºÎ™© ÏÑ§Ï†ï
            updateSubjectsByExamType();

            // Ïò§Îäò ÌÉÄÏù¥Î®∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            const today = new Date().toISOString().split('T')[0];
            const todayTimer = localStorage.getItem(`timer_${today}`);
            if (todayTimer) {
                studyData.timer.seconds = parseInt(todayTimer);
            }
        }

        // ÏãúÌóò ÌÉÄÏûÖÏóê Îî∞Îùº Í≥ºÎ™© ÏÑ§Ï†ï
        function updateSubjectsByExamType() {
            if (studyData.examType === '2Ï∞®') {
                studyData.subjects = studyData.subjects2nd;
            } else {
                studyData.subjects = studyData.subjects1st;
            }
        }
        
        // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
        function saveData() {
            localStorage.setItem('studyData', JSON.stringify(studyData));

            // Ïò§Îäò ÌÉÄÏù¥Î®∏ Î≥ÑÎèÑ Ï†ÄÏû•
            const today = new Date().toISOString().split('T')[0];
            localStorage.setItem(`timer_${today}`, studyData.timer.seconds);

            // v3.0.0 ÎèôÍ∏∞Ìôî ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
            updateSyncBadge();
        }

        // v3.0.0 ÎèôÍ∏∞Ìôî ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
        function updateSyncBadge() {
            const syncBadge = document.getElementById('syncBadge');
            if (!syncBadge) return;

            // "Ï†ÄÏû•Ï§ë..." ÏÉÅÌÉú
            syncBadge.classList.add('saving');
            syncBadge.querySelector('.sync-badge-text').textContent = 'Ï†ÄÏû•Ï§ë...';
            syncBadge.querySelector('.sync-badge-icon').textContent = '‚è≥';

            // 300ms ÌõÑ "Ï†ÄÏû•Îê®" ÏÉÅÌÉúÎ°ú Î≥ÄÍ≤Ω
            setTimeout(() => {
                syncBadge.classList.remove('saving');
                syncBadge.classList.remove('syncing');
                syncBadge.querySelector('.sync-badge-text').textContent = 'Ï†ÄÏû•Îê®';
                syncBadge.querySelector('.sync-badge-icon').textContent = '‚úì';
                syncBadge.querySelector('#syncTime').textContent = 'Î∞©Í∏à Ï†Ñ';
            }, 300);

            // 5Ï¥à ÌõÑ ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏ ÏãúÏûë
            setTimeout(() => {
                updateSyncTime();
            }, 5000);
        }

        // ÎèôÍ∏∞Ìôî ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
        let syncTimeInterval;
        function updateSyncTime() {
            const syncBadge = document.getElementById('syncBadge');
            if (!syncBadge) return;

            if (syncTimeInterval) clearInterval(syncTimeInterval);

            syncTimeInterval = setInterval(() => {
                const timeEl = document.getElementById('syncTime');
                if (timeEl) {
                    // "Î∞©Í∏à Ï†Ñ" ‚Üí "1Î∂Ñ Ï†Ñ" ‚Üí "2Î∂Ñ Ï†Ñ" Îì±ÏúºÎ°ú ÏóÖÎç∞Ïù¥Ìä∏
                    // Í∞ÑÎã®Ìûà Íµ¨ÌòÑÌïòÎ©¥:
                    const now = new Date();
                    const elapsed = Math.floor((now.getTime() - new Date().getTime()) / 1000);
                    if (elapsed < 60) {
                        timeEl.textContent = 'Î∞©Í∏à Ï†Ñ';
                    } else if (elapsed < 3600) {
                        const minutes = Math.floor(elapsed / 60);
                        timeEl.textContent = `${minutes}Î∂Ñ Ï†Ñ`;
                    } else {
                        const hours = Math.floor(elapsed / 3600);
                        timeEl.textContent = `${hours}ÏãúÍ∞Ñ Ï†Ñ`;
                    }
                }
            }, 30000); // 30Ï¥àÎßàÎã§ ÏóÖÎç∞Ïù¥Ìä∏
        }
        
        // Ï¥àÍ∏∞Ìôî Ìï®Ïàò
        function init() {
            loadData();
            updateSubjectsByExamType(); // Set subjects based on exam type
            updateDDay();
            updateStreak();
            renderTimeBlocks();
            renderRotationTracker();
            renderWeeklyStats();
            renderSubjectProgress();
            renderMockScores();
            updateTimerDisplay();
            updatePomodoroDisplay();
            document.getElementById('pomodoro-count').textContent = studyData.pomodoro.completedSessions || 0;
            rotateMotivation();
            renderAnalytics();
            updateSyncStatus(); // Update data size display on initial load

            // ÏãúÌóò ÌÉÄÏûÖ Î∞è Î™®Îìú ÏÑ§Ï†ï
            document.querySelectorAll('.mode-btn').forEach(btn => {
                const btnText = btn.textContent.trim();
                // ÏãúÌóò ÌÉÄÏûÖ Î≤ÑÌäº
                if (btnText === '1Ï∞® ÏãúÌóò' || btnText === '2Ï∞® ÏãúÌóò') {
                    btn.classList.remove('active');
                    if (btnText === studyData.examType + ' ÏãúÌóò') {
                        btn.classList.add('active');
                    }
                }
                // ÌïôÏäµ Î™®Îìú Î≤ÑÌäº
                else {
                    btn.classList.remove('active');
                    if(btnText.includes(studyData.mode)) {
                        btn.classList.add('active');
                    }
                }
            });

            // v3.0.0 ÏÉà Í∏∞Îä• Ï¥àÍ∏∞Ìôî
            setTimeout(() => {
                startProgressUpdate(); // Sticky Progress Bar ÏãúÏûë
                enableNotesAutoSave(); // Notes Auto-save ÌôúÏÑ±Ìôî
                console.log('‚úÖ v3.0.0 ÏÉà Í∏∞Îä• ÌôúÏÑ±ÌôîÎê®');
            }, 500);

            // Note: Sample data is already initialized in the studyData object above
            // This prevents overwriting sample data with old defaults
        }
        
        // D-Day Í≥ÑÏÇ∞ Î∞è ÏóÖÎç∞Ïù¥Ìä∏ (1Ï∞®/2Ï∞®)
        function updateDDay() {
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            // 1Ï∞® ÏãúÌóò D-day
            const exam1stDate = studyData.examDates?.['1Ï∞®'];
            const card1st = document.getElementById('dday-1st-card');
            if (exam1stDate) {
                const targetDate = new Date(exam1stDate);
                targetDate.setHours(0, 0, 0, 0);
                const diffDays = Math.ceil((targetDate - today) / (1000 * 60 * 60 * 24));

                let ddayText, urgencyClass;
                if (diffDays > 0) {
                    ddayText = `D-${diffDays}`;
                    urgencyClass = diffDays <= 30 ? 'urgent' : (diffDays <= 90 ? 'warning' : 'normal');
                } else if (diffDays === 0) {
                    ddayText = 'D-Day';
                    urgencyClass = 'urgent';
                } else {
                    ddayText = `D+${Math.abs(diffDays)}`;
                    urgencyClass = 'normal';
                }

                document.getElementById('dday-1st-value').textContent = ddayText;
                document.getElementById('dday-1st-date').textContent = exam1stDate;
                card1st.className = `dday-card ${urgencyClass}`;
            } else {
                document.getElementById('dday-1st-value').textContent = 'D-?';
                document.getElementById('dday-1st-date').textContent = 'ÎÇ†Ïßú ÎØ∏ÏÑ§Ï†ï';
                card1st.className = 'dday-card';
            }

            // 2Ï∞® ÏãúÌóò D-day
            const exam2ndDate = studyData.examDates?.['2Ï∞®'];
            const card2nd = document.getElementById('dday-2nd-card');
            if (exam2ndDate) {
                const targetDate = new Date(exam2ndDate);
                targetDate.setHours(0, 0, 0, 0);
                const diffDays = Math.ceil((targetDate - today) / (1000 * 60 * 60 * 24));

                let ddayText, urgencyClass;
                if (diffDays > 0) {
                    ddayText = `D-${diffDays}`;
                    urgencyClass = diffDays <= 30 ? 'urgent' : (diffDays <= 90 ? 'warning' : 'normal');
                } else if (diffDays === 0) {
                    ddayText = 'D-Day';
                    urgencyClass = 'urgent';
                } else {
                    ddayText = `D+${Math.abs(diffDays)}`;
                    urgencyClass = 'normal';
                }

                document.getElementById('dday-2nd-value').textContent = ddayText;
                document.getElementById('dday-2nd-date').textContent = exam2ndDate;
                card2nd.className = `dday-card ${urgencyClass}`;
            } else {
                document.getElementById('dday-2nd-value').textContent = 'D-?';
                document.getElementById('dday-2nd-date').textContent = 'ÎÇ†Ïßú ÎØ∏ÏÑ§Ï†ï';
                card2nd.className = 'dday-card';
            }
        }

        // ÏãúÌóò ÎÇ†Ïßú ÏÑ§Ï†ï Î™®Îã¨
        let editingExamType = null;

        function editExamDate(examType) {
            editingExamType = examType;
            document.getElementById('examDateModalTitle').textContent = `${examType} ÏãúÌóò ÎÇ†Ïßú ÏÑ§Ï†ï`;

            const currentDate = studyData.examDates?.[examType];
            document.getElementById('examDateInput').value = currentDate || '';
            document.getElementById('examDateMemo').value = '';

            document.getElementById('examDateModal').classList.add('show');
        }

        function saveExamDate() {
            if (!editingExamType) return;

            const dateValue = document.getElementById('examDateInput').value;

            if (dateValue) {
                if (!studyData.examDates) studyData.examDates = {};
                studyData.examDates[editingExamType] = dateValue;

                saveData();
                updateDDay();
                closeModal('examDateModal');
                showToast(`${editingExamType} ÏãúÌóò ÎÇ†ÏßúÍ∞Ä ÏÑ§Ï†ïÎêòÏóàÏäµÎãàÎã§`);

                editingExamType = null;
            } else {
                showToast('ÏãúÌóò ÎÇ†ÏßúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî', 'error');
            }
        }
        
        console.log('‚úÖ setExamType Ìï®Ïàò Ï†ïÏùò ÏßÅÏ†Ñ');

        // ÏãúÌóò ÌÉÄÏûÖ ÏÑ§Ï†ï
        function setExamType(type) {
            console.log(`üîÑ Switching exam type to: ${type}`);

            studyData.examType = type;
            localStorage.setItem('examType', type);

            // Í≥ºÎ™© ÏóÖÎç∞Ïù¥Ìä∏
            updateSubjectsByExamType();

            saveData();

            document.querySelectorAll('.mode-btn').forEach(btn => {
                if (btn.textContent.includes('ÏãúÌóò')) {
                    btn.classList.remove('active');
                    if (btn.textContent === type + ' ÏãúÌóò') {
                        btn.classList.add('active');
                    }
                }
            });

            // UI ÏóÖÎç∞Ïù¥Ìä∏ - COMPLETE refresh of all exam-type dependent components
            updateDDay();              // Update D-day counters for both exams
            renderTimeBlocks();        // Refresh time blocks with new subjects
            renderRotationTracker();   // Update rotation tracker
            renderWeeklyStats();       // Refresh weekly statistics
            renderSubjectProgress();   // Update subject progress bars
            renderMockScores();        // Refresh mock exam scores display
            renderAnalytics();         // Update analytics dashboard
            initAllCharts();          // Update all charts with new subjects

            showToast(`${type} ÏãúÌóò Î™®ÎìúÎ°ú Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§`);
            console.log(`‚úÖ Exam type changed to ${type} - All UI components updated`);
        }

        // ÏãúÍ∞Ñ Î∏îÎ°ù Î†åÎçîÎßÅ
        function renderTimeBlocks() {
            const container = document.getElementById('time-blocks-container');
            container.innerHTML = '';

            // Get today's date and filter blocks for today only
            const today = new Date().toISOString().split('T')[0];
            const todayBlocks = studyData.timeBlocks.filter(block =>
                block.date === today  // Only show blocks from today
            );

            // If no blocks for today, show empty state message
            if (todayBlocks.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="text-align: center; padding: 20px; color: var(--text-secondary);">
                        <div style="font-size: 32px; margin-bottom: 8px;">üìö</div>
                        <div>Ïò§ÎäòÏùò ÌïôÏäµ Í≥ÑÌöçÏù¥ ÏóÜÏäµÎãàÎã§</div>
                        <div style="font-size: 12px; margin-top: 8px;">ÌïôÏäµ ÏãúÍ∞ÑÏùÑ Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî</div>
                    </div>
                `;
                return;
            }

            todayBlocks.forEach((block, idx) => {
                const blockEl = document.createElement('div');
                blockEl.className = `time-block ${block.completed ? 'completed' : ''}`;

                // Ïï°ÏÖò Î≤ÑÌäº Ïª®ÌÖåÏù¥ÎÑà
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'time-block-actions';

                // ÏàòÏ†ï Î≤ÑÌäº
                const editBtn = document.createElement('button');
                editBtn.className = 'time-block-btn';
                editBtn.textContent = '‚úèÔ∏è';
                editBtn.onclick = () => editTimeBlock(block);

                // ÏÇ≠Ï†ú Î≤ÑÌäº
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'time-block-btn';
                deleteBtn.textContent = 'üóëÔ∏è';
                deleteBtn.onclick = () => deleteTimeBlock(block);

                actionsDiv.appendChild(editBtn);
                actionsDiv.appendChild(deleteBtn);

                // ÏãúÍ∞Ñ ÎùºÎ≤®
                const timeLabel = document.createElement('div');
                timeLabel.className = 'time-label';
                const hours = block.hours || 2;
                timeLabel.textContent = `‚è∞ ${block.time} (${hours}h)`;

                // Í≥ºÎ™©Î™Ö
                const subjectDiv = document.createElement('div');
                subjectDiv.className = 'time-subject';
                subjectDiv.textContent = block.subject;

                // ÏÉÅÏÑ∏ ÎÇ¥Ïö©
                const detailDiv = document.createElement('div');
                detailDiv.className = 'time-detail';
                detailDiv.textContent = block.detail;

                // ÏôÑÎ£å Î≤ÑÌäº
                const checkBtn = document.createElement('button');
                checkBtn.className = `check-btn ${block.completed ? 'checked' : ''}`;
                checkBtn.textContent = block.completed ? 'ÏôÑÎ£å‚úì' : 'ÏôÑÎ£å';
                checkBtn.onclick = () => toggleTimeBlock(block.id);

                // Î™®Îëê Ï∂îÍ∞Ä
                blockEl.appendChild(actionsDiv);
                blockEl.appendChild(timeLabel);
                blockEl.appendChild(subjectDiv);
                blockEl.appendChild(detailDiv);
                blockEl.appendChild(checkBtn);

                container.appendChild(blockEl);
            });
        }
        
        // ÏãúÍ∞Ñ Î∏îÎ°ù ÌÜ†Í∏Ä
        function toggleTimeBlock(id) {
            const block = studyData.timeBlocks.find(b => b.id === id);
            if (block) {
                block.completed = !block.completed;
                const hours = block.hours || 2; // Default to 2 hours if not set (legacy compatibility)
                const seconds = hours * 3600;
                const today = new Date().toISOString().split('T')[0];

                if (block.completed) {
                    studyData.timer.seconds += seconds;

                    // Populate studyHistory when block is completed
                    if (!studyData.studyHistory) {
                        studyData.studyHistory = [];
                    }

                    // Add or update today's study history entry
                    let todayHistory = studyData.studyHistory.find(h => h.date === today);
                    if (!todayHistory) {
                        todayHistory = {
                            date: today,
                            totalHours: 0,
                            completedBlocks: [],
                            note: ''
                        };
                        studyData.studyHistory.push(todayHistory);
                    }

                    // Add this block to today's history
                    todayHistory.totalHours += hours;
                    todayHistory.completedBlocks.push({
                        subject: block.subject,
                        hours: hours,
                        time: block.time
                    });

                    updateTimerDisplay();
                    showToast(`ÌïôÏäµ ÏôÑÎ£å! ${hours}ÏãúÍ∞ÑÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§ üëè`);
                } else {
                    studyData.timer.seconds = Math.max(0, studyData.timer.seconds - seconds);

                    // Remove from studyHistory when uncompleted
                    if (studyData.studyHistory) {
                        let todayHistory = studyData.studyHistory.find(h => h.date === today);
                        if (todayHistory) {
                            // Remove this block from completed blocks
                            todayHistory.completedBlocks = todayHistory.completedBlocks.filter(
                                cb => !(cb.subject === block.subject && cb.time === block.time)
                            );
                            todayHistory.totalHours -= hours;

                            // If no more blocks, remove the entire day
                            if (todayHistory.completedBlocks.length === 0 && todayHistory.totalHours === 0) {
                                studyData.studyHistory = studyData.studyHistory.filter(h => h.date !== today);
                            }
                        }
                    }

                    updateTimerDisplay();
                }
                saveData();
                renderTimeBlocks();
                updateStreak();
                renderAnalytics();
            }
        }
        
        // ÏãúÍ∞Ñ Î∏îÎ°ù Ï∂îÍ∞Ä
        function addTimeBlock() {
            editingBlockId = null;  // Ìé∏Ïßë Î™®Îìú Ï¥àÍ∏∞Ìôî
            document.getElementById('blockStartTime').value = '';
            document.getElementById('blockEndTime').value = '';
            document.getElementById('blockSubject').value = '';
            document.getElementById('blockDetail').value = '';
            document.querySelector('#timeBlockModal .modal-title').textContent = 'ÌïôÏäµ ÏãúÍ∞Ñ Î∏îÎ°ù Ï∂îÍ∞Ä';
            document.getElementById('timeBlockModal').classList.add('show');
        }
        
        // ÏãúÍ∞Ñ Î∏îÎ°ù Ï†ÄÏû•
        function saveTimeBlock() {
            const startTime = document.getElementById('blockStartTime').value;
            const endTime = document.getElementById('blockEndTime').value;
            const subject = document.getElementById('blockSubject').value;
            const detail = document.getElementById('blockDetail').value;
            // Get today's date in YYYY-MM-DD format for daily tracking
            const today = new Date().toISOString().split('T')[0];

            // Í≤ÄÏ¶ù: ÌïÑÏàò ÌïÑÎìú ÌôïÏù∏
            if (!startTime) {
                showToast('‚ö†Ô∏è ÏãúÏûë ÏãúÍ∞ÑÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî', 'warning');
                return;
            }
            if (!endTime) {
                showToast('‚ö†Ô∏è ÎÅù ÏãúÍ∞ÑÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî', 'warning');
                return;
            }
            if (!subject) {
                showToast('‚ö†Ô∏è Í≥ºÎ™©ÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî', 'warning');
                return;
            }
            if (!detail) {
                showToast('‚ö†Ô∏è ÌïôÏäµ ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî', 'warning');
                return;
            }

            // ÏãúÍ∞Ñ Ï∞®Ïù¥ Í≥ÑÏÇ∞ (HH:MM ÌòïÏãù)
            const [startHour, startMin] = startTime.split(':').map(Number);
            const [endHour, endMin] = endTime.split(':').map(Number);
            const startTotalMins = startHour * 60 + startMin;
            const endTotalMins = endHour * 60 + endMin;

            let diffMins = endTotalMins - startTotalMins;
            if (diffMins <= 0) {
                showToast('‚ö†Ô∏è ÎÅù ÏãúÍ∞ÑÏù¥ ÏãúÏûë ÏãúÍ∞ÑÎ≥¥Îã§ Ïù¥ÌõÑÏó¨Ïïº Ìï©ÎãàÎã§', 'warning');
                return;
            }

            const hours = diffMins / 60; // ÏãúÍ∞ÑÏúºÎ°ú Î≥ÄÌôò
            const time = `${startTime}-${endTime}`; // "HH:MM-HH:MM" ÌòïÏãù

            if (startTime && endTime && subject && detail) {
                if (editingBlockId) {
                    // ÏàòÏ†ï Î™®Îìú
                    const block = studyData.timeBlocks.find(b => b.id === editingBlockId);
                    if (block) {
                        // ÏñëÎ∞©Ìñ• ÎèôÍ∏∞Ìôî: ÏôÑÎ£åÎêú Î∏îÎ°ùÏùò ÏãúÍ∞Ñ Î≥ÄÍ≤Ω Ïãú timerÏóê Î∞òÏòÅ
                        if (block.completed) {
                            const oldSeconds = block.hours * 3600;
                            const newSeconds = hours * 3600;
                            const diffSeconds = newSeconds - oldSeconds;
                            studyData.timer.seconds = Math.max(0, studyData.timer.seconds + diffSeconds);
                        }

                        block.time = time;
                        block.subject = subject;
                        block.hours = hours;
                        block.detail = detail;
                        // Preserve date when editing, or set to today if missing
                        if (!block.date) {
                            block.date = today;
                        }
                        showToast('ÌïôÏäµ Î∏îÎ°ùÏù¥ ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§');
                    }
                    editingBlockId = null;
                } else {
                    // Ï∂îÍ∞Ä Î™®Îìú - Always add with today's date
                    studyData.timeBlocks.push({
                        id: Date.now(),
                        time,
                        subject,
                        hours,
                        detail,
                        date: today,  // Add date field for daily tracking
                        completed: false
                    });
                    showToast('ÌïôÏäµ Î∏îÎ°ùÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§');
                }
                saveData();
                renderTimeBlocks();
                renderAnalytics();
                closeModal('timeBlockModal');

                // Reset form
                document.getElementById('blockStartTime').value = '';
                document.getElementById('blockEndTime').value = '';
                document.getElementById('blockDetail').value = '';
                document.querySelector('#timeBlockModal .modal-title').textContent = 'ÌïôÏäµ ÏãúÍ∞Ñ Î∏îÎ°ù Ï∂îÍ∞Ä';
            }
        }
        
        // ÏãúÍ∞Ñ Î∏îÎ°ù ÏÇ≠Ï†ú
        function deleteTimeBlock(block) {
            showConfirm('Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?', () => {
                // Î∏îÎ°ù Í∞ùÏ≤¥Ïùò Ïù∏Îç±Ïä§Î•º Ï∞æÏïÑÏÑú ÏÇ≠Ï†ú
                const index = studyData.timeBlocks.indexOf(block);
                if (index > -1) {
                    // ÏñëÎ∞©Ìñ• ÎèôÍ∏∞Ìôî: ÏôÑÎ£åÎêú Î∏îÎ°ù ÏÇ≠Ï†ú Ïãú timerÏóêÏÑú Ï∞®Í∞ê
                    if (block.completed) {
                        const seconds = block.hours * 3600;
                        studyData.timer.seconds = Math.max(0, studyData.timer.seconds - seconds);
                    }

                    studyData.timeBlocks.splice(index, 1);
                    console.log('‚úÖ ÏãúÍ∞Ñ Î∏îÎ°ù ÏÇ≠Ï†úÎê®:', block.subject);
                } else {
                    console.warn('‚ö†Ô∏è ÏÇ≠Ï†úÌï† Î∏îÎ°ùÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏùå');
                }
                saveData();
                renderTimeBlocks();
                renderAnalytics();
                showToast('ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§');
            });
        }
        
        // ÏãúÍ∞Ñ Î∏îÎ°ù ÏàòÏ†ï (Î™®Îã¨ ÏÇ¨Ïö©)
        let editingBlock = null;

        function editTimeBlock(block) {
            if (block) {
                editingBlockId = block.id;  // ÏàòÏ†ïÌï† Î∏îÎ°ù ID Ï†ÄÏû•
                // Parse time format "HH:MM-HH:MM"
                const [startTime, endTime] = block.time.split('-');
                document.getElementById('blockStartTime').value = startTime;
                document.getElementById('blockEndTime').value = endTime;
                document.getElementById('blockSubject').value = block.subject;
                document.getElementById('blockDetail').value = block.detail;
                document.querySelector('#timeBlockModal .modal-title').textContent = 'ÌïôÏäµ ÏãúÍ∞Ñ Î∏îÎ°ù ÏàòÏ†ï';
                document.getElementById('timeBlockModal').classList.add('show');
            }
        }
        
        // ÌöåÎèÖ Ìä∏ÎûòÏª§ Î†åÎçîÎßÅ
        function renderRotationTracker() {
            const container = document.getElementById('rotation-tracker');
            container.innerHTML = '';
            
            studyData.subjects.forEach((subject, idx) => {
                const div = document.createElement('div');
                div.className = 'subject-rotation';
                
                let circlesHtml = '';
                subject.rotations.forEach((completed, i) => {
                    const isCurrentjsxjs = completed && !subject.rotations[i + 1];
                    circlesHtml += `
                        <div class="rotation-circle ${completed ? 'completed' : ''} ${isCurrentjsxjs ? 'current' : ''}" 
                             onclick="toggleRotation(${idx}, ${i})">
                            ${i + 1}
                        </div>
                    `;
                });
                
                div.innerHTML = `
                    <span class="subject-name">${subject.name}</span>
                    <div class="rotation-circles">${circlesHtml}</div>
                `;
                container.appendChild(div);
            });
        }
        
        // ÌöåÎèÖ ÌÜ†Í∏Ä
        function toggleRotation(subjectIdx, rotationIdx) {
            const subject = studyData.subjects[subjectIdx];
            subject.rotations[rotationIdx] = !subject.rotations[rotationIdx];
            
            // Ïù¥Ï†Ñ ÌöåÎèÖÏù¥ ÏôÑÎ£åÎêòÏßÄ ÏïäÏïòÏúºÎ©¥ ÏôÑÎ£å Ï≤òÎ¶¨
            for (let i = 0; i < rotationIdx; i++) {
                subject.rotations[i] = true;
            }
            
            saveData();
            renderRotationTracker();
            
            if (subject.rotations[rotationIdx]) {
                showToast(`${subject.name} ${rotationIdx + 1}ÌöåÎèÖ ÏôÑÎ£å! üéâ`);
            }
        }
        
        // ÌöåÎèÖ Ï¥àÍ∏∞Ìôî
        function resetRotations() {
            showConfirm('Î™®Îì† ÌöåÎèÖ Í∏∞Î°ùÏùÑ Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?', () => {
                studyData.subjects.forEach(subject => {
                    subject.rotations = [false, false, false, false, false, false, false];
                });
                saveData();
                renderRotationTracker();
                showToast('ÌöåÎèÖ Í∏∞Î°ùÏù¥ Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§');
            });
        }
        
        // ÌÉÄÏù¥Î®∏ Í∏∞Îä•
        function startTimer() {
            if (!studyData.timer.isRunning) {
                studyData.timer.isRunning = true;
                studyData.timer.interval = setInterval(() => {
                    studyData.timer.seconds++;
                    updateTimerDisplay();
                    
                    // 30Î∂ÑÎßàÎã§ ÏûêÎèô Ï†ÄÏû•
                    if (studyData.timer.seconds % 1800 === 0) {
                        saveData();
                        showToast('ÌïôÏäµ ÏßÑÎèÑÍ∞Ä ÏûêÎèô Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§');
                    }
                }, 1000);
            }
        }
        
        function pauseTimer() {
            studyData.timer.isRunning = false;
            clearInterval(studyData.timer.interval);
            saveData();
        }
        
        function resetTimer() {
            showConfirm('Ï†ïÎßê Î¶¨ÏÖãÌïòÏãúÍ≤†ÏäµÎãàÍπå?', () => {
                studyData.timer.isRunning = false;
                clearInterval(studyData.timer.interval);
                studyData.timer.seconds = 0;
                updateTimerDisplay();
                saveData();
                showToast('ÌÉÄÏù¥Î®∏Í∞Ä Î¶¨ÏÖãÎêòÏóàÏäµÎãàÎã§');
            });
        }
        
        function updateTimerDisplay() {
            const hours = Math.floor(studyData.timer.seconds / 3600);
            const minutes = Math.floor((studyData.timer.seconds % 3600) / 60);
            const secs = studyData.timer.seconds % 60;

            document.getElementById('timer').textContent =
                `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }

        // Ìè¨Î™®ÎèÑÎ°ú ÌÉÄÏù¥Î®∏ Í∏∞Îä•
        function startPomodoro() {
            if (!studyData.pomodoro.isRunning) {
                studyData.pomodoro.isRunning = true;
                document.getElementById('pomodoro-start').style.display = 'none';
                document.getElementById('pomodoro-pause').style.display = 'inline-block';

                studyData.pomodoro.interval = setInterval(() => {
                    if (studyData.pomodoro.seconds > 0) {
                        studyData.pomodoro.seconds--;
                        updatePomodoroDisplay();
                    } else {
                        // Timer finished
                        playNotificationSound();
                        if (studyData.pomodoro.mode === 'work') {
                            // Work session completed
                            studyData.pomodoro.completedSessions++;

                            // Sync pomodoro time (configurable work minutes) with study time
                            const workSeconds = (studyData.pomodoro.workMinutes || 25) * 60;
                            studyData.timer.seconds += workSeconds;
                            updateTimerDisplay();
                            renderAnalytics(); // Refresh dashboard analytics

                            studyData.pomodoro.mode = 'break';
                            studyData.pomodoro.seconds = (studyData.pomodoro.breakMinutes || 5) * 60;
                            showToast(`ÏûëÏóÖ ÏÑ∏ÏÖò ÏôÑÎ£å! ${studyData.pomodoro.breakMinutes}Î∂Ñ Ìú¥Ïãù ÏãúÏûë üéâ | üìö ÌïôÏäµ ÏãúÍ∞ÑÏóê ${studyData.pomodoro.workMinutes}Î∂Ñ Ï∂îÍ∞ÄÎê®`);
                            document.getElementById('pomodoro-mode').textContent = 'Ìú¥Ïãù ÏãúÍ∞Ñ';
                            document.getElementById('pomodoro-mode').className = 'pomodoro-mode break';
                        } else {
                            // Break completed
                            studyData.pomodoro.mode = 'work';
                            studyData.pomodoro.seconds = (studyData.pomodoro.workMinutes || 25) * 60;
                            showToast('Ìú¥Ïãù ÏôÑÎ£å! ÏÉàÎ°úÏö¥ ÏûëÏóÖ ÏÑ∏ÏÖò ÏãúÏûë üí™');
                            document.getElementById('pomodoro-mode').textContent = 'ÏûëÏóÖ ÏÑ∏ÏÖò';
                            document.getElementById('pomodoro-mode').className = 'pomodoro-mode work';
                        }
                        updatePomodoroDisplay();
                        document.getElementById('pomodoro-count').textContent = studyData.pomodoro.completedSessions;
                        pausePomodoro(); // Auto pause after completion
                        saveData();
                    }
                }, 1000);
            }
        }

        function pausePomodoro() {
            studyData.pomodoro.isRunning = false;
            clearInterval(studyData.pomodoro.interval);
            document.getElementById('pomodoro-start').style.display = 'inline-block';
            document.getElementById('pomodoro-pause').style.display = 'none';
            saveData();
        }

        function resetPomodoro() {
            showConfirm('Ìè¨Î™®ÎèÑÎ°ú ÌÉÄÏù¥Î®∏Î•º Î¶¨ÏÖãÌïòÏãúÍ≤†ÏäµÎãàÍπå?', () => {
                pausePomodoro();
                studyData.pomodoro.seconds = (studyData.pomodoro.workMinutes || 25) * 60; // Reset to configured work minutes
                studyData.pomodoro.mode = 'work';
                studyData.pomodoro.completedSessions = 0;
                updatePomodoroDisplay();
                document.getElementById('pomodoro-count').textContent = '0';
                document.getElementById('pomodoro-mode').textContent = 'ÏûëÏóÖ ÏÑ∏ÏÖò';
                document.getElementById('pomodoro-mode').className = 'pomodoro-mode work';
                saveData();
                showToast('Ìè¨Î™®ÎèÑÎ°ú ÌÉÄÏù¥Î®∏Í∞Ä Î¶¨ÏÖãÎêòÏóàÏäµÎãàÎã§');
            });
        }

        function updatePomodoroDisplay() {
            const minutes = Math.floor(studyData.pomodoro.seconds / 60);
            const secs = studyData.pomodoro.seconds % 60;
            document.getElementById('pomodoro-timer').textContent =
                `${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }

        function showPomodoroSettings() {
            // Populate current settings
            document.getElementById('pomodoroWorkMinutes').value = studyData.pomodoro.workMinutes || 25;
            document.getElementById('pomodoroBreakMinutes').value = studyData.pomodoro.breakMinutes || 5;
            document.getElementById('pomodoroSettingsModal').classList.add('show');
        }

        function savePomodoroSettings() {
            const workMinutes = parseInt(document.getElementById('pomodoroWorkMinutes').value);
            const breakMinutes = parseInt(document.getElementById('pomodoroBreakMinutes').value);

            if (!workMinutes || workMinutes < 1 || workMinutes > 120) {
                showToast('ÏûëÏóÖ ÏãúÍ∞ÑÏùÄ 1-120Î∂Ñ ÏÇ¨Ïù¥Î°ú ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî', 'error');
                return;
            }

            if (!breakMinutes || breakMinutes < 1 || breakMinutes > 30) {
                showToast('Ìú¥Ïãù ÏãúÍ∞ÑÏùÄ 1-30Î∂Ñ ÏÇ¨Ïù¥Î°ú ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî', 'error');
                return;
            }

            studyData.pomodoro.workMinutes = workMinutes;
            studyData.pomodoro.breakMinutes = breakMinutes;

            // Update seconds if timer is not running
            if (!studyData.pomodoro.isRunning) {
                if (studyData.pomodoro.mode === 'work') {
                    studyData.pomodoro.seconds = workMinutes * 60;
                } else {
                    studyData.pomodoro.seconds = breakMinutes * 60;
                }
                updatePomodoroDisplay();
            }

            saveData();
            closeModal('pomodoroSettingsModal');
            showToast(`Ìè¨Î™®ÎèÑÎ°ú ÌÉÄÏù¥Î®∏ ÏÑ§Ï†ïÏù¥ ÏóÖÎç∞Ïù¥Ìä∏ÎêòÏóàÏäµÎãàÎã§ (ÏûëÏóÖ: ${workMinutes}Î∂Ñ, Ìú¥Ïãù: ${breakMinutes}Î∂Ñ)`);
        }

        function playNotificationSound() {
            // Create a simple beep sound using Web Audio API
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.frequency.value = 800;
                oscillator.type = 'sine';

                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log('Audio notification not supported');
            }
        }

        // Ï£ºÍ∞Ñ ÌÜµÍ≥Ñ Î†åÎçîÎßÅ
        function renderWeeklyStats() {
            const container = document.getElementById('weekly-stats');
            container.innerHTML = '';

            const days = ['Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†', 'Ïùº'];
            const today = new Date();
            const adjustedToday = today.getDay() === 0 ? 6 : today.getDay() - 1;

            // Calculate actual study hours from studyHistory for the past 7 days
            const weeklyHoursCalculated = {};
            const startOfWeek = new Date(today);
            startOfWeek.setDate(today.getDate() - adjustedToday);

            for (let i = 0; i < 7; i++) {
                const date = new Date(startOfWeek);
                date.setDate(startOfWeek.getDate() + i);
                const dateString = date.toISOString().split('T')[0];
                const dayName = days[i];

                // Find study history for this date
                const historyEntry = studyData.studyHistory?.find(h => h.date === dateString);
                weeklyHoursCalculated[dayName] = historyEntry ? historyEntry.totalHours : 0;
            }

            days.forEach((day, idx) => {
                const hours = weeklyHoursCalculated[day] || 0;
                const isToday = idx === adjustedToday;
                const isCompleted = hours >= 4;

                const div = document.createElement('div');
                div.className = `day-stat ${isToday ? 'today' : ''} ${isCompleted ? 'completed' : ''}`;
                div.innerHTML = `
                    <div class="day-name">${day}</div>
                    <div class="day-hours">${hours.toFixed(1)}h</div>
                `;
                container.appendChild(div);
            });
        }
        
        // Note: Weekly hours are now automatically calculated from studyHistory
        // Manual editing removed as it should reflect actual completed study blocks
        
        // Í≥ºÎ™©Î≥Ñ ÏßÑÎèÑ Î†åÎçîÎßÅ
        function renderSubjectProgress() {
            const container = document.getElementById('subject-progress');
            container.innerHTML = '';

            studyData.subjects.forEach((subject, idx) => {
                const percent = Math.round((subject.completed / subject.total) * 100);
                const div = document.createElement('div');
                div.className = 'progress-item';

                // Ìó§Îçî ÏÉùÏÑ±
                const header = document.createElement('div');
                header.className = 'progress-header';
                header.innerHTML = `
                    <span class="progress-label">${subject.name}</span>
                    <span class="progress-value">${subject.completed}/${subject.total} Î¨∏Ï†ú</span>
                `;
                header.onclick = () => updateProgress(idx);

                // ÌîÑÎ°úÍ∑∏Î†àÏä§ Î∞î ÏÉùÏÑ±
                const progressBar = document.createElement('div');
                progressBar.className = 'progress-bar';
                progressBar.innerHTML = `
                    <div class="progress-fill" style="width: ${percent}%">${percent}%</div>
                `;
                progressBar.onclick = () => updateProgress(idx);

                div.appendChild(header);
                div.appendChild(progressBar);
                container.appendChild(div);
            });
        }

        // ÏßÑÎèÑ ÏóÖÎç∞Ïù¥Ìä∏ - Î™®Îã¨ ÏÇ¨Ïö©
        let editingSubjectIdx = null;

        function updateProgress(idx) {
            const subject = studyData.subjects[idx];
            editingSubjectIdx = idx;

            document.getElementById('subjectProgressModalTitle').textContent = `${subject.name} ÏßÑÎèÑ ÏàòÏ†ï`;
            document.getElementById('subjectCompleted').value = subject.completed;
            document.getElementById('subjectTotal').value = subject.total;
            document.getElementById('subjectProgressModal').classList.add('show');
        }

        function saveSubjectProgress() {
            if (editingSubjectIdx === null) return;

            const completed = parseInt(document.getElementById('subjectCompleted').value);
            const total = parseInt(document.getElementById('subjectTotal').value);

            if (!isNaN(completed) && !isNaN(total) && total >= 1) {
                const subject = studyData.subjects[editingSubjectIdx];
                subject.completed = completed;
                subject.total = Math.max(total, 1);

                // Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ ÏÜåÏä§ÏóêÎèÑ Î∞òÏòÅ
                if (studyData.examType === '2Ï∞®') {
                    studyData.subjects2nd[editingSubjectIdx] = subject;
                } else {
                    studyData.subjects1st[editingSubjectIdx] = subject;
                }

                saveData();
                renderSubjectProgress();  // Refresh the progress display
                renderAnalytics();        // Update analytics dashboard
                closeModal('subjectProgressModal');
                showToast(`${subject.name} ÏßÑÎèÑÍ∞Ä ÏóÖÎç∞Ïù¥Ìä∏ÎêòÏóàÏäµÎãàÎã§ (${subject.completed}/${subject.total})`);

                editingSubjectIdx = null;
            } else {
                showToast('Ïò¨Î∞îÎ•∏ Ïà´ÏûêÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî', 'error');
            }
        }
        
        // Ï†ÑÏ≤¥ ÏßÑÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
        function updateAllProgress() {
            showToast('Í∞Å Í≥ºÎ™©ÏùÑ ÌÅ¥Î¶≠ÌïòÏó¨ ÏßÑÎèÑÎ•º ÏóÖÎç∞Ïù¥Ìä∏ÌïòÏÑ∏Ïöî');
        }
        
        // Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàò Î†åÎçîÎßÅ
        function renderMockScores() {
            const container = document.getElementById('mock-scores');
            container.innerHTML = '';

            studyData.mockScores.forEach(score => {
                const isPass = score.score >= 60;
                const div = document.createElement('div');
                div.className = 'score-entry';

                // ÎÇ†Ïßú Î∞è Î©îÎ™® ÌëúÏãú
                const dateSpan = document.createElement('span');
                dateSpan.className = 'score-date';
                dateSpan.textContent = `${score.date} ${score.memo ? `(${score.memo})` : ''}`;

                // Ïï°ÏÖò Î≤ÑÌäº Ïª®ÌÖåÏù¥ÎÑà
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'score-actions';

                // ÏàòÏ†ï Î≤ÑÌäº
                const editBtn = document.createElement('button');
                editBtn.className = 'score-action-btn';
                editBtn.textContent = '‚úèÔ∏è';
                editBtn.onclick = () => editScore(score);

                // ÏÇ≠Ï†ú Î≤ÑÌäº
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'score-action-btn';
                deleteBtn.textContent = 'üóëÔ∏è';
                deleteBtn.onclick = () => deleteScore(score);

                actionsDiv.appendChild(editBtn);
                actionsDiv.appendChild(deleteBtn);

                // Ï†êÏàò ÌëúÏãú
                const scoreSpan = document.createElement('span');
                scoreSpan.className = `score-value ${isPass ? 'pass' : 'fail'}`;
                scoreSpan.textContent = `${score.score}Ï†ê`;

                div.appendChild(dateSpan);
                div.appendChild(actionsDiv);
                div.appendChild(scoreSpan);

                container.appendChild(div);
            });

            // Î™©Ìëú Ï†êÏàò ÌëúÏãú
            const targetDiv = document.createElement('div');
            targetDiv.className = 'score-entry';
            targetDiv.innerHTML = `
                <span class="score-date">Î™©Ìëú Ï†êÏàò</span>
                <span class="score-value pass">65.0Ï†ê‚Üë</span>
            `;
            container.appendChild(targetDiv);
        }
        
        // Ï†êÏàò Î™®Îã¨ ÌëúÏãú
        function showScoreModal() {
            editingScoreId = null;  // Ìé∏Ïßë Î™®Îìú Ï¥àÍ∏∞Ìôî
            document.getElementById('scoreDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('scoreValue').value = '';
            document.getElementById('scoreMemo').value = '';
            document.querySelector('#scoreModal .modal-title').textContent = 'Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàò Ï∂îÍ∞Ä';
            document.getElementById('scoreModal').classList.add('show');
        }
        
        // Ï†êÏàò Ï†ÄÏû•
        function saveScore() {
            const date = document.getElementById('scoreDate').value;
            const scoreValue = parseFloat(document.getElementById('scoreValue').value);
            const memo = document.getElementById('scoreMemo').value;

            if (date && !isNaN(scoreValue)) {
                if (editingScoreId) {
                    // ÏàòÏ†ï Î™®Îìú
                    const score = studyData.mockScores.find(s => s.id === editingScoreId);
                    if (score) {
                        score.date = date;
                        score.score = scoreValue;
                        score.memo = memo;
                        showToast('Ï†êÏàòÍ∞Ä ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§');
                    }
                    editingScoreId = null;
                } else {
                    // Ï∂îÍ∞Ä Î™®Îìú
                    studyData.mockScores.push({
                        id: Date.now(),
                        date,
                        score: scoreValue,
                        memo
                    });
                    showToast(`${scoreValue}Ï†êÏù¥ Í∏∞Î°ùÎêòÏóàÏäµÎãàÎã§`);
                }

                // ÎÇ†ÏßúÏàú Ï†ïÎ†¨
                studyData.mockScores.sort((a, b) => new Date(a.date) - new Date(b.date));

                saveData();
                renderMockScores();
                closeModal('scoreModal');

                // Reset form and title
                document.getElementById('scoreDate').value = new Date().toISOString().split('T')[0];
                document.getElementById('scoreValue').value = '';
                document.getElementById('scoreMemo').value = '';
                document.querySelector('#scoreModal .modal-title').textContent = 'Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàò Ï∂îÍ∞Ä';
            } else {
                showToast('ÎÇ†ÏßúÏôÄ Ï†êÏàòÎ•º Ïò¨Î∞îÎ•¥Í≤å ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî', 'error');
            }
        }
        
        // Ï†êÏàò ÏÇ≠Ï†ú
        function deleteScore(score) {
            showConfirm('Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?', () => {
                // Ï†êÏàò Í∞ùÏ≤¥Ïùò Ïù∏Îç±Ïä§Î•º Ï∞æÏïÑÏÑú ÏÇ≠Ï†ú
                const index = studyData.mockScores.indexOf(score);
                if (index > -1) {
                    studyData.mockScores.splice(index, 1);
                    console.log('‚úÖ Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàò ÏÇ≠Ï†úÎê®:', score.score);
                } else {
                    console.warn('‚ö†Ô∏è ÏÇ≠Ï†úÌï† Ï†êÏàòÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏùå');
                }
                saveData();
                renderMockScores();
                showToast('ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§');
            });
        }
        
        // Ï†êÏàò ÏàòÏ†ï - Î™®Îã¨ ÏÇ¨Ïö©
        function editScore(score) {
            if (score) {
                editingScoreId = score.id;  // ÏàòÏ†ïÌï† Ï†êÏàò ID Ï†ÄÏû•
                document.getElementById('scoreDate').value = score.date;
                document.getElementById('scoreValue').value = score.score;
                document.getElementById('scoreMemo').value = score.memo || '';
                document.querySelector('#scoreModal .modal-title').textContent = 'Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàò ÏàòÏ†ï';
                document.getElementById('scoreModal').classList.add('show');
            }
        }
        
        // Î™®Îã¨ Îã´Í∏∞
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');

            // Ìé∏Ïßë ÏÉÅÌÉú Ï¥àÍ∏∞Ìôî
            if (modalId === 'scoreModal') {
                editingScoreId = null;
            } else if (modalId === 'timeBlockModal') {
                editingBlockId = null;
            }
        }

        // ÌôïÏù∏ Î™®Îã¨ Ìó¨Ìçº (confirm ÎåÄÏ≤¥)
        function showConfirm(message, onConfirm) {
            document.getElementById('confirmMessage').textContent = message;
            document.getElementById('confirmModal').classList.add('show');

            const confirmBtn = document.getElementById('confirmOkBtn');
            const newBtn = confirmBtn.cloneNode(true);
            confirmBtn.parentNode.replaceChild(newBtn, confirmBtn);

            newBtn.onclick = () => {
                closeModal('confirmModal');
                if (onConfirm) onConfirm();
            };
        }

        // Î©îÏãúÏßÄ Î™®Îã¨ Ìó¨Ìçº (alert ÎåÄÏ≤¥ - HTML ÏßÄÏõê)
        function showModalMessage(title, htmlContent) {
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">${title}</h3>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">‚úï</button>
                    </div>
                    <div class="modal-body">
                        ${htmlContent}
                    </div>
                    <div class="modal-footer">
                        <button class="modal-btn save" onclick="this.closest('.modal').remove()">ÌôïÏù∏</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ÎÖ∏Ìä∏ Í∏∞Îä•
        function saveNotes() {
            const notes = document.getElementById('study-notes').value;
            const today = new Date().toISOString().split('T')[0];
            
            if (!studyData.notes) studyData.notes = {};
            studyData.notes[today] = {
                content: notes,
                timestamp: new Date().toISOString()
            };
            
            saveData();
            showToast('ÎÖ∏Ìä∏Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§ üìù');
        }
        
        function loadTodayNotes() {
            const today = new Date().toISOString().split('T')[0];
            if (studyData.notes && studyData.notes[today]) {
                document.getElementById('study-notes').value = studyData.notes[today].content;
            }
        }
        
        function showPreviousNotes() {
            if (!studyData.notes) {
                showToast('Ï†ÄÏû•Îêú ÎÖ∏Ìä∏Í∞Ä ÏóÜÏäµÎãàÎã§');
                return;
            }
            
            const dates = Object.keys(studyData.notes).sort().reverse();
            if (dates.length === 0) {
                showToast('Ï†ÄÏû•Îêú ÎÖ∏Ìä∏Í∞Ä ÏóÜÏäµÎãàÎã§');
                return;
            }
            
            let notesList = '<h3 style="margin-bottom:15px">üìö ÏµúÍ∑º ÌïôÏäµ ÎÖ∏Ìä∏</h3>';
            dates.slice(0, 7).forEach(date => {
                const content = studyData.notes[date].content;
                notesList += `<div style="margin-bottom:15px;padding:10px;background:#f7fafc;border-radius:6px">
                    <strong>üìÖ ${date}</strong><br>
                    ${content.substring(0, 150)}...
                </div>`;
            });

            showModalMessage('ÏµúÍ∑º ÌïôÏäµ ÎÖ∏Ìä∏', notesList);
        }
        
        function exportNotes() {
            const dataStr = JSON.stringify(studyData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `study_data_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            showToast('Îç∞Ïù¥ÌÑ∞Í∞Ä ÎÇ¥Î≥¥ÎÇ¥Ï°åÏäµÎãàÎã§ üíæ');
        }
        
        function addErrorNote() {
            document.getElementById('wrongSubject').value = '';
            document.getElementById('wrongQuestion').value = '';
            document.getElementById('wrongReason').value = '';
            document.getElementById('wrongNoteModal').classList.add('show');
        }

        function saveWrongNote() {
            const subject = document.getElementById('wrongSubject').value;
            const question = document.getElementById('wrongQuestion').value;
            const reason = document.getElementById('wrongReason').value;

            if (subject && question && reason) {
                const errorNote = `\n\n[Ïò§ÎãµÎÖ∏Ìä∏]\nÍ≥ºÎ™©: ${subject}\nÎ¨∏Ï†ú: ${question}\nÏù¥Ïú†: ${reason}\n`;
                document.getElementById('study-notes').value += errorNote;
                closeModal('wrongNoteModal');
                showToast('Ïò§ÎãµÎÖ∏Ìä∏Í∞Ä Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§');
            } else {
                showToast('Î™®Îì† Ìï≠Î™©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî', 'error');
            }
        }
        
        function clearNotes() {
            showConfirm('Ïò§Îäò ÎÖ∏Ìä∏Î•º Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?', () => {
                document.getElementById('study-notes').value = '';
                showToast('ÎÖ∏Ìä∏Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§');
            });
        }

        // Î™®Îì† Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
        function clearAllData() {
            showConfirm('Ï†ïÎßêÎ°ú Î™®Îì† ÌïôÏäµ Îç∞Ïù¥ÌÑ∞Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå? Ïù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.', () => {
                localStorage.removeItem('studyData');
                localStorage.removeItem('theme');
                sessionStorage.clear();
                showToast('Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§. ÌéòÏù¥ÏßÄÎ•º ÏÉàÎ°úÍ≥†Ïπ®Ìï©ÎãàÎã§.', 'warning');
                setTimeout(() => {
                    location.reload();
                }, 1500);
            });
        }

        // ÎèôÍ∏∞Î∂ÄÏó¨ Î¨∏Íµ¨ Î°úÌÖåÏù¥ÏÖò
        function rotateMotivation() {
            const quotes = [
                "Ìè¨Í∏∞ÌïòÏßÄ ÏïäÏúºÎ©¥ Î∞òÎìúÏãú Ìï©Í≤©ÌïúÎã§. ÏãúÌóòÏùÄ ÎÅùÍπåÏßÄ Î≤ÑÌã∞Îäî Í≤ÉÏûÖÎãàÎã§.",
                "Î®∏Î¶¨Î≥¥Îã§ Ï§ëÏöîÌïú Í≤ÉÏùÄ ÏóâÎç©Ïù¥Î•º Ïò§Îûò Î∂ôÏù¥Í≥† ÏûàÏùÑ Ïàò ÏûàÎäî Í≤É.",
                "ÏßÅÏû•Î≥ëÌñâÏù¥ÎùºÎèÑ Îß§Ïùº Íæ∏Ï§ÄÌûà ÌïòÎ©¥ Ìï©Í≤©Ìï† Ïàò ÏûàÏäµÎãàÎã§.",
                "Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàòÍ∞Ä ÎÇÆÏïÑÎèÑ Ìè¨Í∏∞ÌïòÏßÄ ÎßàÏÑ∏Ïöî. ÎÅùÍπåÏßÄ Í∞ÄÎ©¥ Îê©ÎãàÎã§.",
                "Í∏∞Ï∂úÎ¨∏Ï†úÎ•º ÏôÑÏ†ÑÌûà ÎÇ¥ Í≤ÉÏúºÎ°ú ÎßåÎìúÎäî Í≤ÉÏù¥ Ìï©Í≤©Ïùò ÏßÄÎ¶ÑÍ∏∏ÏûÖÎãàÎã§.",
                "Ïò§Îäò Î™ªÌïú Í≥µÎ∂ÄÎäî ÎÇ¥Ïùº Îëê Î∞∞Í∞Ä Îê©ÎãàÎã§. Ïò§Îäò Ìï† ÏùºÏùÄ Ïò§Îäò!",
                "1ÎÖÑ Î∞òÏùò ÎÖ∏Î†•Ïù¥ ÌèâÏÉùÏùò ÏûêÍ≤©Ï¶ùÏù¥ Îê©ÎãàÎã§.",
                "ÏãúÌóòÏùÄ Ïûò Î™®Î•¥Îäî ÏÉÅÌÉúÏóêÏÑú Î∂ôÎäî Í±∞Îã§.",
                "ÎÇ®Îì§ÎèÑ Ïñ¥Î†µÏäµÎãàÎã§. ÎÇòÎßå Ïñ¥Î†§Ïö¥ Í≤ÉÏù¥ ÏïÑÎãôÎãàÎã§.",
                "Î≤ÑÌã∞Î©¥ Ìï©Í≤©ÌïúÎã§. ÎÅùÍπåÏßÄ Î≤ÑÌã∞Îäî Í≤ÉÏûÖÎãàÎã§."
            ];
            
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            document.getElementById('motivation-quote').textContent = randomQuote;
        }
        
        // ÌÜ†Ïä§Ìä∏ Î©îÏãúÏßÄ (ÌÉÄÏûÖ ÏßÄÏõê: success, error, warning, info)
        function showToast(message, type = 'success') {
            const existing = document.querySelector('.toast');
            if (existing) existing.remove();

            const toast = document.createElement('div');
            toast.className = `toast ${type}`;

            const icons = {
                success: '‚úì',
                error: '‚úï',
                warning: '‚ö†',
                info: '‚Ñπ'
            };

            toast.innerHTML = `
                <span class="toast-icon">${icons[type] || icons.success}</span>
                <span class="toast-message">${message}</span>
            `;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideOutToast 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
        
        // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§
        document.addEventListener('keydown', function(e) {
            // ESC ÌÇ§Î°ú Î™®Îì† Î™®Îã¨ Îã´Í∏∞
            if (e.key === 'Escape') {
                const openModals = document.querySelectorAll('.modal.show');
                openModals.forEach(modal => {
                    if (modal.id) {
                        closeModal(modal.id);
                    } else {
                        modal.remove(); // ÎèôÏ†Å ÏÉùÏÑ±Îêú Î™®Îã¨
                    }
                });
                return;
            }

            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        saveNotes();
                        break;
                    case ' ':
                        e.preventDefault();
                        if (studyData.timer.isRunning) pauseTimer();
                        else startTimer();
                        break;
                }
            }
        });
        
        // ÌéòÏù¥ÏßÄ Ï¢ÖÎ£å Ïãú ÏûêÎèô Ï†ÄÏû•
        window.addEventListener('beforeunload', function() {
            saveData();
            if (document.getElementById('study-notes').value) {
                saveNotes();
            }
        });
        
        // 5Î∂ÑÎßàÎã§ ÎèôÍ∏∞Î∂ÄÏó¨ Î¨∏Íµ¨ Î≥ÄÍ≤Ω
        setInterval(rotateMotivation, 300000);

        // ===== ÏÉàÎ°úÏö¥ Í∏∞Îä•: Ïä§Ìä∏Î¶≠ Ìä∏ÎûòÏª§ =====
        function updateStreak() {
            const today = new Date().toISOString().split('T')[0];
            const lastStudy = studyData.streak.lastStudyDate;

            // Ï¥àÍ∏∞Ìôî
            if (!studyData.streak) {
                studyData.streak = { current: 0, longest: 0, lastStudyDate: null, totalDays: 0 };
            }

            // Ïò§Îäò ÌïôÏäµ Í∏∞Î°ùÏù¥ ÏûàÎäîÏßÄ ÌôïÏù∏ (ÌÉÄÏù¥Î®∏ ÏãúÍ∞Ñ or ÏôÑÎ£åÎêú ÌÉÄÏûÑÎ∏îÎ°ù from TODAY)
            const todayCompletedBlocks = studyData.timeBlocks.filter(b => b.date === today && b.completed);
            const hasStudiedToday = studyData.timer.seconds > 0 ||
                                   todayCompletedBlocks.length > 0;

            if (hasStudiedToday && lastStudy !== today) {
                if (lastStudy) {
                    const lastDate = new Date(lastStudy);
                    const todayDate = new Date(today);
                    const diffDays = Math.floor((todayDate - lastDate) / (1000 * 60 * 60 * 24));

                    if (diffDays === 1) {
                        // Ïó∞ÏÜç ÌïôÏäµ
                        studyData.streak.current++;
                    } else if (diffDays > 1) {
                        // Ïä§Ìä∏Î¶≠ ÎÅäÍπÄ
                        studyData.streak.current = 1;
                    }
                } else {
                    // Ï≤´ ÌïôÏäµ
                    studyData.streak.current = 1;
                }

                studyData.streak.lastStudyDate = today;
                studyData.streak.totalDays++;

                // ÏµúÏû• Í∏∞Î°ù Í∞±Ïã†
                if (studyData.streak.current > studyData.streak.longest) {
                    studyData.streak.longest = studyData.streak.current;
                }

                saveData();
            }

            // UI ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('current-streak').textContent = studyData.streak.current || 0;
            document.getElementById('longest-streak').textContent = studyData.streak.longest || 0;
            document.getElementById('total-study-days').textContent = studyData.streak.totalDays || 0;
        }

        function resetStreak() {
            showConfirm('Ïä§Ìä∏Î¶≠ Í∏∞Î°ùÏùÑ Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?', () => {
                studyData.streak = { current: 0, longest: 0, lastStudyDate: null, totalDays: 0 };
                saveData();
                updateStreak();
                showToast('Ïä§Ìä∏Î¶≠Ïù¥ Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§');
            });
        }

        // ===== ÏÉàÎ°úÏö¥ Í∏∞Îä•: ÌïôÏäµ Î∂ÑÏÑù ÎåÄÏãúÎ≥¥Îìú =====
                function renderAnalytics() {
            try {
                // Calculate REAL total study hours from single source of truth
                let totalHours = 0;

                // Use ONLY completed time blocks as single source of truth
                studyData.timeBlocks.forEach(block => {
                    if (block.completed) {
                        totalHours += block.hours || 0;
                    }
                });

                // Calculate actual study days from history (use correct date field, not time)
                const uniqueStudyDays = new Set();
                studyData.timeBlocks.forEach(block => {
                    if (block.completed && block.date) {
                        uniqueStudyDays.add(block.date);
                    }
                });

                if (studyData.studyHistory && studyData.studyHistory.length > 0) {
                    studyData.studyHistory.forEach(day => {
                        uniqueStudyDays.add(day.date);
                    });
                }

                const actualStudyDays = Math.max(uniqueStudyDays.size, studyData.streak.totalDays || 1, 1);
                const avgHours = totalHours / actualStudyDays;

                // Calculate overall progress from BOTH 1st and 2nd exam subjects
                let totalCompleted = 0;
                let totalProblems = 0;

                studyData.subjects.forEach(s => {
                    totalCompleted += s.completed;
                    totalProblems += s.total;
                });

                const overallProgress = totalProblems > 0 ? Math.round((totalCompleted / totalProblems) * 100) : 0;

                // Calculate mock exam average from REAL user data
                let avgScore = 0;
                if (studyData.mockScores && studyData.mockScores.length > 0) {
                    avgScore = studyData.mockScores.reduce((sum, s) => sum + s.score, 0) / studyData.mockScores.length;
                }

                // Render enhanced charts with real data
                renderSubjectTimeChart();
                renderMockScoreChart();

                // Render learning curve analysis and metacognitive feedback
                renderLearningCurveAnalysis(totalCompleted, totalProblems, totalHours, actualStudyDays);
                renderMetacognitiveFeedback(overallProgress, totalCompleted, totalProblems, totalHours, actualStudyDays);

                // Render v3.0.7+ new features
                // Achievement badges removed in v3.3.0

                console.log('‚úÖ renderAnalytics ÏôÑÎ£å');
            } catch (error) {
                console.error('‚ùå renderAnalytics ÏóêÎü¨:', error);
                console.error('Stack:', error.stack);
            }
        }

        function updateBenchmarkProgress(totalHours, avgHours, overallProgress, avgScore) {
            // Total study hours benchmark: 800-1200h (use 1000 as target)
            const totalHoursPercent = Math.min((totalHours / 1000) * 100, 100);
            const totalHoursBar = document.getElementById('total-hours-progress');
            if (totalHoursBar) {
                totalHoursBar.style.width = totalHoursPercent + '%';
                // Color coding
                if (totalHoursPercent >= 80) {
                    totalHoursBar.style.background = 'linear-gradient(90deg, var(--success-color), #34D399)';
                } else if (totalHoursPercent >= 50) {
                    totalHoursBar.style.background = 'linear-gradient(90deg, var(--accent-color), var(--success-color))';
                } else {
                    totalHoursBar.style.background = 'linear-gradient(90deg, var(--warning-color), var(--accent-color))';
                }
            }

            // Daily average benchmark: 4-5h (use 4.5 as target)
            const dailyHoursPercent = Math.min((avgHours / 4.5) * 100, 100);
            const dailyHoursBar = document.getElementById('daily-hours-progress');
            if (dailyHoursBar) {
                dailyHoursBar.style.width = dailyHoursPercent + '%';
                if (dailyHoursPercent >= 90) {
                    dailyHoursBar.style.background = 'linear-gradient(90deg, var(--success-color), #34D399)';
                } else if (dailyHoursPercent >= 60) {
                    dailyHoursBar.style.background = 'linear-gradient(90deg, var(--accent-color), var(--success-color))';
                } else {
                    dailyHoursBar.style.background = 'linear-gradient(90deg, var(--warning-color), var(--accent-color))';
                }
            }

            // Overall progress benchmark: 100%
            const progressBar = document.getElementById('progress-bar');
            if (progressBar) {
                progressBar.style.width = overallProgress + '%';
                if (overallProgress >= 90) {
                    progressBar.style.background = 'linear-gradient(90deg, var(--success-color), #34D399)';
                } else if (overallProgress >= 50) {
                    progressBar.style.background = 'linear-gradient(90deg, var(--accent-color), var(--success-color))';
                } else {
                    progressBar.style.background = 'linear-gradient(90deg, var(--warning-color), var(--accent-color))';
                }
            }

            // Mock score benchmark: 60 points (passing grade)
            const mockScorePercent = avgScore > 0 ? Math.min((avgScore / 100) * 100, 100) : 0;
            const mockScoreBar = document.getElementById('mock-score-progress');
            if (mockScoreBar) {
                mockScoreBar.style.width = mockScorePercent + '%';
                if (avgScore >= 60) {
                    mockScoreBar.style.background = 'linear-gradient(90deg, var(--success-color), #34D399)';
                } else if (avgScore >= 40) {
                    mockScoreBar.style.background = 'linear-gradient(90deg, var(--accent-color), var(--success-color))';
                } else if (avgScore > 0) {
                    mockScoreBar.style.background = 'linear-gradient(90deg, var(--danger-color), var(--warning-color))';
                }
            }
        }

        /**
         * ÌïôÏäµ Í≥°ÏÑ† Î∂ÑÏÑù Ìï®Ïàò
         * - ÌòÑÏû¨ ÌïôÏäµ ÏÜçÎèÑ Í∏∞Î∞ò ÏòàÏÉÅ ÏôÑÎ£åÏùº Í≥ÑÏÇ∞
         * - ÎÇ®ÏùÄ ÌïôÏäµÏùº Ïàò Î∞è ÌïôÏäµ ÏÜçÎèÑ ÌëúÏãú
         */
        function renderLearningCurveAnalysis(totalCompleted, totalProblems, totalHours, actualStudyDays) {
            try {
                // Check if required elements exist (they are in deleted analytics section)
                const completionDateDisplay = document.getElementById('completion-date-display');
                const daysRemainingDisplay = document.getElementById('days-remaining-display');
                const learningPaceDisplay = document.getElementById('learning-pace-display');

                // If elements don't exist, skip this function (analytics section was deleted)
                if (!completionDateDisplay || !daysRemainingDisplay || !learningPaceDisplay) {
                    return;
                }

                if (totalProblems === 0) {
                    completionDateDisplay.textContent = 'Í≥ºÎ™© ÏÑ§Ï†ï ÌïÑÏöî';
                    daysRemainingDisplay.textContent = 'ÎÇ®ÏùÄ ÌïôÏäµÏùº: - Ïùº';
                    learningPaceDisplay.textContent = 'ÌïôÏäµ ÏÜçÎèÑ: - Î¨∏Ï†ú/Ïùº';
                    return;
                }

                // ÏïàÏ†ÑÏÑ± Í≤ÄÏÇ¨: actualStudyDaysÍ∞Ä ÏóÜÍ±∞ÎÇò 0Ïù¥Î©¥ Í∏∞Î≥∏Í∞í ÏÑ§Ï†ï
                let safeDays = Math.max(actualStudyDays || 1, 1);

                // 1. ÌòÑÏû¨ ÌïôÏäµ ÏÜçÎèÑ Í≥ÑÏÇ∞ (Î¨∏Ï†ú/Ïùº)
                const completedProblems = totalCompleted || 0;
                const remainingProblems = Math.max(totalProblems - completedProblems, 0);
                const learningPace = completedProblems > 0 ? completedProblems / safeDays : 0;

                // 2. ÏòàÏÉÅ ÏôÑÎ£åÏùº Í≥ÑÏÇ∞
                let daysToCompletion = 0;
                if (learningPace > 0 && remainingProblems > 0) {
                    daysToCompletion = Math.ceil(remainingProblems / learningPace);
                } else if (remainingProblems === 0) {
                    daysToCompletion = 0; // ÏôÑÎ£åÎê®
                } else {
                    daysToCompletion = 999; // ÏïÑÏßÅ ÌïôÏäµÌïòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞
                }

                // 3. ÏòàÏÉÅ ÏôÑÎ£å ÎÇ†Ïßú Í≥ÑÏÇ∞
                const today = new Date();
                const completionDate = new Date(today.getTime() + daysToCompletion * 24 * 60 * 60 * 1000);

                // ÌïúÍµ≠ ÎÇ†Ïßú ÌòïÏãùÏúºÎ°ú Î≥ÄÌôò
                const completionDateStr = daysToCompletion === 0
                    ? 'üéâ ÏôÑÎ£å!'
                    : completionDate.toLocaleDateString('ko-KR', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });

                // ÎÇ®ÏùÄ ÏùºÏàò ÌëúÏãú (ÏïàÏ†ÑÌïòÍ≤å Ï≤òÎ¶¨)
                const daysText = daysToCompletion === 0
                    ? 'ÏôÑÎ£å!'
                    : daysToCompletion === 999
                    ? 'Í≥ÑÏÇ∞ Ï§ë'
                    : `${daysToCompletion}`;

                const paceText = learningPace > 0
                    ? `${Math.round(learningPace)}`
                    : '-';

                // 4. UI ÏóÖÎç∞Ïù¥Ìä∏
                completionDateDisplay.textContent = completionDateStr;
                daysRemainingDisplay.textContent = `ÎÇ®ÏùÄ ÌïôÏäµÏùº: ${daysText} Ïùº`;
                learningPaceDisplay.textContent = `ÌïôÏäµ ÏÜçÎèÑ: ${paceText} Î¨∏Ï†ú/Ïùº`;

                console.log(`‚úÖ ÌïôÏäµ Í≥°ÏÑ† Î∂ÑÏÑù:
                    - ÏôÑÎ£åÎêú Î¨∏Ï†ú: ${completedProblems}/${totalProblems} (${Math.round((completedProblems/totalProblems)*100)}%)
                    - ÎÇ®ÏùÄ Î¨∏Ï†ú: ${remainingProblems}
                    - ÌïôÏäµ ÏÜçÎèÑ: ${learningPace.toFixed(1)} Î¨∏Ï†ú/Ïùº
                    - ÎÇ®ÏùÄ ÏùºÏàò: ${daysToCompletion} Ïùº
                    - ÏòàÏÉÅ ÏôÑÎ£åÏùº: ${completionDateStr}`);
            } catch (error) {
                console.error('‚ùå renderLearningCurveAnalysis ÏóêÎü¨:', error);
                document.getElementById('completion-date-display').textContent = 'Í≥ÑÏÇ∞ Ïò§Î•ò';
            }
        }

        /**
         * Î©îÌÉÄÏù∏ÏßÄ ÌîºÎìúÎ∞± Ìï®Ïàò
         * - ÌòÑÏû¨ ÏßÑÌñâÎèÑÎ•º Ìï¥ÏÑùÏ†ÅÏúºÎ°ú ÏÑ§Î™Ö
         * - ÌïôÏäµ Ìö®Ïú®ÏÑ± Í∏∞Î∞ò ÎßûÏ∂§Ìòï ÌîºÎìúÎ∞± Ï†úÍ≥µ
         * - ÎèôÍ∏∞Î∂ÄÏó¨ Î©îÏãúÏßÄ ÌëúÏãú
         */
        function renderMetacognitiveFeedback(overallProgress, totalCompleted, totalProblems, totalHours, actualStudyDays) {
            try {
                // Check if required elements exist (they are in deleted analytics section)
                const feedbackElement = document.getElementById('metacognitive-feedback');
                const motivationElement = document.getElementById('motivation-message');

                // If elements don't exist, skip this function (analytics section was deleted)
                if (!feedbackElement || !motivationElement) {
                    return;
                }

                if (totalProblems === 0) {
                    feedbackElement.textContent = 'Í≥ºÎ™©ÏùÑ Ï∂îÍ∞ÄÌïòÏó¨ ÌïôÏäµÏùÑ ÏãúÏûëÌïòÏÑ∏Ïöî!';
                    motivationElement.textContent = 'üöÄ ÏÉàÎ°úÏö¥ Ïó¨Ï†ïÏùÑ ÏãúÏûëÌï¥Î¥ÖÏãúÎã§!';
                    return;
                }

                // 1. Ìö®Ïú®ÏÑ± ÏßÄÏàò Í≥ÑÏÇ∞ (ÌïôÏäµÎüâ ÎåÄÎπÑ ÏÑ±Í≥º)
                const completionRate = (totalCompleted / totalProblems) * 100;
                const hoursPerProblem = totalHours > 0 ? totalHours / totalCompleted : 0;
                const problemsPerDay = totalCompleted > 0 ? totalCompleted / actualStudyDays : 0;

                // 2. ÌïôÏäµ ÏßÑÌñâÎèÑ ÌèâÍ∞Ä
                let progressMessage = '';
                let motivationEmoji = '';
                let motivationMessage = '';

                if (overallProgress >= 90) {
                    progressMessage = `üåü ÎÜÄÎùºÏö¥ ÏßÑÌñâÏù¥ÏóêÏöî! Ïù¥ÎØ∏ ${overallProgress}%Î•º ÏôÑÎ£åÌñàÏäµÎãàÎã§! ÎßàÏßÄÎßâ Ïä§ÌçºÌä∏Î•º Ïù¥Í≤®ÎÇº Ï§ÄÎπÑÍ∞Ä ÎêòÏÖ®ÎÇòÏöî?`;
                    motivationEmoji = 'üèÜ';
                    motivationMessage = 'Í±∞Ïùò Îã§ ÏôîÏñ¥Ïöî! Ïù¥ÎåÄÎ°úÎßå Í≥ÑÏÜçÌïòÎ©¥ ÌôïÏã§Ìûà ÏÑ±Í≥µÌï† Ïàò ÏûàÏäµÎãàÎã§!';
                } else if (overallProgress >= 70) {
                    progressMessage = `üëè Ï†ïÎßê ÏûòÌïòÍ≥† Í≥ÑÏÑ∏Ïöî! ${overallProgress}%ÍπåÏßÄ Ïò§ÏÖ®ÏäµÎãàÎã§. Ïù¥ ÏÜçÎèÑÎ©¥ Ï∂©Î∂ÑÌûà ÏôÑÏÑ±Ìï† Ïàò ÏûàÏñ¥Ïöî.`;
                    motivationEmoji = 'üí™';
                    motivationMessage = 'Ïó≠Ïãú Ïã§Î†•Ïù¥ ÎäêÍª¥Ï†∏Ïöî! Ï°∞Í∏àÎßå Îçî ÌûòÎÇ¥ÏÑ∏Ïöî.';
                } else if (overallProgress >= 50) {
                    progressMessage = `‚ú® Ï§ëÍ∞Ñ ÏßÄÏ†êÏùÑ ÎÑòÏúºÏÖ®Ïñ¥Ïöî! ÌòÑÏû¨ ${overallProgress}% ÏôÑÎ£å. ÏßÄÍ∏àÍπåÏßÄÏùò ÎÖ∏Î†•Ïù¥ Ï†ïÎßê ÌõåÎ•≠Ìï©ÎãàÎã§!`;
                    motivationEmoji = '‚ö°';
                    motivationMessage = 'Ï¢ãÏùÄ ÌéòÏù¥Ïä§Î•º Ïú†ÏßÄÌïòÍ≥† ÏûàÏñ¥Ïöî. Í≥ÑÏÜç ÌôîÏù¥ÌåÖÌïòÏÑ∏Ïöî!';
                } else if (overallProgress >= 30) {
                    progressMessage = `üìà Ï¢ãÏùÄ ÏßÑÌñâ Ï§ëÏûÖÎãàÎã§! ${overallProgress}%Î•º Îã¨ÏÑ±ÌñàÏñ¥Ïöî. Ïù¥ÎåÄÎ°ú Í≥ÑÏÜçÌïòÎ©¥ Î™©ÌëúÏóê ÎèÑÎã¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.`;
                    motivationEmoji = 'üéØ';
                    motivationMessage = 'Í∏∞Ï¥àÎ•º ÌÉÑÌÉÑÌûà Îã§ÏßÄÎäî Ï§ëÏù¥Íµ∞Ïöî. Í≥ÑÏÜç ÏßÑÌñâÌïòÏÑ∏Ïöî!';
                } else {
                    progressMessage = `üå± ÏãúÏûëÏù¥ Î∞òÏù¥ÎùºÍ≥† ÌñàÏûñÏïÑÏöî! ${overallProgress}%Î•º ÏôÑÎ£åÌñàÏäµÎãàÎã§. Ïù¥ Î∞úÍ±∏ÏùåÏù¥ Í∞ÄÏû• ÏÜåÏ§ëÌïú ÏàúÍ∞ÑÏûÖÎãàÎã§.`;
                    motivationEmoji = 'üî•';
                    motivationMessage = 'ÏßÄÍ∏àÏù¥ Í∞ÄÏû• Ï§ëÏöîÌïú ÏàúÍ∞ÑÏûÖÎãàÎã§. Í≥ÑÏÜç ÏßÑÌñâÌïòÏÑ∏Ïöî!';
                }

                // 3. ÌïôÏäµ Ìö®Ïú®ÏÑ± ÌîºÎìúÎ∞±
                let efficiencyFeedback = '';
                if (hoursPerProblem > 0) {
                    if (hoursPerProblem < 0.3) {
                        efficiencyFeedback = ` Ìö®Ïú®ÏÑ±Ïù¥ Ïö∞ÏàòÌï¥Ïöî! (ÌèâÍ∑† ${hoursPerProblem.toFixed(2)}ÏãúÍ∞Ñ/Î¨∏Ï†ú)`;
                    } else if (hoursPerProblem < 0.5) {
                        efficiencyFeedback = ` ÌïôÏäµ ÏÜçÎèÑÍ∞Ä Ï¢ãÏäµÎãàÎã§! (ÌèâÍ∑† ${hoursPerProblem.toFixed(2)}ÏãúÍ∞Ñ/Î¨∏Ï†ú)`;
                    } else {
                        efficiencyFeedback = ` ÍπäÏù¥ ÏûàÎäî ÌïôÏäµÏùÑ ÌïòÍ≥† Í≥ÑÏÑ∏Ïöî. (ÌèâÍ∑† ${hoursPerProblem.toFixed(2)}ÏãúÍ∞Ñ/Î¨∏Ï†ú)`;
                    }
                }

                // 4. ÌïôÏäµ ÏùºÏàò Í∏∞Î∞ò ÌîºÎìúÎ∞±
                const consistencyFeedback = actualStudyDays >= 7
                    ? ` Íæ∏Ï§ÄÌûà ${actualStudyDays}Ïùº ÎèôÏïà ÌïôÏäµ Ï§ëÏù¥ÏóêÏöî!`
                    : ` ÏãúÏûëÌïú ÏßÄ ${actualStudyDays}ÏùºÏûÖÎãàÎã§. Íæ∏Ï§ÄÌï®Ïù¥ Í∞ÄÏû• Ï§ëÏöîÌï¥Ïöî!`;

                // 5. ÏµúÏ¢Ö ÌîºÎìúÎ∞± Î©îÏãúÏßÄ
                const finalFeedback = progressMessage + efficiencyFeedback + consistencyFeedback;

                // 6. ÎèôÍ∏∞Î∂ÄÏó¨ Î©îÏãúÏßÄ
                const motivationText = `${motivationEmoji} ${motivationMessage}`;

                // 7. UI ÏóÖÎç∞Ïù¥Ìä∏
                feedbackElement.textContent = finalFeedback;
                motivationElement.textContent = motivationText;

                console.log(`‚úÖ Î©îÌÉÄÏù∏ÏßÄ ÌîºÎìúÎ∞± ÏÉùÏÑ±:
                    - ÏßÑÌñâÎèÑ: ${overallProgress}%
                    - Ìö®Ïú®ÏÑ±: ${hoursPerProblem.toFixed(2)}ÏãúÍ∞Ñ/Î¨∏Ï†ú
                    - ÌïôÏäµÏùºÏàò: ${actualStudyDays}Ïùº
                    - ÏùºÏùºÏÜçÎèÑ: ${problemsPerDay.toFixed(1)}Î¨∏Ï†ú/Ïùº`);
            } catch (error) {
                console.error('‚ùå renderMetacognitiveFeedback ÏóêÎü¨:', error);
                if (feedbackElement) {
                    feedbackElement.textContent = 'ÌîºÎìúÎ∞±ÏùÑ ÏÉùÏÑ±Ìï† Ïàò ÏóÜÏäµÎãàÎã§.';
                }
            }
        }

        /**
         * ÎåÄÏãúÎ≥¥Îìú Î∂ÑÏÑù: Ìö®Ïú®ÏÑ± ÏßÄÏàò & Ï£ºÍ∞Ñ ÌïôÏäµÏùº
         */
        function renderDashboardAnalytics(totalHours, overallProgress, actualStudyDays) {
            try {
                // 1. ÌïôÏäµ Ìö®Ïú®ÏÑ± ÏßÄÏàò (0-100)
                const hoursTarget = 1000; // Î™©Ìëú ÏãúÍ∞Ñ
                const progressTarget = 100; // Î™©Ìëú ÏßÑÎèÑ
                const efficiencyScore = Math.round(((totalHours / hoursTarget) * 60 + (overallProgress / progressTarget) * 40));

                const efficiencyElement = document.getElementById('efficiency-score');
                if (efficiencyElement) {
                    efficiencyElement.textContent = Math.min(efficiencyScore, 100);
                    const effBar = document.getElementById('efficiency-progress');
                    if (effBar) {
                        effBar.style.width = Math.min(efficiencyScore, 100) + '%';
                        if (efficiencyScore >= 80) {
                            effBar.style.background = 'linear-gradient(90deg, var(--success-color), #34D399)';
                        } else if (efficiencyScore >= 50) {
                            effBar.style.background = 'linear-gradient(90deg, var(--accent-color), var(--success-color))';
                        } else {
                            effBar.style.background = 'linear-gradient(90deg, var(--warning-color), var(--accent-color))';
                        }
                    }
                }

                // 2. Ï£ºÍ∞Ñ ÌïôÏäµÏùº Í≥ÑÏÇ∞
                const today = new Date();
                const weekStart = new Date(today.setDate(today.getDate() - today.getDay()));
                let weeklyStudyDays = 0;

                studyData.timeBlocks.forEach(block => {
                    if (block.completed && block.date) {
                        const blockDate = new Date(block.date);
                        if (blockDate >= weekStart) {
                            weeklyStudyDays = Math.max(weeklyStudyDays, blockDate.getDay() + 1);
                        }
                    }
                });

                const weeklyElement = document.getElementById('weekly-study-days');
                if (weeklyElement) {
                    weeklyElement.textContent = Math.min(weeklyStudyDays, 7);
                    const weekBar = document.getElementById('weekly-days-progress');
                    if (weekBar) {
                        weekBar.style.width = Math.min((weeklyStudyDays / 7) * 100, 100) + '%';
                        if (weeklyStudyDays >= 7) {
                            weekBar.style.background = 'linear-gradient(90deg, var(--success-color), #34D399)';
                        } else if (weeklyStudyDays >= 4) {
                            weekBar.style.background = 'linear-gradient(90deg, var(--accent-color), var(--success-color))';
                        } else {
                            weekBar.style.background = 'linear-gradient(90deg, var(--warning-color), var(--accent-color))';
                        }
                    }
                }
            } catch (error) {
                console.error('‚ùå renderDashboardAnalytics ÏóêÎü¨:', error);
            }
        }

        /**
         * Ï∑®ÏïΩ Í≥ºÎ™© Î∂ÑÏÑù (ÏßÑÎèÑÏú® 50% ÎØ∏Îßå)
         */
        function renderWeakSubjectsAnalysis() {
            try {
                const weakSubjects = studyData.subjects.filter(s => {
                    const progress = (s.completed / s.total) * 100;
                    return progress < 50;
                }).sort((a, b) => {
                    const progressA = (a.completed / a.total) * 100;
                    const progressB = (b.completed / b.total) * 100;
                    return progressA - progressB;
                });

                const countElement = document.getElementById('weak-subjects-count');
                const listElement = document.getElementById('weak-subjects-list');

                if (countElement) {
                    countElement.textContent = weakSubjects.length;
                }

                if (listElement) {
                    if (weakSubjects.length === 0) {
                        listElement.textContent = 'üéâ Î™®Îì† Í≥ºÎ™©Ïùò ÏßÑÎèÑÍ∞Ä 50% Ïù¥ÏÉÅÏûÖÎãàÎã§!';
                        listElement.style.color = 'var(--success-color)';
                    } else {
                        const subjectList = weakSubjects.map(s => {
                            const progress = Math.round((s.completed / s.total) * 100);
                            return `${s.name} (${progress}%)`;
                        }).join(', ');
                        listElement.textContent = subjectList;
                    }
                }
            } catch (error) {
                console.error('‚ùå renderWeakSubjectsAnalysis ÏóêÎü¨:', error);
            }
        }

        /**
         * Í∞ïÏ†ê Í≥ºÎ™© Î∂ÑÏÑù (ÏßÑÎèÑÏú® 80% Ïù¥ÏÉÅ)
         */
        function renderStrongSubjectsAnalysis() {
            try {
                const strongSubjects = studyData.subjects.filter(s => {
                    const progress = (s.completed / s.total) * 100;
                    return progress >= 80;
                }).sort((a, b) => {
                    const progressA = (a.completed / a.total) * 100;
                    const progressB = (b.completed / b.total) * 100;
                    return progressB - progressA;
                });

                const countElement = document.getElementById('strong-subjects-count');
                const listElement = document.getElementById('strong-subjects-list');

                if (countElement) {
                    countElement.textContent = strongSubjects.length;
                }

                if (listElement) {
                    if (strongSubjects.length === 0) {
                        listElement.textContent = 'üí™ Í≥ß 80% Ïù¥ÏÉÅ ÎèÑÎã¨Ìï† Ïàò ÏûàÏäµÎãàÎã§!';
                        listElement.style.color = 'var(--text-secondary)';
                    } else {
                        const subjectList = strongSubjects.map(s => {
                            const progress = Math.round((s.completed / s.total) * 100);
                            return `${s.name} (${progress}%)`;
                        }).join(', ');
                        listElement.textContent = subjectList;
                    }
                }
            } catch (error) {
                console.error('‚ùå renderStrongSubjectsAnalysis ÏóêÎü¨:', error);
            }
        }

        /**
         * v3.0.7 - ÌïµÏã¨ Î©îÌä∏Î¶≠ Î†åÎçîÎßÅ
         * ÎåÄÏãúÎ≥¥Îìú ÏÉÅÎã®Ïóê 3Í∞ú ÌïµÏã¨ ÏßÄÌëúÎßå ÌëúÏãú
         */
        function renderCoreMetrics(overallProgress, totalCompleted, totalProblems, totalHours, actualStudyDays) {
            try {
                // 1. Ï†ÑÏ≤¥ ÏßÑÎèÑÏú®
                const coreProgressEl = document.getElementById('core-progress');
                const coreProgressFill = document.getElementById('core-progress-fill');
                if (coreProgressEl && coreProgressFill) {
                    coreProgressEl.textContent = overallProgress + '%';
                    coreProgressFill.style.width = overallProgress + '%';
                }

                // 2. ÏòàÏÉÅ ÏôÑÎ£åÏùº & D-day
                const safeDays = Math.max(actualStudyDays || 1, 1);
                const completedProblems = totalCompleted || 0;
                const remainingProblems = Math.max(totalProblems - completedProblems, 0);
                const learningPace = completedProblems > 0 ? completedProblems / safeDays : 0;

                let daysToCompletion = 0;
                if (learningPace > 0 && remainingProblems > 0) {
                    daysToCompletion = Math.ceil(remainingProblems / learningPace);
                } else if (remainingProblems === 0) {
                    daysToCompletion = 0;
                } else {
                    daysToCompletion = 999;
                }

                const today = new Date();
                const completionDate = new Date(today.getTime() + daysToCompletion * 24 * 60 * 60 * 1000);

                const coreDateEl = document.getElementById('core-completion-date');
                const coreDdayEl = document.getElementById('core-dday');
                if (coreDateEl && coreDdayEl) {
                    if (daysToCompletion === 0) {
                        coreDateEl.textContent = 'ÏôÑÎ£å!';
                        coreDdayEl.textContent = 'Ï∂ïÌïòÌï©ÎãàÎã§! üéâ';
                    } else if (daysToCompletion === 999) {
                        coreDateEl.textContent = 'Í≥ÑÏÇ∞ Ï§ë...';
                        coreDdayEl.textContent = 'ÌïôÏäµ Îç∞Ïù¥ÌÑ∞ Î∂ÄÏ°±';
                    } else {
                        const dateStr = completionDate.toLocaleDateString('ko-KR', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric'
                        });
                        coreDateEl.textContent = dateStr;
                        coreDdayEl.textContent = `D-${daysToCompletion}`;
                    }
                }

                // 3. ÌïôÏäµ Ìö®Ïú®ÏÑ± ÏßÄÏàò
                const hoursTarget = 1000;
                const progressTarget = 100;
                const efficiencyScore = Math.round(((totalHours / hoursTarget) * 60 + (overallProgress / progressTarget) * 40));

                const coreEffEl = document.getElementById('core-efficiency');
                if (coreEffEl) {
                    coreEffEl.textContent = Math.min(efficiencyScore, 100);
                }

                console.log('‚úÖ ÌïµÏã¨ Î©îÌä∏Î¶≠ Î†åÎçîÎßÅ ÏôÑÎ£å:', {
                    progress: overallProgress,
                    daysToCompletion,
                    efficiency: efficiencyScore
                });
            } catch (error) {
                console.error('‚ùå renderCoreMetrics ÏóêÎü¨:', error);
            }
        }

        /**
         * v3.0.7 - Ïò§ÎäòÏùò ÌïôÏäµ Î™©Ìëú (AI Ï∂îÏ≤ú)
         * ÏßÑÎèÑÏú® Í∏∞Î∞òÏúºÎ°ú Ïö∞ÏÑ†ÏàúÏúÑ Í≥ºÎ™© 3Í∞ú Ï∂îÏ≤ú
         */
        function renderTodayGoals() {
            try {
                const goalsContainer = document.getElementById('today-goals');
                if (!goalsContainer) return;

                // Calculate progress for all subjects
                const subjectsWithProgress = studyData.subjects.map(s => ({
                    ...s,
                    progress: s.total > 0 ? Math.round((s.completed / s.total) * 100) : 0,
                    remaining: s.total - s.completed
                })).filter(s => s.total > 0);

                // Categorize subjects
                const weakSubjects = subjectsWithProgress.filter(s => s.progress < 50).sort((a, b) => a.progress - b.progress);
                const midSubjects = subjectsWithProgress.filter(s => s.progress >= 50 && s.progress < 70).sort((a, b) => a.progress - b.progress);
                const strongSubjects = subjectsWithProgress.filter(s => s.progress >= 70).sort((a, b) => b.progress - a.progress);

                const recommendations = [];

                // Recommendation 1: Weak subject (highest priority)
                if (weakSubjects.length > 0) {
                    const subject = weakSubjects[0];
                    const targetProgress = Math.min(subject.progress + 5, 50);
                    const problemsNeeded = Math.ceil((targetProgress - subject.progress) * subject.total / 100);
                    recommendations.push({
                        priority: 1,
                        subject: subject.name,
                        progress: subject.progress,
                        targetProgress: targetProgress,
                        action: `Í∏∞Ï∂úÎ¨∏Ï†ú ${problemsNeeded}Î¨∏Ï†ú ÌíÄÏù¥`,
                        reason: 'Ï∑®ÏïΩ Í≥ºÎ™© ÏßëÏ§ë Î≥¥ÏôÑ',
                        icon: 'üéØ',
                        color: '#FF6B6B'
                    });
                } else if (midSubjects.length > 0) {
                    const subject = midSubjects[0];
                    const targetProgress = Math.min(subject.progress + 5, 70);
                    const problemsNeeded = Math.ceil((targetProgress - subject.progress) * subject.total / 100);
                    recommendations.push({
                        priority: 1,
                        subject: subject.name,
                        progress: subject.progress,
                        targetProgress: targetProgress,
                        action: `Ïã¨Ìôî Î¨∏Ï†ú ${problemsNeeded}Î¨∏Ï†ú`,
                        reason: 'Ï§ëÍ∞Ñ Í≥ºÎ™© Í∞ïÌôî',
                        icon: 'üìö',
                        color: '#4ECDC4'
                    });
                }

                // Recommendation 2: Mid-level subject
                if (midSubjects.length > 0) {
                    const subject = midSubjects[0];
                    const targetProgress = Math.min(subject.progress + 5, 70);
                    const problemsNeeded = Math.ceil((targetProgress - subject.progress) * subject.total / 100);
                    recommendations.push({
                        priority: 2,
                        subject: subject.name,
                        progress: subject.progress,
                        targetProgress: targetProgress,
                        action: `Í∞úÎÖê Î≥µÏäµ 30Î∂Ñ`,
                        reason: 'Ï§ëÍ∏â Îã®Í≥Ñ ÏïàÏ†ïÌôî',
                        icon: 'üìñ',
                        color: '#95E1D3'
                    });
                } else if (weakSubjects.length > 1) {
                    const subject = weakSubjects[1];
                    const targetProgress = Math.min(subject.progress + 5, 50);
                    const problemsNeeded = Math.ceil((targetProgress - subject.progress) * subject.total / 100);
                    recommendations.push({
                        priority: 2,
                        subject: subject.name,
                        progress: subject.progress,
                        targetProgress: targetProgress,
                        action: `Í∏∞Î≥∏ Í∞úÎÖê Ï†ïÎ¶¨`,
                        reason: 'Îëê Î≤àÏß∏ Ï∑®ÏïΩ Í≥ºÎ™©',
                        icon: 'üìù',
                        color: '#FFE66D'
                    });
                }

                // Recommendation 3: Strong subject
                if (strongSubjects.length > 0) {
                    const subject = strongSubjects[0];
                    const targetProgress = Math.min(subject.progress + 3, 100);
                    recommendations.push({
                        priority: 3,
                        subject: subject.name,
                        progress: subject.progress,
                        targetProgress: targetProgress,
                        action: `Î™®ÏùòÍ≥†ÏÇ¨ Í≤ÄÌÜ† 1ÏãúÍ∞Ñ`,
                        reason: 'Í∞ïÏ†ê Ïú†ÏßÄ Î∞è ÏôÑÏÑ±',
                        icon: '‚≠ê',
                        color: '#A8E6CF'
                    });
                } else if (midSubjects.length > 1) {
                    const subject = midSubjects[1];
                    recommendations.push({
                        priority: 3,
                        subject: subject.name,
                        progress: subject.progress,
                        targetProgress: Math.min(subject.progress + 5, 70),
                        action: `ÏùëÏö© Î¨∏Ï†ú ÌíÄÏù¥`,
                        reason: 'Ï∂îÍ∞Ä Í∞ïÌôî Í≥ºÎ™©',
                        icon: 'üí™',
                        color: '#FFD3B6'
                    });
                }

                // Render recommendations
                if (recommendations.length > 0) {
                    goalsContainer.innerHTML = `
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 24px; border-radius: var(--radius-lg); color: white;">
                            <div style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 20px;">
                                AIÍ∞Ä ÎãπÏã†Ïùò ÌïôÏäµ Îç∞Ïù¥ÌÑ∞Î•º Î∂ÑÏÑùÌïòÏó¨ Ïò§Îäò ÏßëÏ§ëÌï¥Ïïº Ìï† Í≥ºÎ™©ÏùÑ Ï∂îÏ≤úÌï©ÎãàÎã§.
                            </div>
                            ${recommendations.map((rec, idx) => `
                                <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 20px; border-radius: var(--radius-md); margin-bottom: ${idx < recommendations.length - 1 ? '16px' : '0'}; border: 1px solid rgba(255,255,255,0.2);">
                                    <div style="display: flex; align-items: center; gap: 16px;">
                                        <div style="font-size: 2.5rem;">${rec.icon}</div>
                                        <div style="flex: 1;">
                                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                                <div style="font-size: 1.1rem; font-weight: 700;">${rec.priority}. ${rec.subject}</div>
                                                <div style="background: rgba(255,255,255,0.3); padding: 4px 12px; border-radius: 12px; font-size: 0.85rem; font-weight: 600;">
                                                    ÏßÑÎèÑ: ${rec.progress}% ‚Üí ${rec.targetProgress}%
                                                </div>
                                            </div>
                                            <div style="font-size: 0.95rem; margin-bottom: 6px; opacity: 0.95;">
                                                ‚Üí ${rec.action}
                                            </div>
                                            <div style="font-size: 0.85rem; opacity: 0.8;">
                                                Ïù¥Ïú†: ${rec.reason}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else {
                    goalsContainer.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            <div style="font-size: 3rem; margin-bottom: 16px;">üéØ</div>
                            <div style="font-size: 1.1rem; margin-bottom: 8px;">Í≥ºÎ™©ÏùÑ Ï∂îÍ∞ÄÌïòÎ©¥ AIÍ∞Ä ÌïôÏäµ Î™©ÌëúÎ•º Ï∂îÏ≤úÌï©ÎãàÎã§</div>
                            <div style="font-size: 0.9rem;">Í≥ºÎ™© ÏÑ§Ï†ïÏóêÏÑú Í≥ºÎ™©ÏùÑ Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî</div>
                        </div>
                    `;
                }

                console.log('‚úÖ Ïò§ÎäòÏùò ÌïôÏäµ Î™©Ìëú Î†åÎçîÎßÅ ÏôÑÎ£å:', recommendations.length + 'Í∞ú Ï∂îÏ≤ú');
            } catch (error) {
                console.error('‚ùå renderTodayGoals ÏóêÎü¨:', error);
            }
        }


        function renderSubjectTimeChart() {
            const container = document.getElementById('subject-time-chart');
            if (!container) {
                return;
            }
            container.innerHTML = '';

            // Calculate REAL time spent per subject
            const subjectTime = {};

            // Initialize with 0 for all subjects
            studyData.subjects.forEach(subject => {
                subjectTime[subject.name] = 0;
            });

            // 1. Add time from completed time blocks
            studyData.timeBlocks.forEach(block => {
                if (block.completed && block.subject && block.hours) {
                    if (!subjectTime[block.subject]) {
                        subjectTime[block.subject] = 0;
                    }
                    subjectTime[block.subject] += block.hours;
                }
            });

            // 2. Add estimated time from timer (distribute evenly if multiple subjects active)
            const timerHours = studyData.timer.seconds / 3600;
            const activeSubjects = studyData.subjects.filter(s => {
                const progress = (s.completed / s.total) * 100;
                return progress > 0 && progress < 100;
            });

            if (activeSubjects.length > 0 && timerHours > 0) {
                const hoursPerSubject = timerHours / activeSubjects.length;
                activeSubjects.forEach(subject => {
                    if (!subjectTime[subject.name]) {
                        subjectTime[subject.name] = 0;
                    }
                    subjectTime[subject.name] += hoursPerSubject;
                });
            }

            // 3. Add estimated time from progress (rough estimate: 0.5h per 10 problems completed)
            studyData.subjects.forEach(subject => {
                if (subject.completed > 0 && subjectTime[subject.name] === 0) {
                    // Estimate based on completed problems
                    subjectTime[subject.name] = (subject.completed / 10) * 0.5;
                }
            });

            // Sort by time spent (descending)
            const sortedSubjects = Object.entries(subjectTime)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 8); // Show top 8

            if (sortedSubjects.length === 0 || sortedSubjects.every(([_, time]) => time === 0)) {
                container.innerHTML = '<div style="text-align: center; color: var(--text-secondary); padding: 40px;">ÌïôÏäµ Îç∞Ïù¥ÌÑ∞Î•º Ï∂îÍ∞ÄÌïòÎ©¥ Í≥ºÎ™©Î≥Ñ ÏãúÍ∞ÑÏù¥ ÌëúÏãúÎê©ÎãàÎã§</div>';
                return;
            }

            const maxTime = Math.max(...sortedSubjects.map(([_, time]) => time), 1);

            sortedSubjects.forEach(([subjectName, timeSpent]) => {
                const hours = Math.round(timeSpent * 10) / 10; // Round to 1 decimal
                const height = (timeSpent / maxTime) * 100;

                const barItem = document.createElement('div');
                barItem.className = 'bar-item';

                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = height + '%';
                bar.style.background = 'linear-gradient(to top, var(--accent-color), var(--success-color))';

                const barValue = document.createElement('div');
                barValue.className = 'bar-value';
                barValue.textContent = hours + 'h';

                bar.appendChild(barValue);

                const label = document.createElement('div');
                label.className = 'bar-label';
                label.textContent = subjectName.replace(' (2Ï∞®)', '').substring(0, 8);

                barItem.appendChild(bar);
                barItem.appendChild(label);
                container.appendChild(barItem);
            });
        }

        
        function renderMockScoreChart() {
            const container = document.getElementById('mock-score-chart');
            if (!container) {
                return;
            }
            container.innerHTML = '';

            if (!studyData.mockScores || studyData.mockScores.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: var(--text-secondary); padding: 40px;">Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàòÎ•º Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî</div>';
                return;
            }

            // Show most recent scores (up to 10)
            const recentScores = studyData.mockScores.slice(-10);
            const maxScore = 100;

            recentScores.forEach((score, idx) => {
                const height = (score.score / maxScore) * 100;

                const barItem = document.createElement('div');
                barItem.className = 'bar-item';

                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = height + '%';

                // Color based on pass/fail (60% passing grade)
                if (score.score >= 60) {
                    bar.style.background = 'linear-gradient(to top, var(--success-color), #34D399)';
                } else {
                    bar.style.background = 'linear-gradient(to top, var(--danger-color), #F87171)';
                }

                // Add transition for animation
                bar.style.transition = 'height 0.5s ease ' + (idx * 0.05) + 's';

                const barValue = document.createElement('div');
                barValue.className = 'bar-value';
                barValue.textContent = score.score;

                bar.appendChild(barValue);

                const label = document.createElement('div');
                label.className = 'bar-label';
                // Show date in MM/DD format
                const dateStr = score.date.substring(5); // Remove year
                label.textContent = dateStr;

                barItem.appendChild(bar);
                barItem.appendChild(label);
                container.appendChild(barItem);
            });
        }

        // ===== ÏÉàÎ°úÏö¥ Í∏∞Îä•: ÏïΩÏ†ê Í≥ºÎ™© ÏãùÎ≥Ñ =====
                function renderWeakSubjects() {
            const container = document.getElementById('weak-subjects-container');
            container.innerHTML = '';

            // Identify weak subjects based on REAL criteria
            const weakSubjects = [];

            studyData.subjects.forEach(subject => {
                const progress = (subject.completed / subject.total) * 100;
                const rotations = subject.rotations.filter(r => r).length;

                // Find recent mock exam performance for this subject (if available)
                let recentMockPerformance = null;
                const subjectBase = subject.name.replace(' (2Ï∞®)', '');
                const relevantScores = studyData.mockScores.filter(s =>
                    s.subject && s.subject.includes(subjectBase)
                ).slice(-3);

                if (relevantScores.length > 0) {
                    const avgMockScore = relevantScores.reduce((sum, s) => sum + s.score, 0) / relevantScores.length;
                    recentMockPerformance = avgMockScore;
                }

                // Priority calculation
                let priority = 0;
                let reasons = [];

                if (progress < 30) {
                    priority += 10;
                    reasons.push('ÏßÑÎèÑÏú® Îß§Ïö∞ ÎÇÆÏùå');
                } else if (progress < 50) {
                    priority += 7;
                    reasons.push('ÏßÑÎèÑÏú® ÎÇÆÏùå');
                }

                if (rotations < 1) {
                    priority += 8;
                    reasons.push('ÌöåÎèÖ ÏóÜÏùå');
                } else if (rotations < 2) {
                    priority += 5;
                    reasons.push('ÌöåÎèÖ Î∂ÄÏ°±');
                }

                if (recentMockPerformance !== null && recentMockPerformance < 60) {
                    priority += 6;
                    reasons.push(`Î™®ÏùòÍ≥†ÏÇ¨ ${recentMockPerformance.toFixed(0)}Ï†ê`);
                }

                if (priority > 5) {
                    weakSubjects.push({
                        subject,
                        progress,
                        rotations,
                        priority,
                        reasons,
                        mockScore: recentMockPerformance
                    });
                }
            });

            // Sort by priority (highest first)
            weakSubjects.sort((a, b) => b.priority - a.priority);

            if (weakSubjects.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--success-color); font-weight: 500;">Î™®Îì† Í≥ºÎ™©Ïù¥ ÏàúÏ°∞Î°≠Í≤å ÏßÑÌñâ Ï§ëÏûÖÎãàÎã§! üëç</div>';
                return;
            }

            // Show top 5 weak subjects
            weakSubjects.slice(0, 5).forEach((item, idx) => {
                const { subject, progress, rotations, priority, reasons, mockScore } = item;

                const div = document.createElement('div');
                div.className = 'weak-subject';

                let badgeText, badgeColor;
                if (priority >= 15) {
                    badgeText = 'ÏµúÏö∞ÏÑ†';
                    badgeColor = 'var(--danger-color)';
                } else if (priority >= 10) {
                    badgeText = 'Ïö∞ÏÑ†';
                    badgeColor = 'var(--warning-color)';
                } else {
                    badgeText = 'Ï£ºÏùò';
                    badgeColor = '#FBBF24';
                }

                const recommendation = getSubjectRecommendation(subject, progress, rotations, mockScore);

                div.innerHTML = `
                    <div class="weak-subject-header">
                        <div class="weak-subject-name">${subject.name}</div>
                        <div class="priority-badge" style="background: ${badgeColor}">${badgeText}</div>
                    </div>
                    <div class="weak-subject-info">
                        ÏßÑÎèÑÏú®: ${Math.round(progress)}% | ÌöåÎèÖ: ${rotations}Ìöå
                        ${mockScore !== null ? ` | ÏµúÍ∑º Î™®ÏùòÍ≥†ÏÇ¨: ${mockScore.toFixed(0)}Ï†ê` : ''}
                    </div>
                    <div class="recommendation">
                        ${recommendation}
                    </div>
                `;

                container.appendChild(div);
            });
        }

        
        function getSubjectRecommendation(subject, progress, rotations, mockScore) {
            if (progress < 20 && rotations < 1) {
                return `üö® Îß§Ïùº ${subject.name} ÏµúÏÜå 1ÏãúÍ∞Ñ Ïù¥ÏÉÅ Ìà¨Ïûê ÌïÑÏàò! Í∏∞Ï¥àÎ∂ÄÌÑ∞ Ï∞®Í∑ºÏ∞®Í∑º ÏãúÏûëÌïòÏÑ∏Ïöî.`;
            } else if (progress < 30) {
                return `‚ö†Ô∏è ÏßÑÎèÑÎ•º Îπ†Î•¥Í≤å Ïò¨Î¶¨Îäî Í≤ÉÏù¥ Í∏âÏÑ†Î¨¥ÏûÖÎãàÎã§. ÌïòÎ£® 1-2ÏãúÍ∞Ñ ÏßëÏ§ë ÌïôÏäµÏùÑ Í∂åÏû•Ìï©ÎãàÎã§.`;
            } else if (progress < 50) {
                return `üìö Îß§Ïùº Íæ∏Ï§ÄÌûà ÏßÑÎèÑÎ•º ÎÇòÍ∞ÄÏÑ∏Ïöî. Î™©Ìëú: Ï£ºÎãπ 10-15% ÏßÑÎèÑÏú® ÏÉÅÏäπ`;
            } else if (rotations < 2) {
                return `üîÑ ÏßÑÎèÑÎäî ÏñëÌò∏ÌïòÏßÄÎßå ÌöåÎèÖÏù¥ Î∂ÄÏ°±Ìï©ÎãàÎã§. Î≥µÏäµ ÏãúÍ∞ÑÏùÑ ÎäòÎ†§Ï£ºÏÑ∏Ïöî.`;
            } else if (mockScore !== null && mockScore < 60) {
                return `üìù Î™®ÏùòÍ≥†ÏÇ¨ ÏÑ±Ï†ÅÏù¥ ÎÇÆÏäµÎãàÎã§. Ï∑®ÏïΩ Îã®ÏõêÏùÑ ÏßëÏ§ë Î≥µÏäµÌïòÏÑ∏Ïöî.`;
            } else {
                return `‚úÖ ÌòÑÏû¨ ÏßÑÎèÑÎ•º Ïú†ÏßÄÌïòÎ©¥ÏÑú Íæ∏Ï§ÄÌûà ÌöåÎèÖÏùÑ ÏßÑÌñâÌïòÏÑ∏Ïöî.`;
            }
        }

        // ===== ÏÉàÎ°úÏö¥ Í∏∞Îä•: Î™©Ìëú ÏÑ§Ï†ï & ÎßàÏùºÏä§ÌÜ§ =====
        function renderGoals() {
            const container = document.getElementById('goals-container');
            container.innerHTML = '';

            if (!studyData.goals) studyData.goals = [];

            if (studyData.goals.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-secondary);">Î™©ÌëúÎ•º ÏÑ§Ï†ïÌïòÏó¨ ÌïôÏäµ ÎèôÍ∏∞Î•º ÎÜíÏù¥ÏÑ∏Ïöî! üéØ</div>';
                return;
            }

            studyData.goals.forEach(goal => {
                const today = new Date();
                const goalDate = new Date(goal.date);
                const isAchieved = goal.progress >= 100;
                const isOverdue = goalDate < today && !isAchieved;

                const daysLeft = Math.ceil((goalDate - today) / (1000 * 60 * 60 * 24));
                const daysText = isOverdue ? `${Math.abs(daysLeft)}Ïùº Í≤ΩÍ≥º` : `${daysLeft}Ïùº ÎÇ®Ïùå`;

                const div = document.createElement('div');
                div.className = `goal-item ${isAchieved ? 'achieved' : ''}`;

                div.innerHTML = `
                    <div class="goal-header">
                        <div class="goal-title">${isAchieved ? '‚úì ' : ''}${goal.title}</div>
                        <div class="goal-date" style="color: ${isOverdue ? 'var(--danger)' : 'var(--text-secondary)'}">${daysText}</div>
                        <div class="goal-actions">
                            <button class="goal-btn" aria-label="Î™©Ìëú ÏàòÏ†ï" onclick="editGoal(${goal.id})">‚úèÔ∏è</button>
                            <button class="goal-btn" onclick="deleteGoal(${goal.id})">üóëÔ∏è</button>
                        </div>
                    </div>
                    <div class="goal-progress-bar">
                        <div class="goal-progress-fill" style="width: ${Math.min(goal.progress, 100)}%"></div>
                    </div>
                    <div style="text-align: right; font-size: 0.8rem; color: var(--text-secondary); margin-top: 5px;">
                        ${goal.progress}% ÏôÑÎ£å
                    </div>
                `;

                container.appendChild(div);
            });
        }

        function addGoal() {
            editingGoalId = null;  // Ìé∏Ïßë Î™®Îìú Ï¥àÍ∏∞Ìôî
            document.getElementById('goalTitle').value = '';
            document.getElementById('goalDate').value = '';
            document.getElementById('goalProgress').value = '0';
            document.querySelector('#goalModal .modal-title').textContent = 'ÌïôÏäµ Î™©Ìëú Ï∂îÍ∞Ä';
            document.getElementById('goalModal').classList.add('show');
        }

        function saveGoal() {
            const title = document.getElementById('goalTitle').value;
            const date = document.getElementById('goalDate').value;
            const progress = parseInt(document.getElementById('goalProgress').value) || 0;

            if (title && date) {
                if (!studyData.goals) studyData.goals = [];

                if (editingGoalId) {
                    // ÏàòÏ†ï Î™®Îìú
                    const goal = studyData.goals.find(g => g.id === editingGoalId);
                    if (goal) {
                        goal.title = title;
                        goal.date = date;
                        goal.progress = Math.min(progress, 100);
                        showToast('Î™©ÌëúÍ∞Ä ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§');
                    }
                    editingGoalId = null;
                } else {
                    // Ï∂îÍ∞Ä Î™®Îìú
                    studyData.goals.push({
                        id: Date.now(),
                        title,
                        date,
                        progress: Math.min(progress, 100),
                        createdAt: new Date().toISOString()
                    });
                    showToast('Î™©ÌëúÍ∞Ä Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§ üéØ');
                }

                saveData();
                renderGoals();
                closeModal('goalModal');

                // Reset form and title
                document.getElementById('goalTitle').value = '';
                document.getElementById('goalDate').value = '';
                document.getElementById('goalProgress').value = '0';
                document.querySelector('#goalModal .modal-title').textContent = 'ÌïôÏäµ Î™©Ìëú Ï∂îÍ∞Ä';
            } else {
                showToast('Î™©Ìëú ÎÇ¥Ïö©Í≥º ÎÇ†ÏßúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî', 'error');
            }
        }

        function editGoal(id) {
            const goal = studyData.goals.find(g => g.id === id);
            if (goal) {
                editingGoalId = id;
                document.getElementById('goalTitle').value = goal.title;
                document.getElementById('goalDate').value = goal.date;  // deadline ‚Üí date
                document.getElementById('goalProgress').value = goal.progress;
                document.querySelector('#goalModal .modal-title').textContent = 'ÌïôÏäµ Î™©Ìëú ÏàòÏ†ï';
                document.getElementById('goalModal').classList.add('show');
            }
        }

        function deleteGoal(id) {
            showConfirm('Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?', () => {
                studyData.goals = studyData.goals.filter(g => g.id !== id);
                saveData();
                renderGoals();
                showToast('ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§');
            });
        }

        // ===== ÏÉàÎ°úÏö¥ Í∏∞Îä•: Ïä§ÎßàÌä∏ ÌïôÏäµ Ï∂îÏ≤ú =====
        function renderSmartRecommendations() {
            const container = document.getElementById('smart-recommendations');
            container.innerHTML = '';

            const recommendations = generateRecommendations();

            recommendations.forEach(rec => {
                const li = document.createElement('li');
                li.textContent = rec;
                container.appendChild(li);
            });
        }

        function generateRecommendations() {
            const recs = [];
            const today = new Date();
            const examDate = new Date('2026-08-29');
            const daysLeft = Math.ceil((examDate - today) / (1000 * 60 * 60 * 24));

            // ÏãúÌóòÏùº Í∏∞Î∞ò Ï∂îÏ≤ú
            if (daysLeft < 30) {
                recs.push('ÏãúÌóòÏù¥ Ìïú Îã¨ÎèÑ ÎÇ®ÏßÄ ÏïäÏïòÏäµÎãàÎã§! Í∏∞Ï∂úÎ¨∏Ï†ú ÏµúÏ¢Ö Ï†ïÎ¶¨Ïóê ÏßëÏ§ëÌïòÏÑ∏Ïöî.');
            } else if (daysLeft < 90) {
                recs.push('Î™®ÏùòÍ≥†ÏÇ¨Î•º Ï£º 2-3Ìöå Ïã§ÏãúÌïòÏó¨ Ïã§Ï†Ñ Í∞êÍ∞ÅÏùÑ ÏùµÌûàÏÑ∏Ïöî.');
            } else if (daysLeft < 180) {
                recs.push('Ï†ÑÏ≤¥ ÌöåÎèÖ ÎßàÎ¨¥Î¶¨ÏôÄ Ï∑®ÏïΩÏ†ê Î≥¥ÏôÑÏóê ÏßëÏ§ëÌïòÏÑ∏Ïöî.');
            }

            // ÏïΩÏ†ê Í≥ºÎ™© Í∏∞Î∞ò Ï∂îÏ≤ú
            const weakSubjects = studyData.subjects.filter(s => {
                const progress = (s.completed / s.total) * 100;
                return progress < 50;
            });

            if (weakSubjects.length > 0) {
                recs.push(`${weakSubjects[0].name} Í≥ºÎ™©Ïùò ÏßÑÎèÑÍ∞Ä Î∂ÄÏ°±Ìï©ÎãàÎã§. Ïò§ÎäòÏùÄ Ïù¥ Í≥ºÎ™©Ïóê ÏßëÏ§ëÌïòÏÑ∏Ïöî.`);
            }

            // Ïä§Ìä∏Î¶≠ Í∏∞Î∞ò Ï∂îÏ≤ú
            if (studyData.streak.current >= 7) {
                recs.push(`ÎåÄÎã®Ìï©ÎãàÎã§! ${studyData.streak.current}Ïùº Ïó∞ÏÜç ÌïôÏäµ Ï§ëÏûÖÎãàÎã§. Ïù¥ ÌéòÏù¥Ïä§Î•º Ïú†ÏßÄÌïòÏÑ∏Ïöî!`);
            } else if (studyData.streak.current === 0) {
                recs.push('Ïò§ÎäòÎ∂ÄÌÑ∞ Îã§Ïãú ÏãúÏûëÌïòÏÑ∏Ïöî! Íæ∏Ï§ÄÌï®Ïù¥ Ìï©Í≤©Ïùò ÎπÑÍ≤∞ÏûÖÎãàÎã§.');
            }

            // Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàò Í∏∞Î∞ò Ï∂îÏ≤ú
            if (studyData.mockScores.length > 0) {
                const recentScores = studyData.mockScores.slice(-3);
                const avgRecent = recentScores.reduce((sum, s) => sum + s.score, 0) / recentScores.length;

                if (avgRecent < 55) {
                    recs.push('Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàòÍ∞Ä ÎÇÆÏäµÎãàÎã§. Í∏∞Î≥∏ Í∞úÎÖê Î≥µÏäµÏùÑ Í∂åÏû•Ìï©ÎãàÎã§.');
                } else if (avgRecent >= 60) {
                    recs.push('Î™®ÏùòÍ≥†ÏÇ¨ Ï†êÏàòÍ∞Ä Ìï©Í≤©Í∂åÏûÖÎãàÎã§! Ïã§Ïàò Î∞©ÏßÄÏóê ÏßëÏ§ëÌïòÏÑ∏Ïöî.');
                }
            }

            // ÏùºÎ∞ò Ï∂îÏ≤ú
            if (recs.length < 3) {
                recs.push('ÌïòÎ£® 4-5ÏãúÍ∞Ñ Ïù¥ÏÉÅ ÌïôÏäµÏùÑ Î™©ÌëúÎ°ú ÌïòÏÑ∏Ïöî.');
                recs.push('Îß§Ïùº Í∏∞Ï∂úÎ¨∏Ï†ú 50Î¨∏Ï†ú Ïù¥ÏÉÅÏùÑ ÌíÄÏù¥ÌïòÎäî Í≤ÉÏùÑ Ï∂îÏ≤úÌï©ÎãàÎã§.');
            }

            return recs.slice(0, 5);
        }

        // ===== Ïú†Ìã∏Î¶¨Ìã∞: Ï†ëÏùÑ Ïàò ÏûàÎäî ÏÑπÏÖò =====
        function toggleCollapse(sectionId) {
            const section = document.getElementById(sectionId);
            const icon = document.getElementById(sectionId.replace('-section', '-icon'));

            section.classList.toggle('collapsed');
            icon.classList.toggle('collapsed');
        }

        // ===== Îç∞Ïù¥ÌÑ∞ Import/Export Í∏∞Îä• =====

        /**
         * Î™®Îì† ÌïôÏäµ Îç∞Ïù¥ÌÑ∞Î•º JSON ÌååÏùºÎ°ú ÎÇ¥Î≥¥ÎÇ¥Í∏∞
         */
        function exportData() {
            try {
                // ÎÇ¥Î≥¥ÎÇº Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ (ÎØºÍ∞êÌïú Ï†ïÎ≥¥ Ï†úÏô∏, Î∂àÌïÑÏöîÌïú ÌïÑÎìú Ï†úÍ±∞)
                const exportData = {
                    version: '2.12.0',
                    exportDate: new Date().toISOString(),
                    data: {
                        examType: studyData.examType,
                        examDates: studyData.examDates,
                        subjects1st: studyData.subjects1st,
                        subjects2nd: studyData.subjects2nd,
                        timeBlocks: studyData.timeBlocks,
                        mockScores: studyData.mockScores,
                        weeklyHours: studyData.weeklyHours,
                        notes: studyData.notes,
                        streak: studyData.streak,
                        goals: studyData.goals,
                        subjectTimeSpent: studyData.subjectTimeSpent,
                        studyHistory: studyData.studyHistory
                    }
                };

                // JSONÏúºÎ°ú Î≥ÄÌôò
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });

                // ÌååÏùº Îã§Ïö¥Î°úÎìú
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;

                // ÌååÏùºÎ™Ö: study-data-YYYY-MM-DD.json
                const today = new Date().toISOString().split('T')[0];
                link.download = `study-data-${today}.json`;

                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                // Î©îÎ™®Î¶¨ Ï†ïÎ¶¨
                URL.revokeObjectURL(url);

                showToast('Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÎÇ¥Î≥¥ÎÇ¥Ï°åÏäµÎãàÎã§', 'success');
                console.log('Data exported successfully');

            } catch (error) {
                console.error('Export error:', error);
                showToast('Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§', 'error');
            }
        }

        /**
         * JSON ÌååÏùºÏóêÏÑú ÌïôÏäµ Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
         */
        let pendingImportData = null;

        function importData(event) {
            const file = event.target.files[0];
            if (!file) {
                return;
            }

            // ÌååÏùº ÌôïÏû•Ïûê Í≤ÄÏ¶ù
            if (!file.name.endsWith('.json')) {
                showToast('JSON ÌååÏùºÎßå Í∞ÄÏ†∏Ïò¨ Ïàò ÏûàÏäµÎãàÎã§', 'error');
                event.target.value = ''; // ÌååÏùº ÏÑ†ÌÉù Ï¥àÍ∏∞Ìôî
                return;
            }

            const reader = new FileReader();

            reader.onload = function(e) {
                try {
                    // JSON ÌååÏã±
                    const importedData = JSON.parse(e.target.result);

                    // Îç∞Ïù¥ÌÑ∞ Íµ¨Ï°∞ Í≤ÄÏ¶ù
                    if (!validateImportData(importedData)) {
                        showToast('Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏùÄ ÌååÏùº ÌòïÏãùÏûÖÎãàÎã§', 'error');
                        event.target.value = '';
                        return;
                    }

                    // ÏûÑÏãúÎ°ú Ï†ÄÏû•ÌïòÍ≥† ÌôïÏù∏ Î™®Îã¨ ÌëúÏãú
                    pendingImportData = importedData.data;
                    showImportPreview(importedData);

                } catch (error) {
                    console.error('Import parsing error:', error);
                    showToast('ÌååÏùºÏùÑ ÏùΩÏùÑ Ïàò ÏóÜÏäµÎãàÎã§. Ïò¨Î∞îÎ•∏ JSON ÌååÏùºÏù∏ÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî.', 'error');
                    event.target.value = '';
                }
            };

            reader.onerror = function() {
                showToast('ÌååÏùº ÏùΩÍ∏∞ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§', 'error');
                event.target.value = '';
            };

            reader.readAsText(file);
        }

        /**
         * Í∞ÄÏ†∏Ïò® Îç∞Ïù¥ÌÑ∞Ïùò Ïú†Ìö®ÏÑ± Í≤ÄÏ¶ù
         */
        function validateImportData(data) {
            try {
                // ÌïÑÏàò Íµ¨Ï°∞ Í≤ÄÏ¶ù
                if (!data || typeof data !== 'object') {
                    console.error('Invalid data structure: not an object');
                    return false;
                }

                if (!data.data || typeof data.data !== 'object') {
                    console.error('Invalid data structure: missing data property');
                    return false;
                }

                const d = data.data;

                // ÌïÑÏàò Î∞∞Ïó¥ ÌïÑÎìú Í≤ÄÏ¶ù
                const requiredArrays = ['subjects1st', 'subjects2nd'];
                for (const field of requiredArrays) {
                    if (!Array.isArray(d[field])) {
                        console.error(`Invalid data structure: ${field} is not an array`);
                        return false;
                    }
                }

                // ÏÑ†ÌÉùÏ†Å Î∞∞Ïó¥ ÌïÑÎìú Í≤ÄÏ¶ù (ÏóÜÏúºÎ©¥ Îπà Î∞∞Ïó¥Î°ú Ï¥àÍ∏∞Ìôî)
                const optionalArrays = ['timeBlocks', 'mockScores', 'goals', 'studyHistory'];
                for (const field of optionalArrays) {
                    if (d[field] !== undefined && !Array.isArray(d[field])) {
                        console.error(`Invalid data structure: ${field} is not an array`);
                        return false;
                    }
                }

                // Í≥ºÎ™© Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù
                if (d.subjects1st.length === 0) {
                    console.error('Invalid data: subjects1st is empty');
                    return false;
                }

                // Í∏∞Î≥∏ Íµ¨Ï°∞Í∞Ä Ïò¨Î∞îÎ•∏ÏßÄ ÌôïÏù∏
                const sample = d.subjects1st[0];
                if (!sample.name || typeof sample.total !== 'number' || typeof sample.completed !== 'number') {
                    console.error('Invalid subject structure');
                    return false;
                }

                console.log('Data validation passed');
                return true;

            } catch (error) {
                console.error('Validation error:', error);
                return false;
            }
        }

        /**
         * Í∞ÄÏ†∏Ïò¨ Îç∞Ïù¥ÌÑ∞ ÎØ∏Î¶¨Î≥¥Í∏∞ ÌëúÏãú
         */
        function showImportPreview(importedData) {
            const previewContainer = document.getElementById('importPreviewContainer');
            const data = importedData.data;

            // ÎØ∏Î¶¨Î≥¥Í∏∞ HTML ÏÉùÏÑ±
            let previewHTML = '<h4 style="margin-bottom: 15px; color: var(--primary-dark);">Í∞ÄÏ†∏Ïò¨ Îç∞Ïù¥ÌÑ∞ ÎØ∏Î¶¨Î≥¥Í∏∞</h4>';

            // ÌååÏùº Ï†ïÎ≥¥
            if (importedData.version) {
                previewHTML += `
                    <div class="import-preview-item">
                        <span class="import-preview-label">ÌååÏùº Î≤ÑÏ†Ñ</span>
                        <span class="import-preview-value">${importedData.version}</span>
                    </div>
                `;
            }

            if (importedData.exportDate) {
                const exportDate = new Date(importedData.exportDate);
                previewHTML += `
                    <div class="import-preview-item">
                        <span class="import-preview-label">ÎÇ¥Î≥¥ÎÇ∏ ÎÇ†Ïßú</span>
                        <span class="import-preview-value">${exportDate.toLocaleDateString('ko-KR')}</span>
                    </div>
                `;
            }

            // Îç∞Ïù¥ÌÑ∞ ÌÜµÍ≥Ñ
            previewHTML += `
                <div class="import-preview-item">
                    <span class="import-preview-label">1Ï∞® Í≥ºÎ™© Ïàò</span>
                    <span class="import-preview-value">${data.subjects1st?.length || 0}Í∞ú</span>
                </div>
                <div class="import-preview-item">
                    <span class="import-preview-label">2Ï∞® Í≥ºÎ™© Ïàò</span>
                    <span class="import-preview-value">${data.subjects2nd?.length || 0}Í∞ú</span>
                </div>
                <div class="import-preview-item">
                    <span class="import-preview-label">ÌïôÏäµ Î∏îÎ°ù Ïàò</span>
                    <span class="import-preview-value">${data.timeBlocks?.length || 0}Í∞ú</span>
                </div>
                <div class="import-preview-item">
                    <span class="import-preview-label">Î™®ÏùòÍ≥†ÏÇ¨ Í∏∞Î°ù</span>
                    <span class="import-preview-value">${data.mockScores?.length || 0}Í∞ú</span>
                </div>
                <div class="import-preview-item">
                    <span class="import-preview-label">ÌïôÏäµ Î™©Ìëú</span>
                    <span class="import-preview-value">${data.goals?.length || 0}Í∞ú</span>
                </div>
                <div class="import-preview-item">
                    <span class="import-preview-label">ÌïôÏäµ Ïä§Ìä∏Î¶≠</span>
                    <span class="import-preview-value">${data.streak?.current || 0}Ïùº Ïó∞ÏÜç</span>
                </div>
            `;

            previewContainer.innerHTML = previewHTML;

            // ÌôïÏù∏ Î≤ÑÌäºÏóê Ïù¥Î≤§Ìä∏ Ìï∏Îì§Îü¨ ÏÑ§Ï†ï
            const confirmBtn = document.getElementById('confirmImportBtn');
            confirmBtn.onclick = function() {
                confirmImport();
            };

            // Î™®Îã¨ ÌëúÏãú
            document.getElementById('importConfirmModal').classList.add('show');
        }

        /**
         * Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ ÏµúÏ¢Ö ÌôïÏù∏ Î∞è Ïã§Ìñâ
         */
        function confirmImport() {
            if (!pendingImportData) {
                showToast('Í∞ÄÏ†∏Ïò¨ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§', 'error');
                closeModal('importConfirmModal');
                return;
            }

            try {
                // ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞Î•º ÏûÑÏãúÎ°ú Î∞±ÏóÖ (ÌòπÏãú Î™®Î•º ÏÉÅÌô© ÎåÄÎπÑ - ÏÑ∏ÏÖò Ïä§ÌÜ†Î¶¨ÏßÄÏóê)
                try {
                    sessionStorage.setItem('studyDataBackup', JSON.stringify(studyData));
                } catch (backupError) {
                    console.warn('Failed to create session backup:', backupError);
                }

                // Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
                const imported = pendingImportData;

                // Í∏∞Î≥∏Í∞íÍ≥º Î≥ëÌï© (ÎàÑÎùΩÎêú ÌïÑÎìú Ï≤òÎ¶¨)
                studyData = {
                    examType: imported.examType || '1Ï∞®',
                    examDates: imported.examDates || { '1Ï∞®': null, '2Ï∞®': null },
                    timer: {
                        seconds: 0,
                        isRunning: false,
                        interval: null
                    },
                    pomodoro: {
                        seconds: 1500,
                        isRunning: false,
                        interval: null,
                        mode: 'work',
                        completedSessions: 0
                    },
                    subjects1st: imported.subjects1st || [],
                    subjects2nd: imported.subjects2nd || [],
                    subjects: [],
                    timeBlocks: imported.timeBlocks || [],
                    mockScores: imported.mockScores || [],
                    weeklyHours: imported.weeklyHours || {},
                    notes: imported.notes || {},
                    streak: imported.streak || {
                        current: 0,
                        longest: 0,
                        lastStudyDate: null,
                        totalDays: 0
                    },
                    goals: imported.goals || [],
                    subjectTimeSpent: imported.subjectTimeSpent || {},
                    studyHistory: imported.studyHistory || []
                };

                // Í≥ºÎ™© ÏÑ§Ï†ï ÏóÖÎç∞Ïù¥Ìä∏
                updateSubjectsByExamType();

                // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóê Ï†ÄÏû•
                saveData();

                // Î™®Îã¨ Îã´Í∏∞
                closeModal('importConfirmModal');

                // ÏÑ±Í≥µ ÌÜ†Ïä§Ìä∏
                showToast('Îç∞Ïù¥ÌÑ∞Î•º ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Í∞ÄÏ†∏ÏôîÏäµÎãàÎã§! ÌéòÏù¥ÏßÄÎ•º ÏÉàÎ°úÍ≥†Ïπ®Ìï©ÎãàÎã§.', 'success');

                // ÌéòÏù¥ÏßÄ ÏÉàÎ°úÍ≥†Ïπ® (Î™®Îì† UI ÏóÖÎç∞Ïù¥Ìä∏)
                setTimeout(() => {
                    location.reload();
                }, 1500);

                // ÏûÑÏãú Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨
                pendingImportData = null;

                console.log('Data imported successfully');

            } catch (error) {
                console.error('Import error:', error);
                showToast('Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§', 'error');

                // Î∞±ÏóÖ Î≥µÍµ¨ ÏãúÎèÑ
                try {
                    const backup = sessionStorage.getItem('studyDataBackup');
                    if (backup) {
                        studyData = JSON.parse(backup);
                        saveData();
                        showToast('Ïù¥Ï†Ñ Îç∞Ïù¥ÌÑ∞Î°ú Î≥µÍµ¨ÎêòÏóàÏäµÎãàÎã§', 'info');
                    }
                } catch (restoreError) {
                    console.error('Failed to restore backup:', restoreError);
                }
            } finally {
                // ÌååÏùº ÏûÖÎ†• Ï¥àÍ∏∞Ìôî
                const fileInput = document.getElementById('importFileInput');
                if (fileInput) {
                    fileInput.value = '';
                }
            }
        }

        // ÌÉÄÏù¥Î®∏ ÏãúÏûë Ïãú Ïä§Ìä∏Î¶≠ ÏóÖÎç∞Ïù¥Ìä∏
        const originalStartTimer = startTimer;
        startTimer = function() {
            originalStartTimer();
            updateStreak();
            renderAnalytics();
        };

        // ÌÉÄÏûÑÎ∏îÎ°ù ÏôÑÎ£å Ïãú Î∂ÑÏÑù ÏóÖÎç∞Ïù¥Ìä∏
        // (Ï£ºÏÑù Ï≤òÎ¶¨ - 7422ÏóêÏÑú Ïû¨Ï†ïÏùòÎê®)
        // const originalToggleTimeBlock = toggleTimeBlock;
        // toggleTimeBlock = function(id) {
        //     originalToggleTimeBlock(id);
        //     updateStreak();
        //     renderAnalytics();
        // };

        // ===== PROPER INITIALIZATION SEQUENCE =====
        // This ensures correct order: DOMReady ‚Üí setupChart ‚Üí wrapFunctions ‚Üí init ‚Üí chartUpdate
        document.addEventListener('DOMContentLoaded', function() {
            // Step 0: Load saved theme on page load
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            const themeIcon = document.getElementById('theme-icon');
            if (themeIcon) {
                themeIcon.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            }

            // Step 1: Setup Chart.js defaults
            if (typeof Chart !== 'undefined') {
                Chart.defaults.font.family = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                Chart.defaults.animation.duration = 600;
                Chart.defaults.animation.easing = 'easeInOutQuart';
            }

            // Step 2: Wrap saveData to update charts on data changes
            const originalSaveData = saveData;
            saveData = function() {
                originalSaveData();
                if (typeof Chart !== 'undefined') {
                    initAllCharts();
                }
            };

            // Step 3: Wrap toggleDarkMode to update charts on theme change
            if (typeof toggleDarkMode === 'function') {
                const originalToggleDarkMode = toggleDarkMode;
                toggleDarkMode = function() {
                    originalToggleDarkMode();
                    if (typeof Chart !== 'undefined') {
                        setTimeout(() => {
                            initAllCharts();
                        }, 100);
                    }
                };
            }

            // Step 4: Initialize the application (loads data + renders UI)
            init();

            // Step 4.5: Initialize tab navigation (show overview tab by default)
            setTimeout(() => {
                switchTab('overview');
                console.log('‚úÖ ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
            }, 100);

            // Step 5: Initialize charts with loaded data
            if (typeof Chart !== 'undefined') {
                initAllCharts();
            } else {
                console.error('Chart.js not loaded');
            }

        });

        // ===== v3.0.0 DASHBOARD TAB & STICKY PROGRESS FUNCTIONALITY =====

        // ÌÉ≠ Ï†ÑÌôò Ìï®Ïàò - Ìï¥Îãπ ÏÑπÏÖòÏúºÎ°ú Ïä§ÌÅ¨Î°§
        function switchTab(tabName) {
            // Tab functionality removed - tabs deleted from dashboard
            console.log(`‚ÑπÔ∏è switchTab Ìï®ÏàòÎäî Îçî Ïù¥ÏÉÅ ÏÇ¨Ïö©ÎêòÏßÄ ÏïäÏäµÎãàÎã§ (ÌÉ≠Ïù¥ ÏÇ≠Ï†úÎê®)`);
        }

        // ÏÑπÏÖòÏúºÎ°ú Ï†êÌîÑÌïòÎäî Ìï®Ïàò (Ïä§ÌÅ¨Î°§Îßå ÏàòÌñâ)
        function jumpToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                console.log(`‚úÖ ÏÑπÏÖòÏúºÎ°ú Ï†êÌîÑ: ${sectionId}`);
                // ÏöîÏÜåÎ°ú Ïä§ÌÅ¨Î°§ Î∞è Í∞ïÏ°∞ Ìö®Í≥º
                setTimeout(() => {
                    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    // Í∞ïÏ°∞ Ìö®Í≥º
                    element.style.backgroundColor = 'var(--accent-light)';
                    element.style.opacity = '0.5';
                    setTimeout(() => {
                        element.style.backgroundColor = '';
                        element.style.opacity = '1';
                        element.style.transition = 'all 0.3s ease';
                    }, 500);
                }, 100);
            } else {
                console.error(`‚ùå Ï∞æÏùÑ Ïàò ÏóÜÎäî ÏÑπÏÖò ID: ${sectionId}`);
            }
        }

        // Sticky Progress Bar ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
        function updateStickyProgress() {
            // Ï†ÑÏ≤¥ ÏßÑÎèÑ Í≥ÑÏÇ∞
            let completedSubjects = 0;
            let totalSubjects = 0;
            const examType = document.querySelector('.study-mode-selector .active')?.textContent || '1Ï∞®';

            studyData.subjects.forEach(subject => {
                if (examType.includes('1Ï∞®') && !subject.name.includes('2Ï∞®')) {
                    totalSubjects++;
                    if (subject.progress >= 100) completedSubjects++;
                } else if (examType.includes('2Ï∞®') && subject.name.includes('2Ï∞®')) {
                    totalSubjects++;
                    if (subject.progress >= 100) completedSubjects++;
                }
            });

            const overallProgress = totalSubjects > 0 ? Math.round((completedSubjects / totalSubjects) * 100) : 0;
            document.getElementById('stickyProgress').textContent = overallProgress + '%';

            // Ïó∞ÏÜç ÌïôÏäµÏùº
            const streak = studyData.streak?.current || 0;
            document.getElementById('stickyStreak').textContent = streak + 'Ïùº';

            // Ïò§Îäò ÏôÑÎ£åÌïú Î∏îÎ°ù
            const today = new Date().toISOString().split('T')[0];
            const todayBlocks = studyData.timeBlocks.filter(block => block.date === today);
            const completedBlocks = todayBlocks.filter(block => block.completed).length;
            document.getElementById('stickyCompleted').textContent = `${completedBlocks}/${todayBlocks.length}`;

            // Ïò§Îäò ÌïôÏäµ ÏãúÍ∞Ñ
            const totalHours = todayBlocks.reduce((sum, block) => sum + block.hours, 0);
            const completedHours = todayBlocks.filter(block => block.completed).reduce((sum, block) => sum + block.hours, 0);
            document.getElementById('stickyHours').textContent = `${completedHours.toFixed(1)}h`;
        }

        // Sticky Progress Bar ÏûêÎèô ÏóÖÎç∞Ïù¥Ìä∏ (Îç∞Ïù¥ÌÑ∞ Î≥ÄÍ≤Ω Ïãú)
        let updateProgressInterval;
        function startProgressUpdate() {
            updateStickyProgress(); // Ï¥àÍ∏∞ ÏóÖÎç∞Ïù¥Ìä∏
            updateProgressInterval = setInterval(updateStickyProgress, 30000); // 30Ï¥àÎßàÎã§ ÏóÖÎç∞Ïù¥Ìä∏
        }

        // ===== DARK MODE FUNCTIONALITY (Ìï®Ïàò Ï°∞Í∏∞ Ï†ïÏùò - DOMContentLoaded Ï†Ñ) =====
        function toggleDarkMode() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);

            // Update icon
            const icon = document.getElementById('theme-icon');
            if (icon) {
                icon.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            }

            showToast(`${newTheme === 'dark' ? 'Îã§ÌÅ¨' : 'ÎùºÏù¥Ìä∏'} Î™®ÎìúÎ°ú Ï†ÑÌôòÎêòÏóàÏäµÎãàÎã§`, 'info');
        }

        // ===== v3.0.0 AUTO-SAVE FOR NOTES =====
        let notesAutoSaveTimeout;
        let notesAutoSaveActive = false;

        function enableNotesAutoSave() {
            const notesInput = document.getElementById('study-notes');
            if (!notesInput) return;

            notesAutoSaveActive = true;

            notesInput.addEventListener('input', () => {
                // Í∏∞Ï°¥ ÌÉÄÏù¥Î®∏ Ï∑®ÏÜå
                if (notesAutoSaveTimeout) clearTimeout(notesAutoSaveTimeout);

                // ÏûÖÎ†• Ï§ë ÌëúÏãú
                notesInput.style.borderColor = 'var(--accent-light)';

                // 2Ï¥à ÌõÑ ÏûêÎèô Ï†ÄÏû•
                notesAutoSaveTimeout = setTimeout(() => {
                    saveNotesAuto();
                }, 2000);
            });
        }

        function saveNotesAuto() {
            const notesInput = document.getElementById('study-notes');
            if (!notesInput) return;

            const today = new Date().toISOString().split('T')[0];
            const content = notesInput.value;

            if (!studyData.notes) studyData.notes = {};
            if (!studyData.notes[today]) studyData.notes[today] = {};

            studyData.notes[today].content = content;
            studyData.notes[today].lastModified = new Date().toISOString();

            saveData();

            // ÏûêÎèô Ï†ÄÏû• ÏãúÍ∞ÅÏ†Å ÌîºÎìúÎ∞± (ÏÇ¥Ïßù Î≥ÄÍ≤Ω)
            notesInput.style.borderColor = 'var(--success-color)';
            notesInput.style.boxShadow = '0 0 0 3px rgba(52, 199, 89, 0.1)';

            setTimeout(() => {
                notesInput.style.borderColor = '';
                notesInput.style.boxShadow = '';
            }, 1500);

            console.log('üíæ ÏûêÎèô Ï†ÄÏû•Îê®:', today);
        }

        // ============================================
        // DATA VISUALIZATION WITH CHART.JS - v2.13.0
        // ============================================

        // Chart instances (global)
        let subjectTimeChart = null;
        let mockScoreChart = null;
        let currentScoreRange = 'all';

        // Apple-inspired color palette
        const appleColors = {
            light: {
                blue: '#0071e3',
                green: '#34c759',
                orange: '#ff9500',
                red: '#ff3b30',
                purple: '#af52de',
                pink: '#ff2d55',
                yellow: '#ffcc00',
                teal: '#5ac8fa',
                indigo: '#5856d6',
                gray: '#8e8e93'
            },
            dark: {
                blue: '#2997ff',
                green: '#30d158',
                orange: '#ff9f0a',
                red: '#ff453a',
                purple: '#bf5af2',
                pink: '#ff375f',
                yellow: '#ffd60a',
                teal: '#64d2ff',
                indigo: '#5e5ce6',
                gray: '#98989d'
            }
        };

        // Get current theme colors
        function getThemeColors() {
            const isDark = document.body.classList.contains('dark-mode');
            return isDark ? appleColors.dark : appleColors.light;
        }

        // Get text colors based on theme
        function getTextColors() {
            const isDark = document.body.classList.contains('dark-mode');
            return {
                primary: isDark ? '#f5f5f7' : '#1d1d1f',
                secondary: isDark ? '#a1a1a6' : '#6e6e73',
                tertiary: isDark ? '#6e6e73' : '#a1a1a6'
            };
        }

        // Chart.js default configuration
        function getChartDefaults() {
            const textColors = getTextColors();
            const isDark = document.body.classList.contains('dark-mode');

            return {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom',
                        labels: {
                            color: textColors.primary,
                            font: {
                                family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                size: 13,
                                weight: '500'
                            },
                            padding: 16,
                            usePointStyle: true,
                            pointStyle: 'circle'
                        }
                    },
                    tooltip: {
                        backgroundColor: isDark ? 'rgba(22, 22, 23, 0.95)' : 'rgba(255, 255, 255, 0.95)',
                        titleColor: textColors.primary,
                        bodyColor: textColors.secondary,
                        borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)',
                        borderWidth: 1,
                        padding: 12,
                        cornerRadius: 8,
                        titleFont: {
                            family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                            size: 14,
                            weight: '600'
                        },
                        bodyFont: {
                            family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                            size: 13
                        },
                        displayColors: true,
                        boxWidth: 12,
                        boxHeight: 12,
                        boxPadding: 6
                    }
                },
                animation: {
                    duration: 600,
                    easing: 'easeInOutQuart'
                }
            };
        }

        // Initialize Subject Time Distribution Chart (Doughnut)
        function initSubjectTimeChart() {
            const ctx = document.getElementById('subjectTimeChart');
            if (!ctx) return;

            // Calculate subject study times from actual data
            const subjectTimes = {};
            const subjects = studyData.subjects || [];

            // Add time from subjects progress
            subjects.forEach(subject => {
                const progress = subject.completed / subject.total;
                const estimatedHours = Math.round(progress * 100); // Rough estimation
                subjectTimes[subject.name] = (subjectTimes[subject.name] || 0) + estimatedHours;
            });

            // Add time from time blocks
            (studyData.timeBlocks || []).forEach(block => {
                const subject = block.subject || 'Í∏∞ÌÉÄ';
                const duration = parseInt(block.duration) || 0;
                subjectTimes[subject] = (subjectTimes[subject] || 0) + duration;
            });

            // Prepare chart data
            const labels = Object.keys(subjectTimes);
            const data = Object.values(subjectTimes);
            const colors = getThemeColors();

            // Color array for subjects
            const colorArray = [
                colors.blue, colors.green, colors.orange, colors.purple,
                colors.pink, colors.teal, colors.indigo, colors.red, colors.yellow
            ];

            const chartData = {
                labels: labels.length > 0 ? labels : ['Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå'],
                datasets: [{
                    label: 'ÌïôÏäµ ÏãúÍ∞Ñ (ÏãúÍ∞Ñ)',
                    data: data.length > 0 ? data : [1],
                    backgroundColor: labels.length > 0 ? colorArray.slice(0, labels.length) : ['#e0e0e0'],
                    borderWidth: 0,
                    hoverOffset: 8
                }]
            };

            const config = {
                type: 'doughnut',
                data: chartData,
                options: {
                    ...getChartDefaults(),
                    cutout: '70%',
                    plugins: {
                        ...getChartDefaults().plugins,
                        legend: {
                            ...getChartDefaults().plugins.legend,
                            position: 'right'
                        },
                        tooltip: {
                            ...getChartDefaults().plugins.tooltip,
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;
                                    return `${label}: ${value}ÏãúÍ∞Ñ (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            };

            // Destroy existing chart
            if (subjectTimeChart) {
                subjectTimeChart.destroy();
            }

            // Create new chart
            subjectTimeChart = new Chart(ctx, config);
        }

        // Initialize Mock Exam Score Trend Chart (Line)
        function initMockScoreChart(range = 'all') {
            const ctx = document.getElementById('mockScoreChart');
            if (!ctx) return;

            // Get mock scores from data
            let scores = studyData.mockScores || [];

            // Filter by date range
            const now = new Date();
            if (range === 'week') {
                const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                scores = scores.filter(score => new Date(score.date) >= weekAgo);
            } else if (range === 'month') {
                const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                scores = scores.filter(score => new Date(score.date) >= monthAgo);
            }

            // Sort by date
            scores.sort((a, b) => new Date(a.date) - new Date(b.date));

            // Prepare chart data
            const labels = scores.map(score => {
                const date = new Date(score.date);
                return `${date.getMonth() + 1}/${date.getDate()}`;
            });

            const scoreData = scores.map(score => parseFloat(score.score) || 0);

            // Calculate average
            const average = scoreData.length > 0
                ? scoreData.reduce((a, b) => a + b, 0) / scoreData.length
                : 0;

            const colors = getThemeColors();
            const textColors = getTextColors();

            const chartData = {
                labels: labels.length > 0 ? labels : ['Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå'],
                datasets: [
                    {
                        label: 'Ï†êÏàò',
                        data: scoreData.length > 0 ? scoreData : [0],
                        borderColor: colors.blue,
                        backgroundColor: colors.blue + '20',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        pointRadius: 6,
                        pointHoverRadius: 8,
                        pointBackgroundColor: colors.blue,
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2
                    },
                    {
                        label: 'ÌèâÍ∑†',
                        data: scoreData.length > 0 ? Array(scoreData.length).fill(average) : [0],
                        borderColor: colors.orange,
                        borderWidth: 2,
                        borderDash: [5, 5],
                        fill: false,
                        pointRadius: 0,
                        pointHoverRadius: 0
                    }
                ]
            };

            const config = {
                type: 'line',
                data: chartData,
                options: {
                    ...getChartDefaults(),
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: textColors.tertiary + '20',
                                drawBorder: false
                            },
                            ticks: {
                                color: textColors.secondary,
                                font: {
                                    family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                    size: 12
                                },
                                callback: function(value) {
                                    return value + 'Ï†ê';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false,
                                drawBorder: false
                            },
                            ticks: {
                                color: textColors.secondary,
                                font: {
                                    family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                    size: 12
                                }
                            }
                        }
                    },
                    plugins: {
                        ...getChartDefaults().plugins,
                        tooltip: {
                            ...getChartDefaults().plugins.tooltip,
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = context.parsed.y || 0;
                                    return `${label}: ${value.toFixed(1)}Ï†ê`;
                                }
                            }
                        }
                    }
                }
            };

            // Destroy existing chart
            if (mockScoreChart) {
                mockScoreChart.destroy();
            }

            // Create new chart
            mockScoreChart = new Chart(ctx, config);
        }

        // Render Subject Progress Bars
        function renderSubjectProgressBars() {
            const container = document.getElementById('subjectProgressBars');
            if (!container) return;

            const subjects = studyData.subjects || [];

            if (subjects.length === 0) {
                container.innerHTML = `
                    <div class="chart-empty-state">
                        <div class="chart-empty-icon">üìö</div>
                        <div class="chart-empty-text">Í≥ºÎ™© Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§</div>
                        <div class="chart-empty-subtext">Í≥ºÎ™©ÏùÑ Ï∂îÍ∞ÄÌïòÎ©¥ ÏßÑÎèÑÏú®Ïù¥ ÌëúÏãúÎê©ÎãàÎã§</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = subjects.map(subject => {
                const progress = Math.round((subject.completed / subject.total) * 100);
                const progressClass = progress < 40 ? 'low' : progress < 70 ? 'medium' : 'high';

                return `
                    <div class="progress-bar-item">
                        <div class="progress-bar-header">
                            <span class="progress-bar-label">${subject.name}</span>
                            <span class="progress-bar-value">${progress}%</span>
                        </div>
                        <div class="progress-bar-track">
                            <div class="progress-bar-fill ${progressClass}" style="width: ${progress}%"></div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Update Sync Status Dashboard
        function updateSyncStatus() {
            // Update sync status
            const syncIcon = document.getElementById('sync-icon');
            const syncStatusText = document.getElementById('sync-status-text');
            const lastSyncTime = document.getElementById('last-sync-time');

            if (syncIcon && syncStatusText && lastSyncTime) {
                syncIcon.textContent = '‚úì';
                syncIcon.className = 'sync-status-icon success';
                syncStatusText.textContent = 'Ï†ïÏÉÅ';
                lastSyncTime.textContent = 'ÎßàÏßÄÎßâ ÏóÖÎç∞Ïù¥Ìä∏: Î∞©Í∏à Ï†Ñ';
            }

            // Update sync success rate
            const syncSuccessRate = document.getElementById('sync-success-rate');
            const totalSyncs = document.getElementById('total-syncs');
            if (syncSuccessRate && totalSyncs) {
                const syncCount = parseInt(localStorage.getItem('syncCount') || '0') + 1;
                localStorage.setItem('syncCount', syncCount.toString());
                syncSuccessRate.textContent = '100%';
                totalSyncs.textContent = syncCount.toString();
            }

            // Update data size
            const dataSize = document.getElementById('data-size');
            if (dataSize) {
                const storageSize = JSON.stringify(studyData).length;
                const sizeKB = (storageSize / 1024).toFixed(2);
                dataSize.innerHTML = `Ï†ÄÏû•Îêú Îç∞Ïù¥ÌÑ∞: <span>${sizeKB}KB</span>`;
            }
        }

        // Set Score Date Range
        function setScoreDateRange(range) {
            currentScoreRange = range;

            // Update button states
            ['all', 'month', 'week'].forEach(r => {
                const btn = document.getElementById(`score-range-${r}`);
                if (btn) {
                    if (r === range) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                }
            });

            // Re-render chart
            initMockScoreChart(range);
        }

        // Export Chart as Image
        function exportChart(chartId) {
            const canvas = document.getElementById(chartId);
            if (!canvas) {
                showToast('Ï∞®Ìä∏Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§', 'error');
                return;
            }

            try {
                const url = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.download = `${chartId}_${new Date().getTime()}.png`;
                link.href = url;
                link.click();
                showToast('Ï∞®Ìä∏ Ïù¥ÎØ∏ÏßÄÍ∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§', 'success');
            } catch (error) {
                console.error('Export error:', error);
                showToast('Ï∞®Ìä∏ Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§', 'error');
            }
        }

        // Initialize all charts
        function initAllCharts() {
            try {
                initSubjectTimeChart();
                initMockScoreChart(currentScoreRange);
                renderSubjectProgressBars();
                updateSyncStatus();
            } catch (error) {
                console.error('Chart initialization error:', error);
            }
        }


    </script>

    <!-- ================================================================ -->

</body>
</html>